[0m17:57:11.372006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111843c50>]}


============================== 17:57:11.379359 | e9658b95-0797-4f5f-a22e-ae2718b81f25 ==============================
[0m17:57:11.379359 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:57:11.379711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:12.281602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a18d60>]}
[0m17:57:12.308451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fa690>]}
[0m17:57:12.312337 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:57:12.380002 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:57:12.382117 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:57:12.382356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191b350>]}
[0m17:57:13.345269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe9130>]}
[0m17:57:13.410338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m17:57:13.412202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m17:57:13.455952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d5010>]}
[0m17:57:13.456266 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m17:57:13.456453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112398120>]}
[0m17:57:13.457668 [info ] [MainThread]: 
[0m17:57:13.457850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:13.457982 [info ] [MainThread]: 
[0m17:57:13.458219 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:13.460785 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m17:57:13.526134 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m17:57:13.526454 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m17:57:13.526601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:17.186389 [debug] [ThreadPool]: SQL status: OK in 3.660 seconds
[0m17:57:17.187705 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m17:57:17.188172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m17:57:17.188467 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m17:57:17.191933 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:17.192103 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m17:57:17.192234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:17.192659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:17.193285 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:17.193430 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m17:57:17.193677 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:17.193845 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:17.193980 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m17:57:17.194299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:17.194711 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m17:57:17.194849 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:17.194968 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m17:57:17.195157 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:17.195281 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m17:57:17.196287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_snapshots)
[0m17:57:17.198912 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m17:57:17.199089 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m17:57:17.199216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:17.199947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m17:57:17.200675 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m17:57:17.200810 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m17:57:17.200924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:17.201136 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:57:17.201256 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m17:57:17.201381 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m17:57:17.201528 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:17.201752 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m17:57:17.201893 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m17:57:17.211776 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:57:17.212438 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m17:57:17.212714 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:57:17.213293 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m17:57:17.214188 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m17:57:17.214337 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m17:57:17.214584 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m17:57:17.214821 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m17:57:17.215121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238fc50>]}
[0m17:57:17.215423 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:17.215550 [debug] [MainThread]: On master: BEGIN
[0m17:57:17.215669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:17.215901 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:17.216020 [debug] [MainThread]: On master: COMMIT
[0m17:57:17.216133 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:17.216241 [debug] [MainThread]: On master: COMMIT
[0m17:57:17.216414 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:17.216533 [debug] [MainThread]: On master: Close
[0m17:57:17.220670 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m17:57:17.220867 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m17:57:17.221041 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m17:57:17.221193 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m17:57:17.221426 [info ] [Thread-4 (]: 4 of 4 START seed file main.raw_products ....................................... [RUN]
[0m17:57:17.221667 [info ] [Thread-3 (]: 3 of 4 START seed file main.raw_orders ......................................... [RUN]
[0m17:57:17.221889 [info ] [Thread-1 (]: 1 of 4 START seed file main.raw_customers ...................................... [RUN]
[0m17:57:17.222130 [info ] [Thread-2 (]: 2 of 4 START seed file main.raw_order_items .................................... [RUN]
[0m17:57:17.222414 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m17:57:17.222639 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m17:57:17.222810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m17:57:17.222977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m17:57:17.223131 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m17:57:17.223279 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m17:57:17.223424 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m17:57:17.223564 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m17:57:17.223714 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m17:57:17.223868 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m17:57:17.224009 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m17:57:17.224149 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m17:57:17.246079 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_products"
[0m17:57:17.248148 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: BEGIN
[0m17:57:17.248788 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:17.249341 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_orders"
[0m17:57:17.249917 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: BEGIN
[0m17:57:17.250356 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_customers"
[0m17:57:17.250510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:57:17.250671 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:57:17.251655 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_order_items"
[0m17:57:17.251802 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: BEGIN
[0m17:57:17.252039 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_products"
[0m17:57:17.252210 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: BEGIN
[0m17:57:17.252362 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:57:17.252507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:17.252675 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "seed.dbt_duckdb_analytics_poc.raw_products"} */

    create table "analytics_dev"."main"."raw_products" ("product_id" integer,"product_name" text,"category" text,"price" float8,"stock_quantity" integer,"supplier" text)
  
[0m17:57:17.252829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:17.252981 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_orders"
[0m17:57:17.253276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.253487 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "seed.dbt_duckdb_analytics_poc.raw_orders"} */

    create table "analytics_dev"."main"."raw_orders" ("order_id" integer,"customer_id" integer,"order_date" date,"total_amount" float8,"status" text,"payment_method" text)
  
[0m17:57:17.253649 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:57:17.253807 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_customers"
[0m17:57:17.253970 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.261914 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_products"
[0m17:57:17.262440 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:57:17.262737 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "seed.dbt_duckdb_analytics_poc.raw_customers"} */

    create table "analytics_dev"."main"."raw_customers" ("customer_id" integer,"first_name" text,"last_name" text,"email" text,"registration_date" date,"country" text)
  
[0m17:57:17.263301 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_order_items"
[0m17:57:17.263721 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: 
          COPY "analytics_dev"."main"."raw_products" FROM '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:57:17.265353 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_orders"
[0m17:57:17.265767 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "seed.dbt_duckdb_analytics_poc.raw_order_items"} */

    create table "analytics_dev"."main"."raw_order_items" ("order_item_id" integer,"order_id" integer,"product_id" integer,"quantity" integer,"unit_price" float8,"discount" float8)
  
[0m17:57:17.266236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.266541 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: 
          COPY "analytics_dev"."main"."raw_orders" FROM '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:57:17.267293 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_customers"
[0m17:57:17.267742 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: 
          COPY "analytics_dev"."main"."raw_customers" FROM '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:57:17.268034 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.268692 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_order_items"
[0m17:57:17.268885 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: 
          COPY "analytics_dev"."main"."raw_order_items" FROM '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:57:17.270683 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:57:17.270932 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:57:17.271153 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:57:17.271326 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:57:17.274429 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_duckdb_analytics_poc.raw_customers"
[0m17:57:17.274855 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_duckdb_analytics_poc.raw_products"
[0m17:57:17.275179 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_duckdb_analytics_poc.raw_order_items"
[0m17:57:17.275448 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_duckdb_analytics_poc.raw_orders"
[0m17:57:17.284732 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: COMMIT
[0m17:57:17.285084 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_products"
[0m17:57:17.285380 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: COMMIT
[0m17:57:17.286144 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: COMMIT
[0m17:57:17.286730 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: COMMIT
[0m17:57:17.287648 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: COMMIT
[0m17:57:17.287893 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_orders"
[0m17:57:17.288185 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_order_items"
[0m17:57:17.288435 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_duckdb_analytics_poc.raw_customers"
[0m17:57:17.288642 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: COMMIT
[0m17:57:17.288817 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:57:17.289042 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: COMMIT
[0m17:57:17.289273 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: COMMIT
[0m17:57:17.290598 [debug] [Thread-4 (]: On seed.dbt_duckdb_analytics_poc.raw_products: Close
[0m17:57:17.290888 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.291193 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:57:17.291619 [debug] [Thread-3 (]: On seed.dbt_duckdb_analytics_poc.raw_orders: Close
[0m17:57:17.292232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:17.292636 [debug] [Thread-2 (]: On seed.dbt_duckdb_analytics_poc.raw_order_items: Close
[0m17:57:17.293547 [debug] [Thread-1 (]: On seed.dbt_duckdb_analytics_poc.raw_customers: Close
[0m17:57:17.294849 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d68e0>]}
[0m17:57:17.295027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e7d90>]}
[0m17:57:17.295188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e7cf0>]}
[0m17:57:17.295340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9658b95-0797-4f5f-a22e-ae2718b81f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ce960>]}
[0m17:57:17.295644 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file main.raw_products ................................... [[32mINSERT 12[0m in 0.07s]
[0m17:57:17.295962 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 15[0m in 0.07s]
[0m17:57:17.296171 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file main.raw_order_items ................................ [[32mINSERT 24[0m in 0.07s]
[0m17:57:17.296757 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m17:57:17.296482 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.raw_customers .................................. [[32mINSERT 10[0m in 0.07s]
[0m17:57:17.297090 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m17:57:17.297334 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m17:57:17.297682 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m17:57:17.298592 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:17.298774 [debug] [MainThread]: On master: BEGIN
[0m17:57:17.298907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:17.299249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:17.299390 [debug] [MainThread]: On master: COMMIT
[0m17:57:17.299515 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:17.299632 [debug] [MainThread]: On master: COMMIT
[0m17:57:17.299879 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:17.300053 [debug] [MainThread]: On master: Close
[0m17:57:17.300238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:17.300355 [debug] [MainThread]: Connection 'seed.dbt_duckdb_analytics_poc.raw_customers' was properly closed.
[0m17:57:17.300461 [debug] [MainThread]: Connection 'seed.dbt_duckdb_analytics_poc.raw_order_items' was properly closed.
[0m17:57:17.300560 [debug] [MainThread]: Connection 'seed.dbt_duckdb_analytics_poc.raw_products' was properly closed.
[0m17:57:17.300656 [debug] [MainThread]: Connection 'seed.dbt_duckdb_analytics_poc.raw_orders' was properly closed.
[0m17:57:17.300796 [info ] [MainThread]: 
[0m17:57:17.300928 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m17:57:17.301439 [debug] [MainThread]: Command end result
[0m17:57:17.321689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m17:57:17.323573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m17:57:17.327172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m17:57:17.327456 [info ] [MainThread]: 
[0m17:57:17.327680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:17.327819 [info ] [MainThread]: 
[0m17:57:17.327997 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:57:17.332233 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.011426, "process_in_blocks": "0", "process_kernel_time": 0.493851, "process_mem_max_rss": "238944256", "process_out_blocks": "0", "process_user_time": 3.853708}
[0m17:57:17.332515 [debug] [MainThread]: Command `dbt seed` succeeded at 17:57:17.332469 after 6.01 seconds
[0m17:57:17.332724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d5910>]}
[0m17:57:17.332905 [debug] [MainThread]: Flushing usage events
[0m17:57:18.150226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:34.842835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0bc50>]}


============================== 17:57:34.846328 | ddbac008-5de0-4379-b943-604e62a32d8b ==============================
[0m17:57:34.846328 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:57:34.846660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:34.999093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108becc30>]}
[0m17:57:35.025169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8a360>]}
[0m17:57:35.028464 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m17:57:35.093322 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:57:35.206532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:35.206786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:35.243832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad3450>]}
[0m17:57:35.304121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m17:57:35.307579 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m17:57:35.331373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be3b60>]}
[0m17:57:35.331676 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m17:57:35.331861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092425f0>]}
[0m17:57:35.333123 [info ] [MainThread]: 
[0m17:57:35.333305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:35.333449 [info ] [MainThread]: 
[0m17:57:35.333716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:35.336270 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m17:57:35.416171 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m17:57:35.416466 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m17:57:35.416617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:35.512326 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m17:57:35.513285 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m17:57:35.513828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m17:57:35.514300 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m17:57:35.517866 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:35.518077 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m17:57:35.518222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:35.518757 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:35.519445 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:35.519588 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m17:57:35.519810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:35.519968 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:35.520091 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m17:57:35.520428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:35.520921 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m17:57:35.521074 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m17:57:35.521209 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m17:57:35.521412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:35.521563 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m17:57:35.522580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m17:57:35.522865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m17:57:35.525856 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m17:57:35.526653 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m17:57:35.526807 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m17:57:35.526954 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m17:57:35.527096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:35.527224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:35.527509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:57:35.527672 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m17:57:35.527803 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:57:35.527940 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m17:57:35.528074 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m17:57:35.528272 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m17:57:35.539039 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:57:35.539233 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:57:35.539996 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m17:57:35.540564 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m17:57:35.541606 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m17:57:35.541856 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m17:57:35.541992 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m17:57:35.542127 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m17:57:35.542807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109370390>]}
[0m17:57:35.543044 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:35.543172 [debug] [MainThread]: On master: BEGIN
[0m17:57:35.543287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:35.543536 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:35.543661 [debug] [MainThread]: On master: COMMIT
[0m17:57:35.543782 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:35.543895 [debug] [MainThread]: On master: COMMIT
[0m17:57:35.544061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:35.544179 [debug] [MainThread]: On master: Close
[0m17:57:35.545984 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m17:57:35.546301 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m17:57:35.546533 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m17:57:35.546765 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m17:57:35.547056 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m17:57:35.547256 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m17:57:35.547512 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m17:57:35.547934 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m17:57:35.547739 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m17:57:35.548215 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m17:57:35.548501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m17:57:35.553365 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.553704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m17:57:35.554012 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m17:57:35.554651 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m17:57:35.554872 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m17:57:35.555054 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m17:57:35.556553 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.557832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m17:57:35.559202 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m17:57:35.572700 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m17:57:35.572949 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m17:57:35.573188 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m17:57:35.579661 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m17:57:35.589706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m17:57:35.591197 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m17:57:35.592370 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.593644 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.594644 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m17:57:35.594836 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m17:57:35.594984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:35.595325 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m17:57:35.595544 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m17:57:35.595704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:57:35.596009 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.596246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.596438 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.596594 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m17:57:35.596779 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.596978 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m17:57:35.597154 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m17:57:35.597315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:35.597489 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m17:57:35.597659 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        date(registration_date) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - date(registration_date) as days_since_registration
    from source
)

select * from renamed
  );

[0m17:57:35.597853 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        date(order_date) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from date(order_date)) as order_year,
        extract(month from date(order_date)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m17:57:35.598077 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:35.598359 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.598632 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.598797 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m17:57:35.598979 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.599234 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.599426 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m17:57:35.599692 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.602949 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.603160 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m17:57:35.603397 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:57:35.604706 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.605149 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        date(registration_date) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - date(registration_date) as days_since_registration
    from source
)

select * from renamed
  );

[0m17:57:35.605407 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        date(order_date) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from date(order_date)) as order_year,
        extract(month from date(order_date)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m17:57:35.605606 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m17:57:35.605769 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:57:35.605911 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:35.606069 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:57:35.613047 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m17:57:35.613345 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: ROLLBACK
[0m17:57:35.613517 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:57:35.613726 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: ROLLBACK
[0m17:57:35.613928 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.614604 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m17:57:35.615693 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m17:57:35.615905 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.616158 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m17:57:35.616850 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:57:35.619367 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m17:57:35.619575 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:57:35.619745 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m17:57:35.620771 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m17:57:35.621114 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m17:57:35.621356 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:57:35.621577 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:57:35.622867 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m17:57:35.623598 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m17:57:35.630112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109395850>]}
[0m17:57:35.630643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b044aa0>]}
[0m17:57:35.630486 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.08s]
[0m17:57:35.631069 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m17:57:35.631427 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m17:57:35.631680 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m17:57:35.636032 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m17:57:35.637280 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m17:57:35.637948 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_duckdb_analytics_poc.stg_customers'
[0m17:57:35.638685 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m17:57:35.641032 [debug] [Thread-3 (]: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         date(order_date) as order_date,
                   ^
[0m17:57:35.641402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e30370>]}
[0m17:57:35.641780 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model main.stg_orders ........................... [[31mERROR[0m in 0.09s]
[0m17:57:35.642386 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m17:57:35.642709 [debug] [Thread-7 (]: Marking all children of 'model.dbt_duckdb_analytics_poc.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         date(order_date) as order_date,
                   ^.
[0m17:57:35.644510 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m17:57:35.644998 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         date(registration_date) as registration_date,
                   ^
[0m17:57:35.645523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbac008-5de0-4379-b943-604e62a32d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109719a50>]}
[0m17:57:35.645203 [info ] [Thread-2 (]: 5 of 8 SKIP relation main.dim_products ......................................... [[33mSKIP[0m]
[0m17:57:35.646258 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m17:57:35.646027 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.09s]
[0m17:57:35.646676 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m17:57:35.646923 [debug] [Thread-7 (]: Marking all children of 'model.dbt_duckdb_analytics_poc.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         date(registration_date) as registration_date,
                   ^.
[0m17:57:35.647322 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m17:57:35.647599 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m17:57:35.647851 [info ] [Thread-3 (]: 7 of 8 SKIP relation main.fct_orders ........................................... [[33mSKIP[0m]
[0m17:57:35.648153 [info ] [Thread-4 (]: 6 of 8 SKIP relation main.dim_customers ........................................ [[33mSKIP[0m]
[0m17:57:35.648420 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m17:57:35.648633 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m17:57:35.648962 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m17:57:35.649180 [info ] [Thread-2 (]: 8 of 8 SKIP relation main.core_business_metrics ................................ [[33mSKIP[0m]
[0m17:57:35.649412 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m17:57:35.650031 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:35.650199 [debug] [MainThread]: On master: BEGIN
[0m17:57:35.650329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:35.650661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:35.650791 [debug] [MainThread]: On master: COMMIT
[0m17:57:35.650917 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:35.651034 [debug] [MainThread]: On master: COMMIT
[0m17:57:35.651289 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:57:35.651493 [debug] [MainThread]: On master: Close
[0m17:57:35.651696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:35.651819 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_customers' was properly closed.
[0m17:57:35.651926 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_order_items' was properly closed.
[0m17:57:35.652031 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_products' was properly closed.
[0m17:57:35.652131 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_orders' was properly closed.
[0m17:57:35.652287 [info ] [MainThread]: 
[0m17:57:35.652426 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:57:35.652935 [debug] [MainThread]: Command end result
[0m17:57:35.707784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m17:57:35.709476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m17:57:35.713149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m17:57:35.713405 [info ] [MainThread]: 
[0m17:57:35.713609 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:57:35.713824 [info ] [MainThread]: 
[0m17:57:35.714063 [error] [MainThread]:   Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         date(order_date) as order_date,
                   ^
[0m17:57:35.714212 [info ] [MainThread]: 
[0m17:57:35.714368 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         date(registration_date) as registration_date,
                   ^
[0m17:57:35.714498 [info ] [MainThread]: 
[0m17:57:35.714640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=4 TOTAL=8
[0m17:57:35.716783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.919218, "process_in_blocks": "0", "process_kernel_time": 0.333101, "process_mem_max_rss": "147914752", "process_out_blocks": "0", "process_user_time": 1.326849}
[0m17:57:35.717091 [debug] [MainThread]: Command `dbt run` failed at 17:57:35.717033 after 0.92 seconds
[0m17:57:35.717339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d10050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ce7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b237c50>]}
[0m17:57:35.717547 [debug] [MainThread]: Flushing usage events
[0m17:57:36.217952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:28.706551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c60f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c60fc50>]}


============================== 18:00:28.709986 | 8a473a03-297e-4229-881e-ae87785bffa6 ==============================
[0m18:00:28.709986 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:00:28.710334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:00:28.885625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7ecc30>]}
[0m18:00:28.912373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c68a360>]}
[0m18:00:28.915808 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:00:28.976144 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:00:29.143129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:00:29.143614 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://models/staging/stg_customers.sql
[0m18:00:29.143833 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://models/staging/stg_orders.sql
[0m18:00:29.360830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb5f150>]}
[0m18:00:29.475421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:00:29.480273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:00:29.501359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4e1310>]}
[0m18:00:29.501685 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:00:29.501863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc42890>]}
[0m18:00:29.503082 [info ] [MainThread]: 
[0m18:00:29.503277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:29.503408 [info ] [MainThread]: 
[0m18:00:29.503635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:29.506231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:00:29.596373 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:00:29.596759 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:00:29.596939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:29.726643 [debug] [ThreadPool]: SQL status: OK in 0.130 seconds
[0m18:00:29.727711 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:00:29.728111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:00:29.728517 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:00:29.732152 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:00:29.732387 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:00:29.732537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:29.733182 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:29.733907 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:00:29.734051 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:00:29.734261 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:29.734408 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:00:29.734530 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:00:29.734976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:29.735446 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:00:29.735599 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:00:29.735728 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:00:29.735925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:29.736057 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:00:29.737106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m18:00:29.737335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:00:29.740652 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:00:29.741574 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:00:29.741754 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:00:29.741897 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:00:29.742035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:29.742165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:29.742509 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:00:29.742652 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:00:29.742776 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:00:29.742914 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:00:29.743056 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:00:29.743281 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:00:29.756488 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:00:29.756741 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:00:29.757541 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:00:29.758282 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:00:29.759389 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:00:29.759560 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:00:29.759877 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:00:29.760119 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:00:29.760875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccf2f70>]}
[0m18:00:29.761152 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:29.761297 [debug] [MainThread]: On master: BEGIN
[0m18:00:29.761423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:29.761732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:29.761859 [debug] [MainThread]: On master: COMMIT
[0m18:00:29.761982 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:29.762100 [debug] [MainThread]: On master: COMMIT
[0m18:00:29.762285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:29.762411 [debug] [MainThread]: On master: Close
[0m18:00:29.764447 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:00:29.764635 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:00:29.764811 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:00:29.764975 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:00:29.765216 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m18:00:29.765455 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m18:00:29.765678 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m18:00:29.765906 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m18:00:29.766153 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:00:29.766368 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:00:29.766561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:00:29.766734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:00:29.766890 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:00:29.767040 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:00:29.767185 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:00:29.767327 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:00:29.771335 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:00:29.772824 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.774360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:00:29.776114 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.777814 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:00:29.778056 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:00:29.778292 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:00:29.778500 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:00:29.798595 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:00:29.799013 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.800609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:00:29.802340 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.812521 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:00:29.812735 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:00:29.812909 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:29.813392 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.813712 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:00:29.813893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:29.814236 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.814429 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:00:29.814590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:29.814895 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:00:29.815096 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:00:29.815253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:29.815487 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:00:29.815676 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:00:29.815857 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        DATE(order_date) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from DATE(order_date)) as order_year,
        extract(month from DATE(order_date)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:00:29.816071 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:00:29.816281 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:00:29.816477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:00:29.816766 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.816966 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.817133 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:00:29.817319 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:00:29.817527 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:00:29.817729 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        DATE(registration_date) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - DATE(registration_date) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:00:29.818330 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:00:29.821399 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.821849 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        DATE(order_date) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from DATE(order_date)) as order_year,
        extract(month from DATE(order_date)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:00:29.822144 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        DATE(registration_date) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - DATE(registration_date) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:00:29.822335 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:00:29.822504 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:00:29.822694 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:00:29.822868 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:00:29.826780 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.827186 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: ROLLBACK
[0m18:00:29.827464 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: ROLLBACK
[0m18:00:29.827635 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:00:29.827798 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:00:29.830266 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.830584 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:00:29.830815 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:00:29.832192 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.832476 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:00:29.832788 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:00:29.839011 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:00:29.839267 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:00:29.839618 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.840399 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:00:29.840618 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:00:29.840804 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.841239 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:00:29.842000 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:00:29.844594 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:00:29.844799 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:00:29.845014 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:00:29.846294 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:00:29.846528 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:00:29.846910 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:00:29.848301 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:00:29.848951 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:00:29.849729 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:00:29.850830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cebf590>]}
[0m18:00:29.851002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9ad860>]}
[0m18:00:29.851366 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m18:00:29.851829 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:00:29.852094 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.08s]
[0m18:00:29.852449 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:00:29.855888 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:00:29.857223 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:00:29.857920 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_duckdb_analytics_poc.stg_customers'
[0m18:00:29.858612 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:00:29.860865 [debug] [Thread-3 (]: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         DATE(order_date) as order_date,
                   ^
[0m18:00:29.861192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7e65d0>]}
[0m18:00:29.861544 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model main.stg_orders ........................... [[31mERROR[0m in 0.10s]
[0m18:00:29.861822 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:00:29.862165 [debug] [Thread-7 (]: Marking all children of 'model.dbt_duckdb_analytics_poc.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         DATE(order_date) as order_date,
                   ^.
[0m18:00:29.864135 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:00:29.864869 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         DATE(registration_date) as registration_date,
                   ^
[0m18:00:29.864460 [info ] [Thread-4 (]: 5 of 8 SKIP relation main.dim_products ......................................... [[33mSKIP[0m]
[0m18:00:29.865171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a473a03-297e-4229-881e-ae87785bffa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da6ec50>]}
[0m18:00:29.865384 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:00:29.865772 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.10s]
[0m18:00:29.866218 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:00:29.866497 [debug] [Thread-7 (]: Marking all children of 'model.dbt_duckdb_analytics_poc.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         DATE(registration_date) as registration_date,
                   ^.
[0m18:00:29.866925 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:00:29.867171 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:00:29.867388 [info ] [Thread-3 (]: 7 of 8 SKIP relation main.fct_orders ........................................... [[33mSKIP[0m]
[0m18:00:29.867666 [info ] [Thread-2 (]: 6 of 8 SKIP relation main.dim_customers ........................................ [[33mSKIP[0m]
[0m18:00:29.867911 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:00:29.868150 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:00:29.868576 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:00:29.868821 [info ] [Thread-4 (]: 8 of 8 SKIP relation main.core_business_metrics ................................ [[33mSKIP[0m]
[0m18:00:29.869087 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:00:29.869755 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:29.869979 [debug] [MainThread]: On master: BEGIN
[0m18:00:29.870125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:29.870520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:29.870672 [debug] [MainThread]: On master: COMMIT
[0m18:00:29.870796 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:29.870909 [debug] [MainThread]: On master: COMMIT
[0m18:00:29.871105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:00:29.871232 [debug] [MainThread]: On master: Close
[0m18:00:29.871414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:29.871526 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_customers' was properly closed.
[0m18:00:29.871633 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_order_items' was properly closed.
[0m18:00:29.871735 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_orders' was properly closed.
[0m18:00:29.871834 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_products' was properly closed.
[0m18:00:29.871990 [info ] [MainThread]: 
[0m18:00:29.872123 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:00:29.872638 [debug] [MainThread]: Command end result
[0m18:00:29.888726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:00:29.890455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:00:29.894266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:00:29.894525 [info ] [MainThread]: 
[0m18:00:29.894709 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:00:29.894856 [info ] [MainThread]: 
[0m18:00:29.895021 [error] [MainThread]:   Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 15:         DATE(order_date) as order_date,
                   ^
[0m18:00:29.895152 [info ] [MainThread]: 
[0m18:00:29.895299 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  
  LINE 17:         DATE(registration_date) as registration_date,
                   ^
[0m18:00:29.895422 [info ] [MainThread]: 
[0m18:00:29.895558 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=4 TOTAL=8
[0m18:00:29.897400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.237197, "process_in_blocks": "0", "process_kernel_time": 0.392034, "process_mem_max_rss": "152518656", "process_out_blocks": "0", "process_user_time": 1.583956}
[0m18:00:29.897766 [debug] [MainThread]: Command `dbt run` failed at 18:00:29.897711 after 1.24 seconds
[0m18:00:29.898009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c641e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4e4110>]}
[0m18:00:29.898213 [debug] [MainThread]: Flushing usage events
[0m18:00:31.172583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:31.968319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100fc50>]}


============================== 18:01:31.972194 | 25dcb855-624b-47b0-9262-ec84a78c5010 ==============================
[0m18:01:31.972194 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:01:31.972516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:32.137138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ecc30>]}
[0m18:01:32.163855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11108a360>]}
[0m18:01:32.166943 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:01:32.232568 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:01:32.390685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:01:32.391400 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://models/staging/stg_orders.sql
[0m18:01:32.391662 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://models/staging/stg_customers.sql
[0m18:01:32.627908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11165f250>]}
[0m18:01:32.726300 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:01:32.728428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:01:32.750815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e36b0>]}
[0m18:01:32.751124 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:01:32.751297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173acf0>]}
[0m18:01:32.752498 [info ] [MainThread]: 
[0m18:01:32.752676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:32.752805 [info ] [MainThread]: 
[0m18:01:32.753076 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:32.755713 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:01:32.820083 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:01:32.820341 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:01:32.820482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:32.962135 [debug] [ThreadPool]: SQL status: OK in 0.142 seconds
[0m18:01:32.963022 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:01:32.963411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:01:32.963832 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:01:32.967088 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:01:32.967252 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:01:32.967392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:32.967817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.968441 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:01:32.968572 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:01:32.968760 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.968882 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:01:32.969001 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:01:32.969278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.969663 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:01:32.969792 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:01:32.969906 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:01:32.970074 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.970198 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:01:32.971134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m18:01:32.971341 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:01:32.974156 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:01:32.974905 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:01:32.975054 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:01:32.975181 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:01:32.975301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:32.975419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:32.975702 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:01:32.975828 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:01:32.975953 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:01:32.976171 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:01:32.976293 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:01:32.976420 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:01:32.987577 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:01:32.987826 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:01:32.988581 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:01:32.989306 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:01:32.990346 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:01:32.990495 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:01:32.990736 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:01:32.990896 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:01:32.991678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d6ea0>]}
[0m18:01:32.991933 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.992074 [debug] [MainThread]: On master: BEGIN
[0m18:01:32.992194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:32.992454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:32.992580 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.992701 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:32.992822 [debug] [MainThread]: On master: COMMIT
[0m18:01:32.993034 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:32.993227 [debug] [MainThread]: On master: Close
[0m18:01:32.995243 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:01:32.995433 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:01:32.995610 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:01:32.995760 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:01:32.995992 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m18:01:32.996225 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m18:01:32.996456 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m18:01:32.996691 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m18:01:32.996926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:01:32.997144 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:01:32.997338 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:01:32.997498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:01:32.997648 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:01:32.997795 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:01:32.997931 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:01:32.998066 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:01:33.001888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.003461 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.004858 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.006302 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.007270 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:01:33.007483 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:01:33.007653 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:01:33.007818 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:01:33.025304 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.026124 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.027669 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.029067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.030744 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.030914 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:01:33.031067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:33.031447 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.031635 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.031791 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.031947 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.032116 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:01:33.032275 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:01:33.032421 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:01:33.032559 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.032699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:33.032837 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:01:33.032974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:33.033129 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        CAST(order_date AS DATE) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from CAST(order_date AS DATE)) as order_year,
        extract(month from CAST(order_date AS DATE)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:01:33.033455 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.033604 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.033844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.034032 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.034190 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.034341 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.034477 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.034639 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:01:33.034816 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:01:33.037838 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.038049 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        CAST(registration_date AS DATE) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - CAST(registration_date AS DATE) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:01:33.038394 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:01:33.038663 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.038848 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.042077 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.043380 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.043564 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:01:33.043736 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:01:33.043905 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:01:33.044095 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:01:33.045327 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.050840 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:01:33.051291 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:01:33.051518 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.051689 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.051933 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.052089 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:01:33.052238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.053469 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.054692 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.055358 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:01:33.055535 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:01:33.055737 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:01:33.055915 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.056070 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.058711 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:01:33.058902 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:01:33.059075 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:01:33.059233 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:01:33.059463 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
drop view if exists "analytics_dev"."main"."stg_orders__dbt_backup" cascade
[0m18:01:33.061279 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:01:33.061878 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:01:33.062189 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.062376 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.062547 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.062696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.062841 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:01:33.062996 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:01:33.064261 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:01:33.065271 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:01:33.065601 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
drop view if exists "analytics_dev"."main"."stg_customers__dbt_backup" cascade
[0m18:01:33.065802 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.066733 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:01:33.066901 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:01:33.067432 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:01:33.067933 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:33.069139 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:01:33.069874 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:01:33.070034 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:01:33.070190 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:01:33.071030 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:01:33.071321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111892c90>]}
[0m18:01:33.071477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb22b0>]}
[0m18:01:33.071644 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.071817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcf7f0>]}
[0m18:01:33.072073 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.07s]
[0m18:01:33.072945 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:01:33.072299 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.07s]
[0m18:01:33.073449 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:01:33.073242 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.07s]
[0m18:01:33.073717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d40ad0>]}
[0m18:01:33.073933 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:01:33.074215 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:01:33.074458 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.08s]
[0m18:01:33.074778 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:01:33.074945 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:01:33.075160 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:01:33.075386 [info ] [Thread-1 (]: 6 of 8 START sql table model main.fct_orders ................................... [RUN]
[0m18:01:33.075615 [info ] [Thread-3 (]: 5 of 8 START sql table model main.dim_customers ................................ [RUN]
[0m18:01:33.075909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:01:33.076091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:01:33.076252 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:01:33.076393 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:01:33.076541 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:01:33.078382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.076733 [info ] [Thread-2 (]: 7 of 8 START sql table model main.dim_products ................................. [RUN]
[0m18:01:33.080024 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.080331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:01:33.080568 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:01:33.082573 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.083706 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:01:33.094028 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.094372 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:01:33.096011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.096197 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:01:33.097482 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.098110 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.098295 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: BEGIN
[0m18:01:33.098475 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.098653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:33.098834 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: BEGIN
[0m18:01:33.099011 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.099252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:33.099405 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: BEGIN
[0m18:01:33.099572 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.099755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:33.099907 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.100054 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.100235 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.100377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.100552 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select 
        *
    from "analytics_dev"."main"."stg_products"
),

product_sales as (
    select
        p.product_id,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.net_amount) as total_sales
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    where o.status = 'completed'
    group by p.product_id
),

final as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price,
        p.stock_quantity,
        p.supplier,
        p.stock_level,
        p.inventory_value,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_sales, 0) as total_sales,
        case
            when coalesce(ps.total_sales, 0) > 500 then 'High'
            when coalesce(ps.total_sales, 0) > 100 then 'Medium'
            else 'Low'
        end as product_performance
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
    );
  
  
[0m18:01:33.100865 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select 
        *
    from "analytics_dev"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        sum(total_amount) as lifetime_value
    from "analytics_dev"."main"."stg_orders"
    group by customer_id
),

final as (
    select
        c.customer_id,
        c.first_name,
        c.last_name,
        c.full_name,
        c.email,
        c.registration_date,
        c.country,
        c.days_since_registration,
        coalesce(co.order_count, 0) as order_count,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        case
            when coalesce(co.lifetime_value, 0) > 500 then 'High'
            when coalesce(co.lifetime_value, 0) > 100 then 'Medium'
            else 'Low'
        end as customer_value_segment
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
    );
  
  
[0m18:01:33.101088 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.101528 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */

  
    
    

    create  table
      "analytics_dev"."main"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."stg_orders"
),

order_items as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(gross_amount) as gross_order_amount,
        sum(net_amount) as net_order_amount
    from "analytics_dev"."main"."stg_order_items"
    group by order_id
),

customers as (
    select
        *
    from "analytics_dev"."main"."stg_customers"
),

final as (
    select
        o.order_id,
        o.customer_id,
        c.full_name as customer_name,
        c.country as customer_country,
        o.order_date,
        o.order_year,
        o.order_month,
        o.status,
        o.payment_method,
        o.total_amount as order_total_amount,
        oi.total_items,
        oi.gross_order_amount,
        oi.net_order_amount,
        o.is_completed,
        case
            when o.total_amount > 200 then 'Large'
            when o.total_amount > 50 then 'Medium'
            else 'Small'
        end as order_size
    from orders o
    join order_items oi on o.order_id = oi.order_id
    join customers c on o.customer_id = c.customer_id
)

select * from final
    );
  
  
[0m18:01:33.124730 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m18:01:33.130260 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.130586 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m18:01:33.130828 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m18:01:33.131034 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:01:33.145235 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.148444 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.149037 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:01:33.149339 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.149511 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m18:01:33.152995 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:01:33.153319 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:01:33.153664 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.154605 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:01:33.154866 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:01:33.155059 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:01:33.155259 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.156058 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:01:33.156250 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.156404 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:01:33.156663 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.157739 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:01:33.158041 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:01:33.158313 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.158474 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
drop table if exists "analytics_dev"."main"."dim_customers__dbt_backup" cascade
[0m18:01:33.159501 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:01:33.159670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.159961 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
drop table if exists "analytics_dev"."main"."dim_products__dbt_backup" cascade
[0m18:01:33.161044 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:01:33.161208 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.161482 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
drop table if exists "analytics_dev"."main"."fct_orders__dbt_backup" cascade
[0m18:01:33.162187 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: Close
[0m18:01:33.162447 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:01:33.162646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.163008 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111043f50>]}
[0m18:01:33.163765 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.dim_products: Close
[0m18:01:33.164317 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: Close
[0m18:01:33.164639 [info ] [Thread-3 (]: 5 of 8 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.09s]
[0m18:01:33.165036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fac410>]}
[0m18:01:33.165374 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:01:33.165621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fae750>]}
[0m18:01:33.166012 [info ] [Thread-2 (]: 7 of 8 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.08s]
[0m18:01:33.166642 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:01:33.166409 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.09s]
[0m18:01:33.166966 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:01:33.167311 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:01:33.167605 [info ] [Thread-4 (]: 8 of 8 START sql table model main.core_business_metrics ........................ [RUN]
[0m18:01:33.167878 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:01:33.168043 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:01:33.169967 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:01:33.171153 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:01:33.172792 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:01:33.174166 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:01:33.174395 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: BEGIN
[0m18:01:33.174551 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:33.174931 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:01:33.175080 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:01:33.175319 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */

  
    
    

    create  table
      "analytics_dev"."main"."core_business_metrics__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."fct_orders"
),

customers as (
    select
        *
    from "analytics_dev"."main"."dim_customers"
),

products as (
    select
        *
    from "analytics_dev"."main"."dim_products"
),

daily_sales as (
    select
        order_date,
        sum(net_order_amount) as daily_revenue,
        count(distinct order_id) as order_count,
        count(distinct customer_id) as customer_count,
        sum(total_items) as items_sold
    from orders
    where status = 'completed'
    group by order_date
),

country_sales as (
    select
        customer_country,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        count(distinct customer_id) as customer_count,
        sum(net_order_amount) / count(distinct customer_id) as revenue_per_customer
    from orders
    where status = 'completed'
    group by customer_country
),

category_sales as (
    select
        p.category,
        count(distinct o.order_id) as order_count,
        sum(oi.net_amount) as total_revenue,
        sum(oi.quantity) as quantity_sold
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    where o.status = 'completed'
    group by p.category
),

payment_method_analysis as (
    select
        payment_method,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        avg(net_order_amount) as avg_order_value
    from orders
    where status = 'completed'
    group by payment_method
),

final as (
    select
        'Overall' as metric_group,
        'Total Revenue' as metric_name,
        cast(sum(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Orders' as metric_name,
        cast(count(distinct order_id) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Average Order Value' as metric_name,
        cast(avg(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Customers' as metric_name,
        cast(count(distinct customer_id) as varchar) as metric_value
    from customers
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Products' as metric_name,
        cast(count(distinct product_id) as varchar) as metric_value
    from products
    
    union all
    
    select
        'Time' as metric_group,
        'Date with Highest Revenue' as metric_name,
        cast(order_date as varchar) as metric_value
    from daily_sales
    order by daily_revenue desc
    limit 1
    
    union all
    
    select
        'Geography' as metric_group,
        'Top Country by Revenue' as metric_name,
        customer_country as metric_value
    from country_sales
    order by total_revenue desc
    limit 1
    
    union all
    
    select
        'Product' as metric_group,
        'Top Category by Revenue' as metric_name,
        category as metric_value
    from category_sales
    order by total_revenue desc
    limit 1
    
    union all
    
    select
        'Customer' as metric_group,
        'Top Payment Method' as metric_name,
        payment_method as metric_value
    from payment_method_analysis
    order by order_count desc
    limit 1
)

select * from final
    );
  
  
[0m18:01:33.177666 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */

  
    
    

    create  table
      "analytics_dev"."main"."core_business_metrics__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."fct_orders"
),

customers as (
    select
        *
    from "analytics_dev"."main"."dim_customers"
),

products as (
    select
        *
    from "analytics_dev"."main"."dim_products"
),

daily_sales as (
    select
        order_date,
        sum(net_order_amount) as daily_revenue,
        count(distinct order_id) as order_count,
        count(distinct customer_id) as customer_count,
        sum(total_items) as items_sold
    from orders
    where status = 'completed'
    group by order_date
),

country_sales as (
    select
        customer_country,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        count(distinct customer_id) as customer_count,
        sum(net_order_amount) / count(distinct customer_id) as revenue_per_customer
    from orders
    where status = 'completed'
    group by customer_country
),

category_sales as (
    select
        p.category,
        count(distinct o.order_id) as order_count,
        sum(oi.net_amount) as total_revenue,
        sum(oi.quantity) as quantity_sold
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    where o.status = 'completed'
    group by p.category
),

payment_method_analysis as (
    select
        payment_method,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        avg(net_order_amount) as avg_order_value
    from orders
    where status = 'completed'
    group by payment_method
),

final as (
    select
        'Overall' as metric_group,
        'Total Revenue' as metric_name,
        cast(sum(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Orders' as metric_name,
        cast(count(distinct order_id) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Average Order Value' as metric_name,
        cast(avg(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Customers' as metric_name,
        cast(count(distinct customer_id) as varchar) as metric_value
    from customers
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Products' as metric_name,
        cast(count(distinct product_id) as varchar) as metric_value
    from products
    
    union all
    
    select
        'Time' as metric_group,
        'Date with Highest Revenue' as metric_name,
        cast(order_date as varchar) as metric_value
    from daily_sales
    order by daily_revenue desc
    limit 1
    
    union all
    
    select
        'Geography' as metric_group,
        'Top Country by Revenue' as metric_name,
        customer_country as metric_value
    from country_sales
    order by total_revenue desc
    limit 1
    
    union all
    
    select
        'Product' as metric_group,
        'Top Category by Revenue' as metric_name,
        category as metric_value
    from category_sales
    order by total_revenue desc
    limit 1
    
    union all
    
    select
        'Customer' as metric_group,
        'Top Payment Method' as metric_name,
        payment_method as metric_value
    from payment_method_analysis
    order by order_count desc
    limit 1
)

select * from final
    );
  
  
[0m18:01:33.178003 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:01:33.178239 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: ROLLBACK
[0m18:01:33.197410 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_duckdb_analytics_poc.core_business_metrics'
[0m18:01:33.197661 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: Close
[0m18:01:33.199682 [debug] [Thread-4 (]: Runtime Error in model core_business_metrics (models/core/core_business_metrics.sql)
  Parser Error: syntax error at or near "union"
[0m18:01:33.200003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dcb855-624b-47b0-9262-ec84a78c5010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a45130>]}
[0m18:01:33.200342 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model main.core_business_metrics ............... [[31mERROR[0m in 0.03s]
[0m18:01:33.200650 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:01:33.200951 [debug] [Thread-7 (]: Marking all children of 'model.dbt_duckdb_analytics_poc.core_business_metrics' to be skipped because of status 'error'.  Reason: Runtime Error in model core_business_metrics (models/core/core_business_metrics.sql)
  Parser Error: syntax error at or near "union".
[0m18:01:33.201971 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:33.202127 [debug] [MainThread]: On master: BEGIN
[0m18:01:33.202259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:33.202634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:33.202809 [debug] [MainThread]: On master: COMMIT
[0m18:01:33.202949 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:33.203074 [debug] [MainThread]: On master: COMMIT
[0m18:01:33.203281 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:01:33.203410 [debug] [MainThread]: On master: Close
[0m18:01:33.203585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:33.203711 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.fct_orders' was properly closed.
[0m18:01:33.203826 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_products' was properly closed.
[0m18:01:33.203932 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_customers' was properly closed.
[0m18:01:33.204031 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m18:01:33.204197 [info ] [MainThread]: 
[0m18:01:33.204337 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:01:33.205043 [debug] [MainThread]: Command end result
[0m18:01:33.223658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:01:33.224956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:01:33.228966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:01:33.229136 [info ] [MainThread]: 
[0m18:01:33.229308 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:01:33.229443 [info ] [MainThread]: 
[0m18:01:33.229606 [error] [MainThread]:   Runtime Error in model core_business_metrics (models/core/core_business_metrics.sql)
  Parser Error: syntax error at or near "union"
[0m18:01:33.229737 [info ] [MainThread]: 
[0m18:01:33.229875 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m18:01:33.231803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3131871, "process_in_blocks": "0", "process_kernel_time": 0.387364, "process_mem_max_rss": "163446784", "process_out_blocks": "0", "process_user_time": 1.644116}
[0m18:01:33.232017 [debug] [MainThread]: Command `dbt run` failed at 18:01:33.231974 after 1.31 seconds
[0m18:01:33.232209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6b890>]}
[0m18:01:33.232372 [debug] [MainThread]: Flushing usage events
[0m18:01:33.904606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:23.989199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104278830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540bc50>]}


============================== 18:03:23.992577 | ed9f20c2-bf6e-4dde-927c-89266fd2c882 ==============================
[0m18:03:23.992577 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:03:23.992901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:03:24.207402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e8c30>]}
[0m18:03:24.235905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548a360>]}
[0m18:03:24.256133 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:03:24.334666 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:03:24.471022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:24.471473 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://models/core/core_business_metrics.sql
[0m18:03:24.650793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5f550>]}
[0m18:03:24.714590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:03:24.716553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:03:24.770290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e2f4d0>]}
[0m18:03:24.770613 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:03:24.770790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105865470>]}
[0m18:03:24.772019 [info ] [MainThread]: 
[0m18:03:24.772201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:24.772340 [info ] [MainThread]: 
[0m18:03:24.772601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:24.775209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:03:24.899023 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:03:24.899351 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:03:24.899507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:25.032238 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m18:03:25.033322 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:03:25.033688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:03:25.033951 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:03:25.037229 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:25.037395 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:03:25.037527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:25.037952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:25.038577 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:25.038710 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:03:25.038896 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:25.039022 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:25.039141 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:03:25.039646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:25.040118 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:03:25.040271 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:25.040401 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:03:25.040598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:25.040737 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:03:25.041673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m18:03:25.044542 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:03:25.044822 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:03:25.045004 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:03:25.046981 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:03:25.047224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:25.047437 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:03:25.047766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:25.047979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:25.048128 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:03:25.048260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:25.048415 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:03:25.048587 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:03:25.048829 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:03:25.061542 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:25.061806 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:25.062716 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:03:25.063385 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:03:25.064524 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:03:25.064802 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:03:25.064974 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:03:25.065122 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:03:25.066286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3a820>]}
[0m18:03:25.066627 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:25.066774 [debug] [MainThread]: On master: BEGIN
[0m18:03:25.066906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:25.067236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:25.067367 [debug] [MainThread]: On master: COMMIT
[0m18:03:25.067492 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:25.067609 [debug] [MainThread]: On master: COMMIT
[0m18:03:25.067834 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:25.068001 [debug] [MainThread]: On master: Close
[0m18:03:25.071448 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:03:25.071658 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:03:25.071828 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:03:25.071978 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:03:25.072232 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m18:03:25.072459 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m18:03:25.072686 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m18:03:25.072905 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m18:03:25.073135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:03:25.073363 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:03:25.073578 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:03:25.073748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:03:25.073907 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:03:25.074061 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:03:25.074211 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:03:25.074356 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:03:25.078409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.079731 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.081051 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.082542 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.083521 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:03:25.083768 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:03:25.096467 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:03:25.113739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.115387 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.117310 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.117532 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:03:25.119242 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.119887 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.120149 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.120340 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:03:25.120575 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.120782 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:03:25.120967 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.121274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:25.121801 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:03:25.122011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:03:25.122204 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:03:25.122598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:25.122923 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.123182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:03:25.123387 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.123674 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.123948 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.124128 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.124336 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        CAST(registration_date AS DATE) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - CAST(registration_date AS DATE) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:03:25.124545 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.124835 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.125065 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:03:25.125373 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.125599 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        CAST(order_date AS DATE) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from CAST(order_date AS DATE)) as order_year,
        extract(month from CAST(order_date AS DATE)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:03:25.125989 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:03:25.126219 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.129895 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.130103 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:03:25.130409 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:03:25.130666 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:03:25.130961 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:03:25.132749 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.132968 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:03:25.134360 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.135902 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.136123 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:03:25.137562 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.137783 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:03:25.137974 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:03:25.138262 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:03:25.138474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.138783 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.140173 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.140336 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.141541 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.141691 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:03:25.142008 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:03:25.143213 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.143391 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:03:25.149709 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:03:25.150088 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:03:25.150388 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.150555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.150766 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.150913 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:03:25.151055 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.151649 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:03:25.152180 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:03:25.152824 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:03:25.153004 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.153155 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.153301 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.153442 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:03:25.153630 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:03:25.153786 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:03:25.153936 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.156718 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:03:25.156919 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:03:25.157091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:03:25.157279 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:03:25.157466 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:03:25.158370 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:03:25.159310 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:03:25.162688 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:03:25.162865 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m18:03:25.163049 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
drop view if exists "analytics_dev"."main"."stg_customers__dbt_backup" cascade
[0m18:03:25.163219 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:03:25.163376 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
drop view if exists "analytics_dev"."main"."stg_orders__dbt_backup" cascade
[0m18:03:25.164590 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:03:25.165355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.165533 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.165789 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.166412 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:03:25.167288 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:03:25.167930 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:03:25.168484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdbe90>]}
[0m18:03:25.168640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6a360>]}
[0m18:03:25.168826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1bd90>]}
[0m18:03:25.168961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044337f0>]}
[0m18:03:25.169206 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.09s]
[0m18:03:25.169473 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.10s]
[0m18:03:25.169726 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.10s]
[0m18:03:25.170202 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:03:25.169945 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.09s]
[0m18:03:25.170461 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:03:25.170680 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:03:25.170956 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:03:25.171324 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:03:25.171696 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:03:25.171562 [info ] [Thread-1 (]: 6 of 8 START sql table model main.dim_products ................................. [RUN]
[0m18:03:25.171909 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:25.172092 [info ] [Thread-3 (]: 7 of 8 START sql table model main.fct_orders ................................... [RUN]
[0m18:03:25.172294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:03:25.172492 [info ] [Thread-4 (]: 5 of 8 START sql table model main.dim_customers ................................ [RUN]
[0m18:03:25.172678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:03:25.172838 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:03:25.173007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:03:25.173147 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:03:25.174738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.174915 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:25.176491 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.178373 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.179181 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:03:25.179384 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:03:25.189296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.191075 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.191425 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:25.192722 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.193156 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.193341 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: BEGIN
[0m18:03:25.193533 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.193704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:03:25.193875 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: BEGIN
[0m18:03:25.194083 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.194392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:25.194626 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: BEGIN
[0m18:03:25.194879 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.195149 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:03:25.195341 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.195519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.195807 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */

  
    
    

    create  table
      "analytics_dev"."main"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."stg_orders"
),

order_items as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(gross_amount) as gross_order_amount,
        sum(net_amount) as net_order_amount
    from "analytics_dev"."main"."stg_order_items"
    group by order_id
),

customers as (
    select
        *
    from "analytics_dev"."main"."stg_customers"
),

final as (
    select
        o.order_id,
        o.customer_id,
        c.full_name as customer_name,
        c.country as customer_country,
        o.order_date,
        o.order_year,
        o.order_month,
        o.status,
        o.payment_method,
        o.total_amount as order_total_amount,
        oi.total_items,
        oi.gross_order_amount,
        oi.net_order_amount,
        o.is_completed,
        case
            when o.total_amount > 200 then 'Large'
            when o.total_amount > 50 then 'Medium'
            else 'Small'
        end as order_size
    from orders o
    join order_items oi on o.order_id = oi.order_id
    join customers c on o.customer_id = c.customer_id
)

select * from final
    );
  
  
[0m18:03:25.196031 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.196235 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.196580 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.196768 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select 
        *
    from "analytics_dev"."main"."stg_products"
),

product_sales as (
    select
        p.product_id,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.net_amount) as total_sales
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    where o.status = 'completed'
    group by p.product_id
),

final as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price,
        p.stock_quantity,
        p.supplier,
        p.stock_level,
        p.inventory_value,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_sales, 0) as total_sales,
        case
            when coalesce(ps.total_sales, 0) > 500 then 'High'
            when coalesce(ps.total_sales, 0) > 100 then 'Medium'
            else 'Low'
        end as product_performance
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
    );
  
  
[0m18:03:25.197038 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select 
        *
    from "analytics_dev"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        sum(total_amount) as lifetime_value
    from "analytics_dev"."main"."stg_orders"
    group by customer_id
),

final as (
    select
        c.customer_id,
        c.first_name,
        c.last_name,
        c.full_name,
        c.email,
        c.registration_date,
        c.country,
        c.days_since_registration,
        coalesce(co.order_count, 0) as order_count,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        case
            when coalesce(co.lifetime_value, 0) > 500 then 'High'
            when coalesce(co.lifetime_value, 0) > 100 then 'Medium'
            else 'Low'
        end as customer_value_segment
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
    );
  
  
[0m18:03:25.204774 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m18:03:25.206380 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.206566 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:03:25.206829 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:03:25.207090 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m18:03:25.209175 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.210501 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.210711 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m18:03:25.210901 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:03:25.211106 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m18:03:25.212507 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.212762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.212958 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:03:25.213125 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.214517 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.215743 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.215905 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.216067 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:03:25.216245 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m18:03:25.218730 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:03:25.219041 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.219211 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:03:25.219435 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.219636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.220338 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:03:25.221023 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:03:25.221184 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.221342 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.221496 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.222763 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:25.222934 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:03:25.223095 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:03:25.223249 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
drop table if exists "analytics_dev"."main"."dim_customers__dbt_backup" cascade
[0m18:03:25.223751 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.224675 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:03:25.224835 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
drop table if exists "analytics_dev"."main"."fct_orders__dbt_backup" cascade
[0m18:03:25.224995 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.225137 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.225783 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: Close
[0m18:03:25.226684 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:03:25.226866 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:03:25.227149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417d20>]}
[0m18:03:25.227324 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
drop table if exists "analytics_dev"."main"."dim_products__dbt_backup" cascade
[0m18:03:25.228016 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.fct_orders: Close
[0m18:03:25.228366 [info ] [Thread-4 (]: 5 of 8 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.05s]
[0m18:03:25.228692 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5f950>]}
[0m18:03:25.228928 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:25.229364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:25.229206 [info ] [Thread-3 (]: 7 of 8 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.06s]
[0m18:03:25.230050 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: Close
[0m18:03:25.230279 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:03:25.230501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105663290>]}
[0m18:03:25.230781 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.06s]
[0m18:03:25.231019 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:03:25.231312 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:03:25.231559 [info ] [Thread-2 (]: 8 of 8 START sql table model main.core_business_metrics ........................ [RUN]
[0m18:03:25.231774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:03:25.231938 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:03:25.234164 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.234985 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:03:25.236390 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.237123 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.237327 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: BEGIN
[0m18:03:25.237480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:03:25.237819 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.237972 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.238222 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */

  
    
    

    create  table
      "analytics_dev"."main"."core_business_metrics__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."fct_orders"
),

customers as (
    select
        *
    from "analytics_dev"."main"."dim_customers"
),

products as (
    select
        *
    from "analytics_dev"."main"."dim_products"
),

daily_sales as (
    select
        order_date,
        sum(net_order_amount) as daily_revenue,
        count(distinct order_id) as order_count,
        count(distinct customer_id) as customer_count,
        sum(total_items) as items_sold
    from orders
    where status = 'completed'
    group by order_date
),

country_sales as (
    select
        customer_country,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        count(distinct customer_id) as customer_count,
        sum(net_order_amount) / count(distinct customer_id) as revenue_per_customer
    from orders
    where status = 'completed'
    group by customer_country
),

category_sales as (
    select
        p.category,
        count(distinct o.order_id) as order_count,
        sum(oi.net_amount) as total_revenue,
        sum(oi.quantity) as quantity_sold
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    where o.status = 'completed'
    group by p.category
),

payment_method_analysis as (
    select
        payment_method,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        avg(net_order_amount) as avg_order_value
    from orders
    where status = 'completed'
    group by payment_method
),

final as (
    select
        'Overall' as metric_group,
        'Total Revenue' as metric_name,
        cast(sum(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Orders' as metric_name,
        cast(count(distinct order_id) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Average Order Value' as metric_name,
        cast(avg(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Customers' as metric_name,
        cast(count(distinct customer_id) as varchar) as metric_value
    from customers
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Products' as metric_name,
        cast(count(distinct product_id) as varchar) as metric_value
    from products
    
    union all
    
    (select
        'Time' as metric_group,
        'Date with Highest Revenue' as metric_name,
        cast(order_date as varchar) as metric_value
    from daily_sales
    order by daily_revenue desc
    limit 1)
    
    union all
    
    (select
        'Geography' as metric_group,
        'Top Country by Revenue' as metric_name,
        customer_country as metric_value
    from country_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Product' as metric_group,
        'Top Category by Revenue' as metric_name,
        category as metric_value
    from category_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Customer' as metric_group,
        'Top Payment Method' as metric_name,
        payment_method as metric_value
    from payment_method_analysis
    order by order_count desc
    limit 1)
)

select * from final
    );
  
  
[0m18:03:25.245149 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:03:25.246817 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.247003 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
alter table "analytics_dev"."main"."core_business_metrics__dbt_tmp" rename to "core_business_metrics"
[0m18:03:25.247369 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.248016 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:03:25.248188 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.248327 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:03:25.248698 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.249900 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:03:25.250068 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
drop table if exists "analytics_dev"."main"."core_business_metrics__dbt_backup" cascade
[0m18:03:25.250325 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:03:25.250925 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: Close
[0m18:03:25.251200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed9f20c2-bf6e-4dde-927c-89266fd2c882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104348e30>]}
[0m18:03:25.251504 [info ] [Thread-2 (]: 8 of 8 OK created sql table model main.core_business_metrics ................... [[32mOK[0m in 0.02s]
[0m18:03:25.251753 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:03:25.252423 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:25.252559 [debug] [MainThread]: On master: BEGIN
[0m18:03:25.252677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:25.252919 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:25.253046 [debug] [MainThread]: On master: COMMIT
[0m18:03:25.253164 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:25.253276 [debug] [MainThread]: On master: COMMIT
[0m18:03:25.253441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:25.253560 [debug] [MainThread]: On master: Close
[0m18:03:25.253715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:25.253824 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_products' was properly closed.
[0m18:03:25.253924 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m18:03:25.254022 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.fct_orders' was properly closed.
[0m18:03:25.254116 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_customers' was properly closed.
[0m18:03:25.254263 [info ] [MainThread]: 
[0m18:03:25.254396 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m18:03:25.255059 [debug] [MainThread]: Command end result
[0m18:03:25.273430 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:03:25.276804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:03:25.280516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:03:25.280747 [info ] [MainThread]: 
[0m18:03:25.280949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:25.281095 [info ] [MainThread]: 
[0m18:03:25.281238 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:03:25.283501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3503737, "process_in_blocks": "0", "process_kernel_time": 0.384819, "process_mem_max_rss": "174129152", "process_out_blocks": "0", "process_user_time": 1.557141}
[0m18:03:25.283788 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:25.283732 after 1.35 seconds
[0m18:03:25.284000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d13dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fbd70>]}
[0m18:03:25.284287 [debug] [MainThread]: Flushing usage events
[0m18:03:25.986492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:45.859714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112410830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350bc50>]}


============================== 18:03:45.866212 | 153a3659-d230-4cab-8303-81c3adcdfc21 ==============================
[0m18:03:45.866212 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:03:45.867104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m18:03:46.046025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e8c30>]}
[0m18:03:46.073806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11358a360>]}
[0m18:03:46.077204 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:03:46.199155 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:03:46.358905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:46.359159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:46.398541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d3450>]}
[0m18:03:46.464900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:03:46.467336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:03:46.497173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e3b60>]}
[0m18:03:46.497515 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:03:46.497701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b425f0>]}
[0m18:03:46.498807 [info ] [MainThread]: 
[0m18:03:46.498996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:46.499127 [info ] [MainThread]: 
[0m18:03:46.499395 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:46.499982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:03:46.580007 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:03:46.580270 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:03:46.580422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:46.731939 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m18:03:46.733047 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:03:46.733406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:03:46.733658 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:03:46.736947 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:46.737110 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:03:46.737239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:46.737682 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:46.738306 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:46.738430 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:03:46.738615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:46.738732 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:46.738851 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:03:46.739551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:46.740037 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:03:46.740185 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:03:46.740308 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:03:46.740513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:46.740646 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:03:46.743574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m18:03:46.743830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:03:46.746626 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:03:46.747400 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:03:46.747556 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:03:46.747694 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:03:46.747822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:46.747973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:46.748274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:03:46.748406 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:03:46.748530 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:03:46.748669 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:03:46.748811 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:03:46.749019 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:03:46.761735 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:46.761959 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:46.762647 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:03:46.763357 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:03:46.768557 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:03:46.768767 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:03:46.769029 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:03:46.769194 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:03:46.770290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c75570>]}
[0m18:03:46.770545 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:46.770681 [debug] [MainThread]: On master: BEGIN
[0m18:03:46.770800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:46.771102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:46.771260 [debug] [MainThread]: On master: COMMIT
[0m18:03:46.771394 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:46.771514 [debug] [MainThread]: On master: COMMIT
[0m18:03:46.771716 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:46.771857 [debug] [MainThread]: On master: Close
[0m18:03:46.773525 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:46.773807 [info ] [Thread-1 (]: 1 of 1 START sql table model main.dim_customers ................................ [RUN]
[0m18:03:46.774035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:03:46.774196 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:46.778248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.778816 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:46.796653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.797671 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.797850 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: BEGIN
[0m18:03:46.797992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:46.798350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:46.798487 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.798644 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select 
        *
    from "analytics_dev"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        sum(total_amount) as lifetime_value
    from "analytics_dev"."main"."stg_orders"
    group by customer_id
),

final as (
    select
        c.customer_id,
        c.first_name,
        c.last_name,
        c.full_name,
        c.email,
        c.registration_date,
        c.country,
        c.days_since_registration,
        coalesce(co.order_count, 0) as order_count,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        case
            when coalesce(co.lifetime_value, 0) > 500 then 'High'
            when coalesce(co.lifetime_value, 0) > 100 then 'Medium'
            else 'Low'
        end as customer_value_segment
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
    );
  
  
[0m18:03:46.807979 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:03:46.811419 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.811620 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:03:46.812206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:46.813502 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.813673 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:03:46.813936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:46.821317 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:03:46.821512 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.821663 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:03:46.823338 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:46.825721 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:03:46.825901 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
drop table if exists "analytics_dev"."main"."dim_customers__dbt_backup" cascade
[0m18:03:46.826304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:03:46.827512 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_customers: Close
[0m18:03:46.828859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '153a3659-d230-4cab-8303-81c3adcdfc21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c96b10>]}
[0m18:03:46.829169 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.05s]
[0m18:03:46.829446 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:03:46.830195 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:46.830372 [debug] [MainThread]: On master: BEGIN
[0m18:03:46.830520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:46.830801 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:46.830956 [debug] [MainThread]: On master: COMMIT
[0m18:03:46.831089 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:46.831207 [debug] [MainThread]: On master: COMMIT
[0m18:03:46.831392 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:46.831519 [debug] [MainThread]: On master: Close
[0m18:03:46.831692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:46.831810 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_customers' was properly closed.
[0m18:03:46.831918 [debug] [MainThread]: Connection 'list_analytics_dev_snapshots' was properly closed.
[0m18:03:46.832045 [info ] [MainThread]: 
[0m18:03:46.832182 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:03:46.832484 [debug] [MainThread]: Command end result
[0m18:03:46.890924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:03:46.892874 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:03:46.896957 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:03:46.897184 [info ] [MainThread]: 
[0m18:03:46.897381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:46.897515 [info ] [MainThread]: 
[0m18:03:46.897653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:03:46.899778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1123236, "process_in_blocks": "0", "process_kernel_time": 0.356499, "process_mem_max_rss": "149929984", "process_out_blocks": "0", "process_user_time": 1.352393}
[0m18:03:46.900064 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:46.900015 after 1.11 seconds
[0m18:03:46.900268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e5ef0>]}
[0m18:03:46.900460 [debug] [MainThread]: Flushing usage events
[0m18:03:47.434768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:33.428688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800fc50>]}


============================== 18:04:33.435561 | bd7f022d-e69f-47af-96e8-1132c02dc757 ==============================
[0m18:04:33.435561 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:04:33.435899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging.*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:33.630816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ecc30>]}
[0m18:04:33.660495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808a360>]}
[0m18:04:33.664046 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:04:33.726306 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:04:33.860657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:33.860911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:33.901098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d3450>]}
[0m18:04:33.966630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:04:33.969533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:04:33.995052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e3b60>]}
[0m18:04:33.995374 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:04:33.995554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a5f0>]}
[0m18:04:33.996869 [info ] [MainThread]: 
[0m18:04:33.997120 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:33.997258 [info ] [MainThread]: 
[0m18:04:33.997534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:33.999974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:04:34.074243 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:04:34.074499 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:04:34.074652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:34.214530 [debug] [ThreadPool]: SQL status: OK in 0.140 seconds
[0m18:04:34.215722 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:04:34.216076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:04:34.216525 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:04:34.219920 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:04:34.220095 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:04:34.220235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:34.220655 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:34.221456 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:04:34.221581 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:04:34.221768 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:34.221893 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:04:34.222012 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:04:34.222499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:34.222970 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:04:34.223122 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:04:34.223249 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:04:34.223444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:34.223573 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:04:34.224544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_snapshots)
[0m18:04:34.224770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:04:34.227611 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:04:34.228449 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:04:34.228640 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:04:34.228792 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:04:34.228928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:34.229064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:34.229321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:34.229471 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:04:34.229603 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:34.229742 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:04:34.229885 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:04:34.230091 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:04:34.242008 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:04:34.242172 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:04:34.242947 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:04:34.243566 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:04:34.245964 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:04:34.246209 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:04:34.246343 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:04:34.246479 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:04:34.247534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108764050>]}
[0m18:04:34.247815 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:34.247951 [debug] [MainThread]: On master: BEGIN
[0m18:04:34.248068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:34.248324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:34.248450 [debug] [MainThread]: On master: COMMIT
[0m18:04:34.248569 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:34.248681 [debug] [MainThread]: On master: COMMIT
[0m18:04:34.248850 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:34.248977 [debug] [MainThread]: On master: Close
[0m18:04:34.251024 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:04:34.251201 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:04:34.251359 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:04:34.251502 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:04:34.251748 [info ] [Thread-4 (]: 4 of 4 START sql view model main.stg_products .................................. [RUN]
[0m18:04:34.251993 [info ] [Thread-3 (]: 3 of 4 START sql view model main.stg_orders .................................... [RUN]
[0m18:04:34.252233 [info ] [Thread-1 (]: 1 of 4 START sql view model main.stg_customers ................................. [RUN]
[0m18:04:34.252458 [info ] [Thread-2 (]: 2 of 4 START sql view model main.stg_order_items ............................... [RUN]
[0m18:04:34.252698 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:04:34.252916 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:04:34.253087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:04:34.253246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:04:34.253398 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:04:34.253541 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:04:34.253679 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:04:34.253812 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:04:34.257655 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.259155 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.260584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.262127 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.269327 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:04:34.269646 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:04:34.285719 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.286007 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:04:34.287542 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.287711 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:04:34.289008 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.290498 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.290883 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.291090 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.291277 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:04:34.291451 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:04:34.291623 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.291768 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:04:34.291934 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.292072 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:04:34.292223 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:04:34.292500 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:04:34.292722 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.292891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:34.293075 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.293219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:34.293369 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.293566 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.293758 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.293948 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:04:34.294118 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.294291 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        CAST(order_date AS DATE) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from CAST(order_date AS DATE)) as order_year,
        extract(month from CAST(order_date AS DATE)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:04:34.294469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.294705 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.294962 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        CAST(registration_date AS DATE) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - CAST(registration_date AS DATE) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:04:34.295177 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:04:34.295367 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.295508 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.298841 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.300204 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.300416 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:04:34.300591 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:04:34.300752 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:04:34.300922 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:04:34.304155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.305530 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.305914 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:04:34.306201 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:04:34.306398 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.306561 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.307830 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.345828 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.346093 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m18:04:34.346258 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m18:04:34.346550 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:04:34.346822 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:04:34.348285 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.349640 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.349998 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:04:34.350205 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:04:34.350369 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:04:34.357387 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:04:34.357632 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m18:04:34.357804 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:04:34.358084 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.358273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:34.358905 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:04:34.359470 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:04:34.359659 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:04:34.360190 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:04:34.360351 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.360519 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.360774 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.360959 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:04:34.361173 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:04:34.361362 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:04:34.361869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.362064 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:04:34.364542 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:04:34.364738 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:34.364940 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:34.366305 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:04:34.366520 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
drop view if exists "analytics_dev"."main"."stg_orders__dbt_backup" cascade
[0m18:04:34.367532 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:04:34.368513 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:04:34.368725 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:04:34.368960 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:04:34.369131 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
drop view if exists "analytics_dev"."main"."stg_customers__dbt_backup" cascade
[0m18:04:34.369327 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:04:34.370749 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:04:34.370972 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:34.371179 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:34.371360 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:34.372723 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:04:34.373388 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:04:34.374045 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:04:34.374714 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108797050>]}
[0m18:04:34.374916 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b410d0>]}
[0m18:04:34.375066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b30af0>]}
[0m18:04:34.375466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd7f022d-e69f-47af-96e8-1132c02dc757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d4170>]}
[0m18:04:34.375313 [info ] [Thread-3 (]: 3 of 4 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.12s]
[0m18:04:34.375714 [info ] [Thread-4 (]: 4 of 4 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.12s]
[0m18:04:34.376026 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.12s]
[0m18:04:34.376498 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:04:34.376284 [info ] [Thread-2 (]: 2 of 4 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.12s]
[0m18:04:34.376755 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:04:34.376973 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:04:34.377252 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:04:34.377915 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:34.378054 [debug] [MainThread]: On master: BEGIN
[0m18:04:34.378176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:34.378458 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:34.378583 [debug] [MainThread]: On master: COMMIT
[0m18:04:34.378722 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:34.378952 [debug] [MainThread]: On master: COMMIT
[0m18:04:34.379234 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:34.379413 [debug] [MainThread]: On master: Close
[0m18:04:34.379606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:34.379728 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_customers' was properly closed.
[0m18:04:34.379837 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_order_items' was properly closed.
[0m18:04:34.379941 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_products' was properly closed.
[0m18:04:34.380047 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.stg_orders' was properly closed.
[0m18:04:34.380221 [info ] [MainThread]: 
[0m18:04:34.380386 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:04:34.380903 [debug] [MainThread]: Command end result
[0m18:04:34.397492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:04:34.403866 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:04:34.407781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:04:34.407979 [info ] [MainThread]: 
[0m18:04:34.408187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:34.408323 [info ] [MainThread]: 
[0m18:04:34.408479 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:04:34.409993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0327837, "process_in_blocks": "0", "process_kernel_time": 0.360248, "process_mem_max_rss": "147783680", "process_out_blocks": "0", "process_user_time": 1.365742}
[0m18:04:34.410228 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:34.410184 after 1.03 seconds
[0m18:04:34.410424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108041e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086edeb0>]}
[0m18:04:34.410607 [debug] [MainThread]: Flushing usage events
[0m18:04:34.943804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:52.982448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119264830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a50b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a50bc50>]}


============================== 18:04:52.985930 | 8cfbaf80-6bdd-46ab-a815-e105bd39114c ==============================
[0m18:04:52.985930 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:04:52.986268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:04:53.177719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7e8c30>]}
[0m18:04:53.207481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a58a360>]}
[0m18:04:53.210307 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:04:53.273090 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:04:53.411930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:53.412200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:53.452374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5d3450>]}
[0m18:04:53.524139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:04:53.525654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:04:53.553082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acda210>]}
[0m18:04:53.553422 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:04:53.553604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae109f0>]}
[0m18:04:53.555275 [info ] [MainThread]: 
[0m18:04:53.555475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:53.555605 [info ] [MainThread]: 
[0m18:04:53.555874 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:53.558994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:04:53.559355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:04:53.632093 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:04:53.632378 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:04:53.632557 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:04:53.632737 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:04:53.632893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:53.633040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:53.741832 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m18:04:53.742081 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:04:53.742244 [debug] [ThreadPool]: SQL status: OK in 0.109 seconds
[0m18:04:53.742420 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:04:53.742578 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:04:53.743078 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:04:53.762234 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m18:04:53.762469 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:04:53.763611 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:04:53.764409 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:04:53.765179 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:04:53.765330 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:04:53.765875 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:04:53.766019 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:04:53.767050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfbaf80-6bdd-46ab-a815-e105bd39114c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b04d980>]}
[0m18:04:53.767305 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:53.767433 [debug] [MainThread]: On master: BEGIN
[0m18:04:53.767547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:53.767819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:53.767941 [debug] [MainThread]: On master: COMMIT
[0m18:04:53.768060 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:53.768172 [debug] [MainThread]: On master: COMMIT
[0m18:04:53.768362 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:53.768502 [debug] [MainThread]: On master: Close
[0m18:04:53.773848 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:04:53.774059 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:04:53.774234 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:04:53.774396 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:04:53.774576 [info ] [Thread-1 (]: 1 of 27 START test assert_dim_customers_has_no_duplicates ...................... [RUN]
[0m18:04:53.774779 [info ] [Thread-4 (]: 4 of 27 START test not_null_dim_products_product_id ............................ [RUN]
[0m18:04:53.774965 [info ] [Thread-3 (]: 3 of 27 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m18:04:53.775173 [info ] [Thread-2 (]: 2 of 27 START test assert_fct_orders_matches_stg_orders ........................ [RUN]
[0m18:04:53.775398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:04:53.775622 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1'
[0m18:04:53.775825 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m18:04:53.775992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:04:53.776162 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:04:53.776318 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:04:53.776468 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:04:53.776612 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:04:53.780757 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:04:53.787055 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:04:53.789229 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:04:53.790768 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:04:53.792458 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:04:53.800100 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:04:53.800573 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:04:53.800786 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:04:53.801889 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:04:53.804779 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:04:53.805167 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:04:53.805370 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:04:53.805543 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders: BEGIN
[0m18:04:53.806462 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:04:53.806644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:53.806882 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:04:53.807194 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates: BEGIN
[0m18:04:53.807349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:53.807532 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.807722 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:04:53.807902 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test para verificar que todos los pedidos en staging están en fact_orders
with staging_orders as (
    select
        order_id
    from "analytics_dev"."main"."stg_orders"
),

fact_orders as (
    select
        order_id
    from "analytics_dev"."main"."fct_orders"
)

select
    so.order_id
from staging_orders so
left join fact_orders fo on so.order_id = fo.order_id
where fo.order_id is null
      
    ) dbt_internal_test
[0m18:04:53.808187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.808379 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:04:53.808554 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test para verificar que no hay clientes duplicados
with customer_data as (
    select
        customer_id,
        count(*) as customer_count
    from "analytics_dev"."main"."dim_customers"
    group by customer_id
    having count(*) > 1
)

select *
from customer_data
      
    ) dbt_internal_test
[0m18:04:53.808750 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:04:53.808927 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:04:53.809135 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m18:04:53.809294 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m18:04:53.809449 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:04:53.809598 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:04:53.809969 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:04:53.810222 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:04:53.810433 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.810626 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "analytics_dev"."main"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:04:53.810807 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:04:53.811015 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "analytics_dev"."main"."dim_products"
where product_id is null



      
    ) dbt_internal_test
[0m18:04:53.811869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.812031 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.814343 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m18:04:53.814606 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:04:53.815255 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m18:04:53.815420 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:04:53.815709 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m18:04:53.816010 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1'
[0m18:04:53.816617 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates: ROLLBACK
[0m18:04:53.816815 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m18:04:53.817475 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders: ROLLBACK
[0m18:04:53.817628 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1: Close
[0m18:04:53.817911 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates'
[0m18:04:53.818211 [info ] [Thread-3 (]: 3 of 27 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m18:04:53.818474 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders'
[0m18:04:53.818835 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates: Close
[0m18:04:53.818706 [info ] [Thread-4 (]: 4 of 27 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.04s]
[0m18:04:53.819119 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:04:53.819272 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders: Close
[0m18:04:53.819702 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:04:53.819504 [info ] [Thread-1 (]: 1 of 27 PASS assert_dim_customers_has_no_duplicates ............................ [[32mPASS[0m in 0.04s]
[0m18:04:53.819929 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:04:53.820181 [info ] [Thread-2 (]: 2 of 27 PASS assert_fct_orders_matches_stg_orders .............................. [[32mPASS[0m in 0.04s]
[0m18:04:53.820379 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:04:53.820619 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:04:53.820782 [info ] [Thread-3 (]: 5 of 27 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m18:04:53.821005 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:04:53.821154 [info ] [Thread-4 (]: 6 of 27 START test not_null_fct_orders_order_id ................................ [RUN]
[0m18:04:53.821332 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:04:53.821514 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:04:53.821690 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:04:53.821854 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:04:53.822140 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:04:53.822011 [info ] [Thread-1 (]: 7 of 27 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m18:04:53.822338 [info ] [Thread-2 (]: 8 of 27 START test not_null_stg_customers_email ................................ [RUN]
[0m18:04:53.822497 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:04:53.863698 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:04:53.863994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:04:53.864186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:04:53.865928 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:04:53.866172 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:04:53.866353 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:04:53.867977 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:04:53.869989 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:04:53.870372 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:04:53.871262 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:04:53.871499 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:04:53.872376 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:04:53.872711 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:04:53.872890 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:04:53.873053 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:04:53.873208 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m18:04:53.874235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:04:53.875136 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:04:53.875350 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:53.875613 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:04:53.875999 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m18:04:53.876155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:53.876469 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.876696 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.876881 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:04:53.877087 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:04:53.877279 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "analytics_dev"."main"."fct_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m18:04:53.877476 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "analytics_dev"."main"."fct_orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:04:53.878137 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:04:53.878411 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.879370 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m18:04:53.880262 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m18:04:53.880637 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b'
[0m18:04:53.880850 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m18:04:53.881098 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0'
[0m18:04:53.881288 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0: Close
[0m18:04:53.881596 [info ] [Thread-3 (]: 5 of 27 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.06s]
[0m18:04:53.882111 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:04:53.881826 [info ] [Thread-4 (]: 6 of 27 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:04:53.882360 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:04:53.882631 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:04:53.882964 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:04:53.882808 [info ] [Thread-3 (]: 9 of 27 START test not_null_stg_order_items_order_id ........................... [RUN]
[0m18:04:53.883194 [info ] [Thread-4 (]: 10 of 27 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m18:04:53.883428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:04:53.883633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:04:53.883854 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:04:53.884021 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:04:53.884181 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:04:53.884360 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:04:53.884510 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m18:04:53.886670 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:04:53.888269 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:04:53.888473 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533: BEGIN
[0m18:04:53.888709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:53.889088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:53.889564 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:04:53.890668 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:04:53.890886 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.891057 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.891219 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:04:53.891421 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:04:53.891589 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:04:53.892777 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:04:53.892971 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "analytics_dev"."main"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:04:53.893284 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "analytics_dev"."main"."stg_customers"
where email is null



      
    ) dbt_internal_test
[0m18:04:53.894082 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:04:53.894660 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m18:04:53.894836 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:53.895100 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:04:53.895291 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m18:04:53.895511 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.895732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:53.895968 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:04:53.896202 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.896480 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.896718 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "analytics_dev"."main"."stg_order_items"
where order_id is null



      
    ) dbt_internal_test
[0m18:04:53.896943 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.897935 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m18:04:53.898624 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m18:04:53.898887 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:04:53.899266 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m18:04:53.899494 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533'
[0m18:04:53.899664 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "analytics_dev"."main"."stg_order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m18:04:53.899840 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.899992 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m18:04:53.900158 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533: Close
[0m18:04:53.900936 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m18:04:53.901117 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.901419 [info ] [Thread-1 (]: 7 of 27 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m18:04:53.902028 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96'
[0m18:04:53.901665 [info ] [Thread-2 (]: 8 of 27 PASS not_null_stg_customers_email ...................................... [[32mPASS[0m in 0.04s]
[0m18:04:53.902923 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m18:04:53.903177 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:04:53.903357 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96: Close
[0m18:04:53.903592 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:04:53.903817 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:04:53.904107 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m18:04:53.904307 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:04:53.904576 [info ] [Thread-3 (]: 9 of 27 PASS not_null_stg_order_items_order_id ................................. [[32mPASS[0m in 0.02s]
[0m18:04:53.904911 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m18:04:53.904717 [info ] [Thread-1 (]: 11 of 27 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m18:04:53.905131 [info ] [Thread-2 (]: 12 of 27 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m18:04:53.905406 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:04:53.905639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:04:53.905900 [info ] [Thread-4 (]: 10 of 27 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.02s]
[0m18:04:53.906091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:04:53.906275 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:04:53.906449 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:04:53.906663 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:04:53.906806 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:04:53.906950 [info ] [Thread-3 (]: 13 of 27 START test not_null_stg_orders_order_id ............................... [RUN]
[0m18:04:53.909032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:04:53.909280 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:04:53.911162 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:04:53.911448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:04:53.911714 [info ] [Thread-4 (]: 14 of 27 START test not_null_stg_products_product_id ........................... [RUN]
[0m18:04:53.911979 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:04:53.912211 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:04:53.914637 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:04:53.915046 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:04:53.915323 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:04:53.915503 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:04:53.917421 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:04:53.918491 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:04:53.919814 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:04:53.920129 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:04:53.921255 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:04:53.926392 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:04:53.927918 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:04:53.928345 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:04:53.928537 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m18:04:53.928760 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:04:53.929005 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:04:53.929192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:53.929373 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m18:04:53.929544 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:04:53.929708 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m18:04:53.929997 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:53.930220 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m18:04:53.930421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.930606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:53.930899 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:53.931134 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:04:53.931347 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.931677 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "analytics_dev"."main"."stg_order_items"
where product_id is null



      
    ) dbt_internal_test
[0m18:04:53.931868 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.932024 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:04:53.932185 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.932420 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:04:53.932618 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "analytics_dev"."main"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m18:04:53.932820 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:04:53.932990 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "analytics_dev"."main"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:04:53.933157 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.933355 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "analytics_dev"."main"."stg_products"
where product_id is null



      
    ) dbt_internal_test
[0m18:04:53.934321 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m18:04:53.934540 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.934892 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6'
[0m18:04:53.935076 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.935875 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m18:04:53.936094 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m18:04:53.936292 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:53.937157 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m18:04:53.937457 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3'
[0m18:04:53.937808 [info ] [Thread-1 (]: 11 of 27 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.03s]
[0m18:04:53.938571 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m18:04:53.938962 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5'
[0m18:04:53.939149 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3: Close
[0m18:04:53.939471 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:04:53.939846 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64'
[0m18:04:53.940119 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m18:04:53.940700 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:04:53.940479 [info ] [Thread-4 (]: 14 of 27 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m18:04:53.941024 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m18:04:53.941255 [info ] [Thread-1 (]: 15 of 27 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m18:04:53.941784 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:04:53.941517 [info ] [Thread-2 (]: 12 of 27 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m18:04:53.942070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:04:53.942484 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:04:53.942324 [info ] [Thread-3 (]: 13 of 27 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:04:53.942796 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:04:53.942972 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:04:53.943156 [info ] [Thread-4 (]: 16 of 27 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m18:04:53.943412 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:04:53.943607 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:04:53.948366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:04:53.948652 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:04:53.948953 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:04:53.949246 [info ] [Thread-2 (]: 17 of 27 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m18:04:53.949583 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:04:53.949817 [info ] [Thread-3 (]: 18 of 27 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m18:04:53.950142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:04:53.952837 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:04:53.953164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:04:53.953415 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:04:53.953605 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:04:53.953867 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:04:53.955457 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:04:53.958549 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:04:53.961483 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:04:53.961992 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:04:53.963012 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:04:53.963363 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:04:53.963547 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:04:53.963854 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:04:53.964955 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:04:53.966420 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:04:53.966680 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m18:04:53.966943 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:04:53.967222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:53.967456 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m18:04:53.967817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:53.968021 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:04:53.968393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.968604 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:04:53.968815 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m18:04:53.969014 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.969177 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:04:53.969350 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m18:04:53.969542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:53.969750 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:04:53.969948 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "analytics_dev"."main"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "analytics_dev"."main"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:04:53.970140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:53.970415 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from "analytics_dev"."main"."stg_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "analytics_dev"."main"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:04:53.970651 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.971023 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:04:53.971194 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:53.971384 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "analytics_dev"."main"."stg_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "analytics_dev"."main"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:04:53.971652 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:04:53.972169 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "analytics_dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "analytics_dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:04:53.972420 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.972790 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.973687 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m18:04:53.973953 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.974192 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:53.975015 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m18:04:53.975410 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m18:04:53.976140 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m18:04:53.976464 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m18:04:53.976661 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m18:04:53.977385 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m18:04:53.977602 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m18:04:53.977866 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m18:04:53.978224 [info ] [Thread-1 (]: 15 of 27 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.04s]
[0m18:04:53.978514 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m18:04:53.978791 [info ] [Thread-4 (]: 16 of 27 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.03s]
[0m18:04:53.979019 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m18:04:53.979342 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:04:53.979541 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m18:04:53.979809 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:04:53.980048 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:04:53.980303 [info ] [Thread-2 (]: 17 of 27 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.03s]
[0m18:04:53.980829 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:04:53.980664 [info ] [Thread-3 (]: 18 of 27 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.03s]
[0m18:04:53.981413 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:04:53.981093 [info ] [Thread-1 (]: 19 of 27 START test unique_dim_customers_customer_id ........................... [RUN]
[0m18:04:53.981931 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:04:53.981682 [info ] [Thread-4 (]: 20 of 27 START test unique_dim_products_product_id ............................. [RUN]
[0m18:04:53.982179 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:04:53.982390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:04:53.982578 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:04:53.982758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:04:53.982924 [info ] [Thread-2 (]: 21 of 27 START test unique_fct_orders_order_id ................................. [RUN]
[0m18:04:53.983099 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:04:53.983261 [info ] [Thread-3 (]: 22 of 27 START test unique_stg_customers_customer_id ........................... [RUN]
[0m18:04:53.983439 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:04:53.983639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:04:53.987080 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:04:53.987368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:04:53.989329 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:04:53.989608 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:04:53.989915 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:04:53.992448 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:04:53.994148 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:04:53.994564 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:04:53.994797 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:04:53.995860 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:04:54.000195 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:04:54.000545 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:04:54.000798 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:04:54.001769 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:04:54.002896 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:04:54.003304 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:04:54.003520 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m18:04:54.003672 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:54.004031 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:04:54.004263 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m18:04:54.004433 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:54.004609 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.004943 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:04:54.005151 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:04:54.005341 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.005548 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.005742 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m18:04:54.005939 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:04:54.006186 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:04:54.006370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:54.006556 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m18:04:54.006742 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.007029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:54.007259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.007466 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:04:54.007677 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:54.007867 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.008049 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.008340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.009192 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m18:04:54.009373 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:04:54.009541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.009796 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.010567 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m18:04:54.010873 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985'
[0m18:04:54.011600 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m18:04:54.011888 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985: Close
[0m18:04:54.012206 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada'
[0m18:04:54.012553 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd'
[0m18:04:54.012755 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.012946 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada: Close
[0m18:04:54.013418 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m18:04:54.013255 [info ] [Thread-4 (]: 20 of 27 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m18:04:54.014305 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m18:04:54.014586 [info ] [Thread-3 (]: 22 of 27 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m18:04:54.015126 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:04:54.014896 [info ] [Thread-1 (]: 19 of 27 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m18:04:54.015476 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5'
[0m18:04:54.015696 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:04:54.016996 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:04:54.015886 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:04:54.016580 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5: Close
[0m18:04:54.017204 [info ] [Thread-3 (]: 24 of 27 START test unique_stg_orders_order_id ................................. [RUN]
[0m18:04:54.018510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:04:54.016140 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:04:54.019038 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:04:54.018114 [info ] [Thread-2 (]: 21 of 27 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m18:04:54.017532 [info ] [Thread-4 (]: 23 of 27 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m18:04:54.020337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:04:54.019212 [info ] [Thread-1 (]: 25 of 27 START test unique_stg_products_product_id ............................. [RUN]
[0m18:04:54.019602 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:04:54.021357 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:04:54.020516 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:04:54.020869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:04:54.021533 [info ] [Thread-2 (]: 26 of 27 START test validate_order_dates ....................................... [RUN]
[0m18:04:54.025464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:04:54.018687 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:04:54.025244 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:04:54.025634 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:04:54.027779 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:04:54.030582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:04:54.024451 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:04:54.032719 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:04:54.033715 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:04:54.035231 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:04:54.035791 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:04:54.036910 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:04:54.037420 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:04:54.038565 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:04:54.039158 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:04:54.039670 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:04:54.040182 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:04:54.041471 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:04:54.041734 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467: BEGIN
[0m18:04:54.041938 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m18:04:54.042310 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:04:54.042736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:54.043246 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:04:54.043581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:54.043998 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m18:04:54.044360 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.validate_order_dates: BEGIN
[0m18:04:54.044697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:54.045036 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:54.045341 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:54.045518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:54.045807 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:04:54.046237 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.046680 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:04:54.047403 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.047787 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:04:54.048138 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:54.048506 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.049286 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "analytics_dev"."main"."stg_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:04:54.050008 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:04:54.050303 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:54.050992 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.validate_order_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.validate_order_dates"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Validar que las fechas de pedidos son lógicas
-- Esta prueba verifica que todas las fechas de pedido son:
-- 1. No están en el futuro
-- 2. No son anteriores a 2015 (asumiendo que es una fecha razonable para el negocio)

WITH validation AS (
    SELECT
        order_id,
        order_date,
        CURRENT_DATE() AS today
    FROM "analytics_dev"."main"."fct_orders"
    WHERE order_date > CURRENT_DATE() OR order_date < '2015-01-01'
)

SELECT * FROM validation
      
    ) dbt_internal_test
[0m18:04:54.051633 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.052306 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:54.053341 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m18:04:54.053742 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467'
[0m18:04:54.053941 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467: Close
[0m18:04:54.054453 [info ] [Thread-1 (]: 25 of 27 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m18:04:54.054834 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:04:54.055044 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:04:54.055756 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m18:04:54.056090 [info ] [Thread-1 (]: 27 of 27 START test validate_price_positive .................................... [RUN]
[0m18:04:54.056989 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m18:04:54.057338 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:04:54.057761 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a'
[0m18:04:54.059718 [debug] [Thread-3 (]: On test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a: Close
[0m18:04:54.058009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:04:54.060404 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:04:54.060021 [info ] [Thread-3 (]: 24 of 27 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m18:04:54.061944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:04:54.062520 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:04:54.059368 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.validate_order_dates: ROLLBACK
[0m18:04:54.058441 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108'
[0m18:04:54.063680 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.validate_order_dates'
[0m18:04:54.064289 [debug] [Thread-4 (]: On test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108: Close
[0m18:04:54.064738 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:04:54.064972 [debug] [Thread-2 (]: On test.dbt_duckdb_analytics_poc.validate_order_dates: Close
[0m18:04:54.065298 [info ] [Thread-4 (]: 23 of 27 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.04s]
[0m18:04:54.067301 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:04:54.067785 [info ] [Thread-2 (]: 26 of 27 PASS validate_order_dates ............................................. [[32mPASS[0m in 0.04s]
[0m18:04:54.068386 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:04:54.069367 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:04:54.069911 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:04:54.070539 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.validate_price_positive: BEGIN
[0m18:04:54.070704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:54.071061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:54.071215 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:04:54.071375 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.validate_price_positive: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "test.dbt_duckdb_analytics_poc.validate_price_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Validar que todos los precios son positivos
-- Esta prueba verifica que no hay productos con precios negativos o cero

WITH validation AS (
    SELECT
        product_id,
        product_name,
        price
    FROM "analytics_dev"."main"."dim_products"
    WHERE price <= 0
)

SELECT * FROM validation
      
    ) dbt_internal_test
[0m18:04:54.072666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:54.073554 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.validate_price_positive: ROLLBACK
[0m18:04:54.073903 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_duckdb_analytics_poc.validate_price_positive'
[0m18:04:54.074071 [debug] [Thread-1 (]: On test.dbt_duckdb_analytics_poc.validate_price_positive: Close
[0m18:04:54.074367 [info ] [Thread-1 (]: 27 of 27 PASS validate_price_positive .......................................... [[32mPASS[0m in 0.02s]
[0m18:04:54.074624 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:04:54.077380 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:54.077543 [debug] [MainThread]: On master: BEGIN
[0m18:04:54.077668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:54.077972 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:54.078111 [debug] [MainThread]: On master: COMMIT
[0m18:04:54.078233 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:54.078351 [debug] [MainThread]: On master: COMMIT
[0m18:04:54.078533 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:54.078658 [debug] [MainThread]: On master: Close
[0m18:04:54.078821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:54.078940 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_price_positive' was properly closed.
[0m18:04:54.079050 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m18:04:54.079157 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108' was properly closed.
[0m18:04:54.079263 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m18:04:54.079417 [info ] [MainThread]: 
[0m18:04:54.079569 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m18:04:54.081634 [debug] [MainThread]: Command end result
[0m18:04:54.108118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:04:54.109740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:04:54.114250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:04:54.114480 [info ] [MainThread]: 
[0m18:04:54.114671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:54.114832 [info ] [MainThread]: 
[0m18:04:54.114988 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m18:04:54.116928 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1820354, "process_in_blocks": "0", "process_kernel_time": 0.412863, "process_mem_max_rss": "152174592", "process_out_blocks": "0", "process_user_time": 1.537272}
[0m18:04:54.117241 [debug] [MainThread]: Command `dbt test` succeeded at 18:04:54.117176 after 1.18 seconds
[0m18:04:54.117475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac33800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adeda70>]}
[0m18:04:54.117671 [debug] [MainThread]: Flushing usage events
[0m18:04:54.705016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:05.513938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b28830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881fc50>]}


============================== 18:05:05.518491 | c391a60a-feda-446d-b5c9-672a941a7736 ==============================
[0m18:05:05.518491 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:05:05.518834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:05.692269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fcd60>]}
[0m18:05:05.718754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889e360>]}
[0m18:05:05.721755 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:05:05.778951 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:05:05.907504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:05.907739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:05.944167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e7450>]}
[0m18:05:05.963188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca55e0>]}
[0m18:05:05.963431 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:05:05.963613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d57230>]}
[0m18:05:05.965134 [info ] [MainThread]: 
[0m18:05:05.965328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:05.965462 [info ] [MainThread]: 
[0m18:05:05.965694 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:05.968253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:05:05.969939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:05:06.033455 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:05:06.033718 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:05:06.033900 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:05:06.034061 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:05:06.034206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:06.034346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:06.167249 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m18:05:06.167540 [debug] [ThreadPool]: SQL status: OK in 0.133 seconds
[0m18:05:06.167716 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:05:06.167899 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:05:06.168105 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:05:06.168289 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:05:06.188585 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m18:05:06.188838 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m18:05:06.189696 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:05:06.190519 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:05:06.191652 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:05:06.191806 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:05:06.192044 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:05:06.192203 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:05:06.193314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c391a60a-feda-446d-b5c9-672a941a7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109206a90>]}
[0m18:05:06.195563 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:05:06.195764 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:05:06.195924 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:05:06.196070 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:05:06.196284 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m18:05:06.196490 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m18:05:06.196666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m18:05:06.196837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m18:05:06.196994 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:05:06.197140 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:05:06.197287 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:05:06.197430 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:05:06.200566 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:05:06.201644 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:05:06.202360 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:05:06.203080 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:05:06.203408 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:05:06.203685 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:05:06.203969 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:05:06.204232 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:05:06.204549 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:05:06.204827 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:05:06.205008 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:05:06.205163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m18:05:06.205317 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:05:06.205484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_products)
[0m18:05:06.205653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:05:06.205813 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:05:06.205970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:05:06.206112 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:05:06.206255 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:05:06.207854 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:05:06.208025 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:05:06.209166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:05:06.210229 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:05:06.211660 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:05:06.211992 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:05:06.212266 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:05:06.212604 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:05:06.212792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:05:06.212948 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:05:06.218218 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:05:06.218474 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:05:06.218824 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:05:06.219007 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:05:06.219172 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:05:06.219382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:05:06.219771 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:05:06.219952 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:05:06.220104 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:05:06.220280 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:05:06.220425 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:05:06.222069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:05:06.222414 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:05:06.222612 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:05:06.222895 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:05:06.223096 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:05:06.223285 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:05:06.223790 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:05:06.223977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m18:05:06.226640 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:05:06.226836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:05:06.227029 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:05:06.227228 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:05:06.227389 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:05:06.228709 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:05:06.230584 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:05:06.230923 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:05:06.231201 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:05:06.231345 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:05:06.231540 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:05:06.231730 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:05:06.232009 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:05:06.232169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:05:06.232342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:05:06.232514 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:05:06.232672 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:05:06.232820 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:05:06.232972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m18:05:06.234524 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:05:06.235728 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:05:06.235923 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:05:06.236143 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:05:06.237757 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:05:06.238065 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:05:06.238383 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:05:06.238571 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:05:06.238714 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:05:06.238856 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:05:06.239010 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:05:06.239176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:05:06.239445 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:05:06.239694 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:05:06.239855 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:05:06.240011 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:05:06.240172 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:05:06.240337 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:05:06.240494 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:05:06.242081 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:05:06.242261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:05:06.242435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:05:06.243943 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:05:06.244139 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:05:06.244303 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:05:06.248086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:05:06.249608 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:05:06.249890 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:05:06.250180 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:05:06.250349 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:05:06.250532 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:05:06.250708 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:05:06.251025 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:05:06.251177 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:05:06.251350 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:05:06.251520 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:05:06.251672 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:05:06.251938 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:05:06.253371 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:05:06.253548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:05:06.253847 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:05:06.254020 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:05:06.254216 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:05:06.254390 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:05:06.254566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:05:06.256211 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:05:06.256410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:05:06.256576 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:05:06.256728 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:05:06.256912 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:05:06.257175 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:05:06.258847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:05:06.260765 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:05:06.260980 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:05:06.261251 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:05:06.261453 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:05:06.261765 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:05:06.261976 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:05:06.262136 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:05:06.262281 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:05:06.262441 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:05:06.264088 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:05:06.264460 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:05:06.264749 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:05:06.264916 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:05:06.265124 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:05:06.265302 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:05:06.265465 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:05:06.265626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:05:06.265798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:05:06.268098 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:05:06.268301 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:05:06.268452 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:05:06.268591 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:05:06.272529 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:05:06.272879 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:05:06.274434 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:05:06.274697 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:05:06.274924 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:05:06.275105 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:05:06.275436 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:05:06.275598 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:05:06.275757 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:05:06.275903 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:05:06.276051 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:05:06.277278 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:05:06.277627 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:05:06.277898 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:05:06.278062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:05:06.278266 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:05:06.278456 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:05:06.278621 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:05:06.278797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:05:06.278968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m18:05:06.319944 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:05:06.320233 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:05:06.320417 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:05:06.320574 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:05:06.322285 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:05:06.324090 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:05:06.324444 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:05:06.324696 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:05:06.324884 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:05:06.325199 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:05:06.325391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:05:06.325604 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:05:06.325781 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:05:06.325933 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:05:06.326096 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:05:06.326249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:05:06.327867 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:05:06.328172 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:05:06.328446 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:05:06.328603 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:05:06.328796 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:05:06.328974 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:05:06.330133 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:05:06.330320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m18:05:06.330511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m18:05:06.330706 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:05:06.330864 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:05:06.331021 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:05:06.332868 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m18:05:06.333190 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:05:06.334615 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m18:05:06.334843 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:05:06.335016 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:05:06.335362 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:05:06.335541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m18:05:06.335755 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:05:06.335928 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:05:06.336091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:05:06.337608 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m18:05:06.337805 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:05:06.337955 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:05:06.338105 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:05:06.338407 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:05:06.340499 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:05:06.340798 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:05:06.340988 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:05:06.341177 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:05:06.341358 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:05:06.341540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:05:06.341818 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:05:06.341991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:05:06.342149 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:05:06.342294 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:05:06.342447 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:05:06.342605 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:05:06.343780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:05:06.344060 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:05:06.344228 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:05:06.345847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:05:06.346066 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:05:06.346243 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:05:06.346426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:05:06.348279 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:05:06.348500 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:05:06.348650 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:05:06.348792 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:05:06.350790 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:05:06.351112 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:05:06.351406 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:05:06.351643 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:05:06.351818 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:05:06.352006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:05:06.352182 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:05:06.352340 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:05:06.352503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:05:06.352656 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:05:06.352911 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:05:06.353181 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:05:06.353324 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:05:06.355097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:05:06.356227 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:05:06.357031 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:05:06.357294 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:05:06.357508 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:05:06.357790 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:05:06.358434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:06.358575 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m18:05:06.358693 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m18:05:06.358802 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m18:05:06.358908 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m18:05:06.361343 [debug] [MainThread]: Command end result
[0m18:05:06.424776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:05:06.427662 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:05:06.432165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:05:06.434223 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:05:06.434387 [info ] [MainThread]: Building catalog
[0m18:05:06.439673 [debug] [ThreadPool]: Acquiring new duckdb connection 'analytics_dev.information_schema'
[0m18:05:06.443425 [debug] [ThreadPool]: Using duckdb connection "analytics_dev.information_schema"
[0m18:05:06.443664 [debug] [ThreadPool]: On analytics_dev.information_schema: BEGIN
[0m18:05:06.443804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:06.444145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:06.444272 [debug] [ThreadPool]: Using duckdb connection "analytics_dev.information_schema"
[0m18:05:06.444418 [debug] [ThreadPool]: On analytics_dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "analytics_dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'analytics_dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'analytics_dev'
    )
    select
        'analytics_dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('snapshots') or upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:05:06.451841 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:05:06.465742 [debug] [ThreadPool]: On analytics_dev.information_schema: ROLLBACK
[0m18:05:06.466198 [debug] [ThreadPool]: Failed to rollback 'analytics_dev.information_schema'
[0m18:05:06.466346 [debug] [ThreadPool]: On analytics_dev.information_schema: Close
[0m18:05:06.484449 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/catalog.json
[0m18:05:06.500421 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:05:06.502144 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:05:06.502369 [info ] [MainThread]: Catalog written to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/catalog.json
[0m18:05:06.504249 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0422053, "process_in_blocks": "0", "process_kernel_time": 0.34908, "process_mem_max_rss": "153272320", "process_out_blocks": "0", "process_user_time": 1.400528}
[0m18:05:06.504505 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:05:06.504457 after 1.04 seconds
[0m18:05:06.504674 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:05:06.504794 [debug] [MainThread]: Connection 'analytics_dev.information_schema' was properly closed.
[0m18:05:06.504954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ce990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109730d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109730e10>]}
[0m18:05:06.505149 [debug] [MainThread]: Flushing usage events
[0m18:05:07.042209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:04.431763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e07c50>]}


============================== 18:07:04.435685 | b1a71f45-39eb-4818-b3a3-aec0aeba0c24 ==============================
[0m18:07:04.435685 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:07:04.436056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:07:04.612458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1a71f45-39eb-4818-b3a3-aec0aeba0c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e8d60>]}
[0m18:07:04.638840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1a71f45-39eb-4818-b3a3-aec0aeba0c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8a470>]}
[0m18:11:32.755389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b907c50>]}


============================== 18:11:32.758604 | 42bf98d4-c27f-43df-ae16-c84188cf0f06 ==============================
[0m18:11:32.758604 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:11:32.758930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:32.927459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42bf98d4-c27f-43df-ae16-c84188cf0f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baecc30>]}
[0m18:11:32.954521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42bf98d4-c27f-43df-ae16-c84188cf0f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b98a360>]}
[0m18:11:32.958775 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:11:33.016854 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:11:33.146978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:33.147239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:33.183923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42bf98d4-c27f-43df-ae16-c84188cf0f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d3450>]}
[0m18:11:33.247129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:11:33.249636 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:11:33.268701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42bf98d4-c27f-43df-ae16-c84188cf0f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae76b0>]}
[0m18:11:33.269024 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:11:33.269202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bf98d4-c27f-43df-ae16-c84188cf0f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8eb30>]}
[0m18:11:33.269516 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:11:33.269695 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:11:33.269839 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:11:33.269974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:33.400477 [debug] [MainThread]: SQL status: OK in 0.130 seconds
[0m18:11:33.400771 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:11:33.401001 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:11:33.401249 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:11:33.401548 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:11:33.404379 [debug] [MainThread]: On macro_run_query: Close
[0m18:11:33.404629 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m18:11:33.409454 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m18:11:33.413950 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:11:33.415592 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.71250874, "process_in_blocks": "0", "process_kernel_time": 0.31004, "process_mem_max_rss": "137117696", "process_out_blocks": "0", "process_user_time": 1.158286}
[0m18:11:33.415866 [debug] [MainThread]: Command `dbt run-operation` failed at 18:11:33.415806 after 0.71 seconds
[0m18:11:33.416124 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:11:33.416348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee7650>]}
[0m18:11:33.416529 [debug] [MainThread]: Flushing usage events
[0m18:11:34.081155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:48.361335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104564830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106207c50>]}


============================== 18:12:48.365764 | 95b3a143-b712-4eff-b4dd-fe6162b78b2e ==============================
[0m18:12:48.365764 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:12:48.366238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:48.551682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b3a143-b712-4eff-b4dd-fe6162b78b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ecc30>]}
[0m18:12:48.581281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b3a143-b712-4eff-b4dd-fe6162b78b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628a360>]}
[0m18:12:48.585544 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:12:48.645729 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:12:48.796618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:48.797028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:48.836663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b3a143-b712-4eff-b4dd-fe6162b78b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3450>]}
[0m18:12:48.905478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:12:48.908477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:12:48.925521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b3a143-b712-4eff-b4dd-fe6162b78b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e76b0>]}
[0m18:12:48.925834 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 432 macros
[0m18:12:48.926010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b3a143-b712-4eff-b4dd-fe6162b78b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106492b30>]}
[0m18:12:48.926330 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:12:48.926510 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:12:48.926645 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:12:48.926772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:48.995235 [debug] [MainThread]: SQL status: OK in 0.068 seconds
[0m18:12:48.995511 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:12:48.995661 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:12:48.995792 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:12:48.996025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:12:48.998998 [debug] [MainThread]: On macro_run_query: Close
[0m18:12:48.999332 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m18:12:49.003461 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m18:12:49.007849 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:12:49.009723 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.74089986, "process_in_blocks": "0", "process_kernel_time": 0.33918, "process_mem_max_rss": "134512640", "process_out_blocks": "0", "process_user_time": 1.235348}
[0m18:12:49.009969 [debug] [MainThread]: Command `dbt run-operation` failed at 18:12:49.009910 after 0.74 seconds
[0m18:12:49.010141 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:12:49.010315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e7650>]}
[0m18:12:49.010500 [debug] [MainThread]: Flushing usage events
[0m18:12:49.506757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:57.961481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106707c50>]}


============================== 18:13:57.965558 | 17b83ae9-2703-4472-9298-c2d7fd383c8d ==============================
[0m18:13:57.965558 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:13:57.965923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:58.161437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b83ae9-2703-4472-9298-c2d7fd383c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ecc30>]}
[0m18:13:58.193105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b83ae9-2703-4472-9298-c2d7fd383c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a360>]}
[0m18:13:58.196638 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:13:58.260241 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:13:58.393980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:13:58.394425 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://macros/run_query.sql
[0m18:13:58.453198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b83ae9-2703-4472-9298-c2d7fd383c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5e550>]}
[0m18:13:58.513457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:13:58.515888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:13:58.531820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b83ae9-2703-4472-9298-c2d7fd383c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e76b0>]}
[0m18:13:58.532081 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:13:58.532245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b83ae9-2703-4472-9298-c2d7fd383c8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874ad0>]}
[0m18:13:58.532539 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:13:58.532706 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:13:58.532828 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:13:58.532945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:58.584805 [debug] [MainThread]: SQL status: OK in 0.052 seconds
[0m18:13:58.585099 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:13:58.585255 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:13:58.585389 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:13:58.585633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:13:58.589936 [debug] [MainThread]: DuckDB adapter: duckdb error: maximum recursion depth exceeded
[0m18:13:58.590174 [debug] [MainThread]: On macro_run_query: Close
[0m18:13:58.590403 [error] [MainThread]: Encountered an error while running operation: cannot access local variable 'result' where it is not associated with a value
[0m18:13:58.591643 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1277, in execute_macro
    return result
           ^^^^^^
UnboundLocalError: cannot access local variable 'result' where it is not associated with a value

[0m18:13:58.595620 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:13:58.597899 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.6962669, "process_in_blocks": "0", "process_kernel_time": 0.321595, "process_mem_max_rss": "141705216", "process_out_blocks": "0", "process_user_time": 1.198892}
[0m18:13:58.598205 [debug] [MainThread]: Command `dbt run-operation` failed at 18:13:58.598152 after 0.70 seconds
[0m18:13:58.598380 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:13:58.598541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f64d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733c110>]}
[0m18:13:58.598716 [debug] [MainThread]: Flushing usage events
[0m18:13:59.210721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:23.057024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12150b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12150bc50>]}


============================== 18:14:23.060525 | 0be4aea3-52ac-4fa4-aeed-b494aac180b9 ==============================
[0m18:14:23.060525 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:14:23.060847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select customer_orders_analysis', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:23.209650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0be4aea3-52ac-4fa4-aeed-b494aac180b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216e8c30>]}
[0m18:14:23.255405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0be4aea3-52ac-4fa4-aeed-b494aac180b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12158a360>]}
[0m18:14:23.266836 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:14:23.331845 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:14:23.454352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:23.454599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:23.491327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0be4aea3-52ac-4fa4-aeed-b494aac180b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215d3450>]}
[0m18:14:23.551587 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:14:23.553711 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:14:23.572351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0be4aea3-52ac-4fa4-aeed-b494aac180b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216e3b60>]}
[0m18:14:23.572637 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:14:23.572804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be4aea3-52ac-4fa4-aeed-b494aac180b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224425f0>]}
[0m18:14:23.573713 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:14:23.574621 [debug] [MainThread]: Command end result
[0m18:14:23.589790 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:14:23.591309 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:14:23.594570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:14:23.598281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5966502, "process_in_blocks": "0", "process_kernel_time": 0.225108, "process_mem_max_rss": "121962496", "process_out_blocks": "0", "process_user_time": 1.028814}
[0m18:14:23.598549 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:23.598493 after 0.60 seconds
[0m18:14:23.598775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12268bba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226a41d0>]}
[0m18:14:23.598960 [debug] [MainThread]: Flushing usage events
[0m18:14:24.150950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:45.651611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107207c50>]}


============================== 18:14:45.654966 | 52d2bb14-7269-4a04-9a78-170eae437f17 ==============================
[0m18:14:45.654966 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:14:45.655320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:45.836528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d2bb14-7269-4a04-9a78-170eae437f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ecc30>]}
[0m18:14:45.863889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d2bb14-7269-4a04-9a78-170eae437f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728a360>]}
[0m18:14:45.867514 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:14:45.937160 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:14:46.063138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:46.063398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:46.100361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d2bb14-7269-4a04-9a78-170eae437f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d3450>]}
[0m18:14:46.160399 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:14:46.162571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:14:46.179319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d2bb14-7269-4a04-9a78-170eae437f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e76b0>]}
[0m18:14:46.179576 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:14:46.179759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d2bb14-7269-4a04-9a78-170eae437f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737eb30>]}
[0m18:14:46.180059 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:14:46.180230 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:14:46.180358 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:14:46.180478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:46.304101 [debug] [MainThread]: SQL status: OK in 0.123 seconds
[0m18:14:46.304840 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:14:46.305132 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:14:46.305301 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:14:46.305661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:14:46.359736 [debug] [MainThread]: DuckDB adapter: duckdb error: maximum recursion depth exceeded
[0m18:14:46.360997 [debug] [MainThread]: On macro_run_query: Close
[0m18:14:46.361383 [error] [MainThread]: Encountered an error while running operation: cannot access local variable 'result' where it is not associated with a value
[0m18:14:46.363292 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1277, in execute_macro
    return result
           ^^^^^^
UnboundLocalError: cannot access local variable 'result' where it is not associated with a value

[0m18:14:46.367135 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:14:46.368938 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.76700765, "process_in_blocks": "0", "process_kernel_time": 0.322985, "process_mem_max_rss": "136642560", "process_out_blocks": "0", "process_user_time": 1.1758}
[0m18:14:46.369210 [debug] [MainThread]: Command `dbt run-operation` failed at 18:14:46.369153 after 0.77 seconds
[0m18:14:46.369388 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:14:46.369560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e77d0>]}
[0m18:14:46.369735 [debug] [MainThread]: Flushing usage events
[0m18:14:46.915075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:52.506415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107307c50>]}


============================== 18:16:52.510602 | 398785fe-f79b-4aeb-a175-36ec328032b7 ==============================
[0m18:16:52.510602 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:16:52.510955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:52.681632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '398785fe-f79b-4aeb-a175-36ec328032b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e8c30>]}
[0m18:16:52.708084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '398785fe-f79b-4aeb-a175-36ec328032b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738a360>]}
[0m18:16:52.711528 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:16:52.769212 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:16:52.904147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:52.904539 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://macros/run_query.sql
[0m18:16:52.963901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '398785fe-f79b-4aeb-a175-36ec328032b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785e550>]}
[0m18:16:53.023101 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:16:53.024972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:16:53.041786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '398785fe-f79b-4aeb-a175-36ec328032b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e76b0>]}
[0m18:16:53.042060 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:16:53.042219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '398785fe-f79b-4aeb-a175-36ec328032b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758cc90>]}
[0m18:16:53.042512 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:16:53.042672 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:16:53.042796 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:16:53.042908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:53.093333 [debug] [MainThread]: SQL status: OK in 0.050 seconds
[0m18:16:53.093624 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:16:53.093774 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:16:53.093908 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:16:53.094110 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:16:53.097271 [debug] [MainThread]: On macro_run_query: Close
[0m18:16:53.097594 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m18:16:53.101136 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m18:16:53.105718 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:16:53.108004 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.6533895, "process_in_blocks": "0", "process_kernel_time": 0.307585, "process_mem_max_rss": "138133504", "process_out_blocks": "0", "process_user_time": 1.176314}
[0m18:16:53.108284 [debug] [MainThread]: Command `dbt run-operation` failed at 18:16:53.108224 after 0.65 seconds
[0m18:16:53.108466 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:16:53.108632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a68940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af4050>]}
[0m18:16:53.108806 [debug] [MainThread]: Flushing usage events
[0m18:16:53.696099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:25.113285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11970c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d607c50>]}


============================== 18:17:25.116732 | e850c4ef-3269-4cdd-8ceb-4ba32b828a77 ==============================
[0m18:17:25.116732 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:17:25.117083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:25.323314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e850c4ef-3269-4cdd-8ceb-4ba32b828a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7ecc30>]}
[0m18:17:25.350671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e850c4ef-3269-4cdd-8ceb-4ba32b828a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d68a360>]}
[0m18:17:25.354126 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:17:25.416307 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:17:25.525155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:25.525417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:25.562782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e850c4ef-3269-4cdd-8ceb-4ba32b828a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6cf450>]}
[0m18:17:25.624613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:17:25.626932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:17:25.645483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e850c4ef-3269-4cdd-8ceb-4ba32b828a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7e76b0>]}
[0m18:17:25.645823 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:17:25.646010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e850c4ef-3269-4cdd-8ceb-4ba32b828a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d792b30>]}
[0m18:17:25.646330 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:17:25.646506 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:17:25.646632 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:17:25.646756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:25.720101 [debug] [MainThread]: SQL status: OK in 0.073 seconds
[0m18:17:25.720480 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:17:25.720732 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:17:25.720942 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:17:25.721181 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:25.724291 [debug] [MainThread]: On macro_run_query: Close
[0m18:17:25.724629 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m18:17:25.729456 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m18:17:25.741588 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:17:25.744105 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.6794571, "process_in_blocks": "0", "process_kernel_time": 0.298765, "process_mem_max_rss": "137805824", "process_out_blocks": "0", "process_user_time": 1.14523}
[0m18:17:25.744632 [debug] [MainThread]: Command `dbt run-operation` failed at 18:17:25.744473 after 0.68 seconds
[0m18:17:25.745045 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:17:25.745274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e3ee1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d3ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e3e7710>]}
[0m18:17:25.745512 [debug] [MainThread]: Flushing usage events
[0m18:17:26.241407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:44.748662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110014830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111207c50>]}


============================== 18:17:44.752450 | 51e89ad6-540e-4d6c-9a16-66a13e98f1e7 ==============================
[0m18:17:44.752450 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:17:44.752948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation execute_query --args {"query": "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'send_anonymous_usage_stats': 'True'}
[0m18:17:44.908961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e89ad6-540e-4d6c-9a16-66a13e98f1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e8c30>]}
[0m18:17:44.937975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e89ad6-540e-4d6c-9a16-66a13e98f1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11128a360>]}
[0m18:17:44.942073 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:17:45.000839 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:17:45.140198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:45.140489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:45.180778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e89ad6-540e-4d6c-9a16-66a13e98f1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d3450>]}
[0m18:17:45.263928 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:17:45.266761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:17:45.284689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e89ad6-540e-4d6c-9a16-66a13e98f1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e76b0>]}
[0m18:17:45.285014 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:17:45.285190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e89ad6-540e-4d6c-9a16-66a13e98f1e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111492b30>]}
[0m18:17:45.285532 [debug] [MainThread]: Acquiring new duckdb connection 'macro_execute_query'
[0m18:17:45.285716 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:17:45.285853 [debug] [MainThread]: On macro_execute_query: BEGIN
[0m18:17:45.285979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:45.365024 [debug] [MainThread]: SQL status: OK in 0.079 seconds
[0m18:17:45.365297 [debug] [MainThread]: On macro_execute_query: COMMIT
[0m18:17:45.365450 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:17:45.365587 [debug] [MainThread]: On macro_execute_query: COMMIT
[0m18:17:45.365830 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:17:45.449230 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:17:45.449462 [debug] [MainThread]: On macro_execute_query: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "macro_execute_query"} */

    SELECT * FROM analytics.customer_orders_analysis LIMIT 10
  
[0m18:17:45.457902 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "macro_execute_query"} */

    SELECT * FROM analytics.customer_orders_analysis LIMIT 10
  
[0m18:17:45.458084 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m18:17:45.458286 [debug] [MainThread]: On macro_execute_query: Close
[0m18:17:45.458527 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  Catalog Error: Table with name customer_orders_analysis does not exist!
  Did you mean "analytics_dev.core_business_metrics"?
  
  LINE 3:     SELECT * FROM analytics.customer_orders_analysis LIMIT 10
                            ^
[0m18:17:45.464887 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 95, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    _execute_query_with_retry(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        cursor=cursor,
        ^^^^^^^^^^^^^^
    ...<4 lines>...
        attempt=1,
        ^^^^^^^^^^
    )
    ^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 23, in execute
    return self._cursor.execute(sql)
           ~~~~~~~~~~~~~~~~~~~~^^^^^
duckdb.duckdb.CatalogException: Catalog Error: Table with name customer_orders_analysis does not exist!
Did you mean "analytics_dev.core_business_metrics"?

LINE 3:     SELECT * FROM analytics.customer_orders_analysis LIMIT 10
                          ^

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 23, in macro
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 438, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 130, in execute
    return super().execute(sql, auto_begin, fetch, limit)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 218, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 130, in add_query
    with self.exception_handler(sql):
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 103, in exception_handler
    raise dbt.exceptions.DbtRuntimeError(str(exc)) from exc
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  Catalog Error: Table with name customer_orders_analysis does not exist!
  Did you mean "analytics_dev.core_business_metrics"?
  
  LINE 3:     SELECT * FROM analytics.customer_orders_analysis LIMIT 10
                            ^

[0m18:17:45.469218 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:17:45.470772 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.78259665, "process_in_blocks": "0", "process_kernel_time": 0.351554, "process_mem_max_rss": "146161664", "process_out_blocks": "0", "process_user_time": 1.259542}
[0m18:17:45.471085 [debug] [MainThread]: Command `dbt run-operation` failed at 18:17:45.471021 after 0.78 seconds
[0m18:17:45.471283 [debug] [MainThread]: Connection 'macro_execute_query' was properly closed.
[0m18:17:45.471513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111925570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e844d0>]}
[0m18:17:45.471757 [debug] [MainThread]: Flushing usage events
[0m18:17:46.004506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:05.812760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118214830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119707c50>]}


============================== 18:18:05.816289 | 0dd6903d-202f-4924-889d-0e63a640ccc1 ==============================
[0m18:18:05.816289 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:18:05.816623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation execute_query --args {"query": "SELECT * FROM analytics_dev.core_business_metrics LIMIT 10"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:05.984821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dd6903d-202f-4924-889d-0e63a640ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199e8c30>]}
[0m18:18:06.014235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dd6903d-202f-4924-889d-0e63a640ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11978a360>]}
[0m18:18:06.017458 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:18:06.079403 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:18:06.215821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:06.216181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:06.255882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dd6903d-202f-4924-889d-0e63a640ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197cf450>]}
[0m18:18:06.322067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:18:06.324935 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:18:06.345624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dd6903d-202f-4924-889d-0e63a640ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199e36b0>]}
[0m18:18:06.346018 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:18:06.346204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dd6903d-202f-4924-889d-0e63a640ccc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119992b30>]}
[0m18:18:06.346559 [debug] [MainThread]: Acquiring new duckdb connection 'macro_execute_query'
[0m18:18:06.346740 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:18:06.346869 [debug] [MainThread]: On macro_execute_query: BEGIN
[0m18:18:06.346996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:06.411250 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m18:18:06.411558 [debug] [MainThread]: On macro_execute_query: COMMIT
[0m18:18:06.411736 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:18:06.411886 [debug] [MainThread]: On macro_execute_query: COMMIT
[0m18:18:06.412171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:18:06.481329 [debug] [MainThread]: Using duckdb connection "macro_execute_query"
[0m18:18:06.481596 [debug] [MainThread]: On macro_execute_query: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "macro_execute_query"} */

    SELECT * FROM analytics_dev.core_business_metrics LIMIT 10
  
[0m18:18:06.488982 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m18:18:06.490328 [debug] [MainThread]: On macro_execute_query: Close
[0m18:18:06.494327 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:18:06.495931 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.7406262, "process_in_blocks": "0", "process_kernel_time": 0.375678, "process_mem_max_rss": "142852096", "process_out_blocks": "0", "process_user_time": 1.268571}
[0m18:18:06.496239 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:18:06.496170 after 0.74 seconds
[0m18:18:06.496403 [debug] [MainThread]: Connection 'macro_execute_query' was properly closed.
[0m18:18:06.496566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a04d4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4844d0>]}
[0m18:18:06.496748 [debug] [MainThread]: Flushing usage events
[0m18:18:06.989402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:00.327457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104118830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0bc50>]}


============================== 18:19:00.331075 | 4732b6da-b323-4a1b-861e-85e5af249f15 ==============================
[0m18:19:00.331075 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:19:00.331448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'send_anonymous_usage_stats': 'True'}
[0m18:19:00.495661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4732b6da-b323-4a1b-861e-85e5af249f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff0c30>]}
[0m18:19:00.521935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4732b6da-b323-4a1b-861e-85e5af249f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8e360>]}
[0m18:19:00.525826 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:19:00.594091 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:19:00.743818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:00.744096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:00.788641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4732b6da-b323-4a1b-861e-85e5af249f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed7450>]}
[0m18:19:00.849649 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:19:00.851715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:19:00.873323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4732b6da-b323-4a1b-861e-85e5af249f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feb6b0>]}
[0m18:19:00.873642 [info ] [MainThread]: Found 8 models, 2 snapshots, 3 analyses, 27 data tests, 4 seeds, 433 macros
[0m18:19:00.873850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4732b6da-b323-4a1b-861e-85e5af249f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f82b30>]}
[0m18:19:00.874180 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m18:19:00.874352 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:19:00.874477 [debug] [MainThread]: On macro_run_query: BEGIN
[0m18:19:00.874595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:00.923042 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m18:19:00.923306 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:19:00.923454 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m18:19:00.923579 [debug] [MainThread]: On macro_run_query: COMMIT
[0m18:19:00.923766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:19:00.926567 [debug] [MainThread]: On macro_run_query: Close
[0m18:19:00.926799 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m18:19:00.930092 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m18:19:00.934076 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:19:00.935752 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.68354, "process_in_blocks": "0", "process_kernel_time": 0.277451, "process_mem_max_rss": "132513792", "process_out_blocks": "0", "process_user_time": 1.123756}
[0m18:19:00.936027 [debug] [MainThread]: Command `dbt run-operation` failed at 18:19:00.935974 after 0.68 seconds
[0m18:19:00.936233 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m18:19:00.936464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f61a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbe990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053eb710>]}
[0m18:19:00.936679 [debug] [MainThread]: Flushing usage events
[0m18:19:01.772500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:09.391986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112214830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11320b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11320bc50>]}


============================== 18:26:09.395565 | 383290a8-e453-44d4-9313-c2eecac078a3 ==============================
[0m18:26:09.395565 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:26:09.395903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:09.578308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e8c30>]}
[0m18:26:09.605958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328a360>]}
[0m18:26:09.609555 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:26:09.722259 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:26:09.854260 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m18:26:09.854676 [debug] [MainThread]: Partial parsing: deleted file: dbt_duckdb_analytics_poc://analyses/customer_orders_analysis.sql
[0m18:26:09.854838 [debug] [MainThread]: Partial parsing: deleted file: dbt_duckdb_analytics_poc://analyses/product_performance.sql
[0m18:26:09.854968 [debug] [MainThread]: Partial parsing: deleted file: dbt_duckdb_analytics_poc://analyses/revenue_trends.sql
[0m18:26:09.908805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11405d650>]}
[0m18:26:09.969402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:26:09.971657 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:26:09.995281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e3b60>]}
[0m18:26:09.995603 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:26:09.995764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114143e70>]}
[0m18:26:09.997003 [info ] [MainThread]: 
[0m18:26:09.997175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:09.997301 [info ] [MainThread]: 
[0m18:26:09.997543 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:26:10.000064 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:26:10.069176 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:26:10.069455 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:26:10.069606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:10.119074 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m18:26:10.120176 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:26:10.120564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:26:10.121029 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:26:10.124385 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:26:10.124556 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:26:10.124694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:10.125274 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:26:10.126055 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:26:10.126191 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:26:10.126384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:10.126508 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:26:10.126627 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:26:10.127153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:10.127549 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:26:10.127678 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:26:10.127792 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:26:10.127962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:26:10.128087 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:26:10.129046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_snapshots)
[0m18:26:10.131673 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:26:10.131847 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:26:10.132319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:10.132516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:26:10.133331 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:26:10.133474 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:26:10.133590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:10.133709 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:26:10.133874 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:26:10.134008 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:26:10.134142 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:26:10.134327 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:26:10.134459 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:26:10.145258 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:26:10.145496 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:26:10.146354 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:26:10.146988 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:26:10.148179 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:26:10.148424 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:26:10.148555 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:26:10.148691 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:26:10.149757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ed160>]}
[0m18:26:10.149984 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.150118 [debug] [MainThread]: On master: BEGIN
[0m18:26:10.150244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:10.150489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:10.150612 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.150731 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.150846 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.151033 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:10.151160 [debug] [MainThread]: On master: Close
[0m18:26:10.153059 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:26:10.153244 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:26:10.153405 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:26:10.153552 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:26:10.153788 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m18:26:10.153993 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m18:26:10.154239 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m18:26:10.154704 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:26:10.154465 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m18:26:10.154970 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:26:10.155152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:26:10.155307 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:26:10.155465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:26:10.155609 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:26:10.155750 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:26:10.159690 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.159973 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:26:10.161271 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.162716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.164194 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.165935 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:26:10.166170 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:26:10.166451 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:26:10.172505 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:26:10.183699 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.185572 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.187184 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.190474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.191875 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.192141 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:26:10.192311 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:26:10.192628 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.192834 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:26:10.192989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:10.193251 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.193415 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:26:10.193559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:10.193789 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.193967 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.194146 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        CAST(order_date AS DATE) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from CAST(order_date AS DATE)) as order_year,
        extract(month from CAST(order_date AS DATE)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:26:10.194342 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.194491 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.194640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.194867 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:26:10.195103 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.195356 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.195610 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.195796 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:26:10.195981 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:26:10.196178 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        CAST(registration_date AS DATE) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - CAST(registration_date AS DATE) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:26:10.199523 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.200032 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:26:10.200264 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:26:10.200459 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.200629 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.201111 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:26:10.202923 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.203150 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.203404 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.203809 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:26:10.242038 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m18:26:10.243038 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.244521 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.247235 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.247578 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:26:10.247918 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.248120 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:26:10.248319 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:26:10.249880 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.250053 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.250445 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:26:10.250612 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.251788 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.251981 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.260190 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:26:10.260492 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m18:26:10.260692 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:26:10.262505 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.262747 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.263442 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:26:10.263771 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:26:10.263962 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:26:10.264131 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.264291 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.265001 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:26:10.265165 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:26:10.265318 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.265471 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.266109 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:26:10.266317 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:26:10.266506 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.266760 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:26:10.269836 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:26:10.272324 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:26:10.272527 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
drop view if exists "analytics_dev"."main"."stg_orders__dbt_backup" cascade
[0m18:26:10.272720 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:26:10.272905 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:26:10.273167 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m18:26:10.274281 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:26:10.275463 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:26:10.275651 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.276670 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:26:10.276873 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:26:10.277087 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
drop view if exists "analytics_dev"."main"."stg_customers__dbt_backup" cascade
[0m18:26:10.278596 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:26:10.278811 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:26:10.279863 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.280058 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.280233 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.280963 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:26:10.281590 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:26:10.282267 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:26:10.282719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429b410>]}
[0m18:26:10.282881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114664f70>]}
[0m18:26:10.283081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114665020>]}
[0m18:26:10.283266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cf7f0>]}
[0m18:26:10.283517 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.12s]
[0m18:26:10.283765 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.13s]
[0m18:26:10.284102 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.13s]
[0m18:26:10.284580 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:26:10.284326 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.13s]
[0m18:26:10.284884 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:26:10.285150 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:26:10.285464 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:26:10.285766 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:26:10.286136 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:26:10.286459 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:26:10.285996 [info ] [Thread-3 (]: 5 of 8 START sql table model main.dim_customers ................................ [RUN]
[0m18:26:10.286332 [info ] [Thread-1 (]: 6 of 8 START sql table model main.dim_products ................................. [RUN]
[0m18:26:10.286965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:26:10.287152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:26:10.286717 [info ] [Thread-4 (]: 7 of 8 START sql table model main.fct_orders ................................... [RUN]
[0m18:26:10.287350 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:26:10.287499 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:26:10.287659 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:26:10.289482 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.291148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.291410 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:26:10.293130 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.293534 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:26:10.293784 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:26:10.304281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.305913 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.306202 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:26:10.307772 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.308251 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.308467 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.308639 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: BEGIN
[0m18:26:10.308822 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: BEGIN
[0m18:26:10.308990 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.309144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:10.309300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:26:10.309450 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: BEGIN
[0m18:26:10.309794 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:26:10.310025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.310195 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.310346 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.310492 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.310646 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.310832 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select 
        *
    from "analytics_dev"."main"."stg_products"
),

product_sales as (
    select
        p.product_id,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.net_amount) as total_sales
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    where o.status = 'completed'
    group by p.product_id
),

final as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price,
        p.stock_quantity,
        p.supplier,
        p.stock_level,
        p.inventory_value,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_sales, 0) as total_sales,
        case
            when coalesce(ps.total_sales, 0) > 500 then 'High'
            when coalesce(ps.total_sales, 0) > 100 then 'Medium'
            else 'Low'
        end as product_performance
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
    );
  
  
[0m18:26:10.311018 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.311190 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select 
        *
    from "analytics_dev"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        sum(total_amount) as lifetime_value
    from "analytics_dev"."main"."stg_orders"
    group by customer_id
),

final as (
    select
        c.customer_id,
        c.first_name,
        c.last_name,
        c.full_name,
        c.email,
        c.registration_date,
        c.country,
        c.days_since_registration,
        coalesce(co.order_count, 0) as order_count,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        case
            when coalesce(co.lifetime_value, 0) > 500 then 'High'
            when coalesce(co.lifetime_value, 0) > 100 then 'Medium'
            else 'Low'
        end as customer_value_segment
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
    );
  
  
[0m18:26:10.311521 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */

  
    
    

    create  table
      "analytics_dev"."main"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."stg_orders"
),

order_items as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(gross_amount) as gross_order_amount,
        sum(net_amount) as net_order_amount
    from "analytics_dev"."main"."stg_order_items"
    group by order_id
),

customers as (
    select
        *
    from "analytics_dev"."main"."stg_customers"
),

final as (
    select
        o.order_id,
        o.customer_id,
        c.full_name as customer_name,
        c.country as customer_country,
        o.order_date,
        o.order_year,
        o.order_month,
        o.status,
        o.payment_method,
        o.total_amount as order_total_amount,
        oi.total_items,
        oi.gross_order_amount,
        oi.net_order_amount,
        o.is_completed,
        case
            when o.total_amount > 200 then 'Large'
            when o.total_amount > 50 then 'Medium'
            else 'Small'
        end as order_size
    from orders o
    join order_items oi on o.order_id = oi.order_id
    join customers c on o.customer_id = c.customer_id
)

select * from final
    );
  
  
[0m18:26:10.321384 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m18:26:10.321625 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m18:26:10.323223 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.324827 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.325088 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:26:10.325299 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:26:10.325515 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m18:26:10.326883 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.327709 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m18:26:10.328060 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.328259 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.329774 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.329952 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.331486 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.331698 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:26:10.333083 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.333286 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m18:26:10.333545 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:26:10.333732 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.336323 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:26:10.336529 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.336693 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:26:10.336858 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.337073 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:26:10.337748 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:26:10.337933 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.338537 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:26:10.338698 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.339752 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:26:10.339940 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.340101 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:26:10.340267 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
drop table if exists "analytics_dev"."main"."dim_customers__dbt_backup" cascade
[0m18:26:10.340431 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:26:10.340871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.342064 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:26:10.342238 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.342406 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
drop table if exists "analytics_dev"."main"."dim_products__dbt_backup" cascade
[0m18:26:10.342562 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:26:10.343430 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:26:10.344151 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_customers: Close
[0m18:26:10.344323 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
drop table if exists "analytics_dev"."main"."fct_orders__dbt_backup" cascade
[0m18:26:10.344486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.344777 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145683d0>]}
[0m18:26:10.345405 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.dim_products: Close
[0m18:26:10.345896 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:26:10.345739 [info ] [Thread-3 (]: 5 of 8 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.06s]
[0m18:26:10.346527 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.fct_orders: Close
[0m18:26:10.346763 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:26:10.346968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355bb30>]}
[0m18:26:10.347254 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b7b30>]}
[0m18:26:10.347669 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.06s]
[0m18:26:10.348216 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:26:10.347934 [info ] [Thread-4 (]: 7 of 8 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.06s]
[0m18:26:10.348599 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:26:10.349047 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:26:10.349304 [info ] [Thread-2 (]: 8 of 8 START sql table model main.core_business_metrics ........................ [RUN]
[0m18:26:10.349558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:26:10.349727 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:26:10.351890 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.352548 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:26:10.354312 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.355066 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.355306 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: BEGIN
[0m18:26:10.355459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:26:10.355819 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.355968 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.356220 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */

  
    
    

    create  table
      "analytics_dev"."main"."core_business_metrics__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."fct_orders"
),

customers as (
    select
        *
    from "analytics_dev"."main"."dim_customers"
),

products as (
    select
        *
    from "analytics_dev"."main"."dim_products"
),

daily_sales as (
    select
        order_date,
        sum(net_order_amount) as daily_revenue,
        count(distinct order_id) as order_count,
        count(distinct customer_id) as customer_count,
        sum(total_items) as items_sold
    from orders
    where status = 'completed'
    group by order_date
),

country_sales as (
    select
        customer_country,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        count(distinct customer_id) as customer_count,
        sum(net_order_amount) / count(distinct customer_id) as revenue_per_customer
    from orders
    where status = 'completed'
    group by customer_country
),

category_sales as (
    select
        p.category,
        count(distinct o.order_id) as order_count,
        sum(oi.net_amount) as total_revenue,
        sum(oi.quantity) as quantity_sold
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    where o.status = 'completed'
    group by p.category
),

payment_method_analysis as (
    select
        payment_method,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        avg(net_order_amount) as avg_order_value
    from orders
    where status = 'completed'
    group by payment_method
),

final as (
    select
        'Overall' as metric_group,
        'Total Revenue' as metric_name,
        cast(sum(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Orders' as metric_name,
        cast(count(distinct order_id) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Average Order Value' as metric_name,
        cast(avg(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Customers' as metric_name,
        cast(count(distinct customer_id) as varchar) as metric_value
    from customers
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Products' as metric_name,
        cast(count(distinct product_id) as varchar) as metric_value
    from products
    
    union all
    
    (select
        'Time' as metric_group,
        'Date with Highest Revenue' as metric_name,
        cast(order_date as varchar) as metric_value
    from daily_sales
    order by daily_revenue desc
    limit 1)
    
    union all
    
    (select
        'Geography' as metric_group,
        'Top Country by Revenue' as metric_name,
        customer_country as metric_value
    from country_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Product' as metric_group,
        'Top Category by Revenue' as metric_name,
        category as metric_value
    from category_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Customer' as metric_group,
        'Top Payment Method' as metric_name,
        payment_method as metric_value
    from payment_method_analysis
    order by order_count desc
    limit 1)
)

select * from final
    );
  
  
[0m18:26:10.365718 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:26:10.367452 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.367631 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
alter table "analytics_dev"."main"."core_business_metrics" rename to "core_business_metrics__dbt_backup"
[0m18:26:10.368000 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.369179 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.369335 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
alter table "analytics_dev"."main"."core_business_metrics__dbt_tmp" rename to "core_business_metrics"
[0m18:26:10.369585 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.372739 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:26:10.373002 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.373163 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:26:10.373661 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.374783 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:26:10.374974 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
drop table if exists "analytics_dev"."main"."core_business_metrics__dbt_backup" cascade
[0m18:26:10.375399 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:26:10.376081 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: Close
[0m18:26:10.376401 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '383290a8-e453-44d4-9313-c2eecac078a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452e930>]}
[0m18:26:10.376706 [info ] [Thread-2 (]: 8 of 8 OK created sql table model main.core_business_metrics ................... [[32mOK[0m in 0.03s]
[0m18:26:10.376957 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:26:10.377795 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.377944 [debug] [MainThread]: On master: BEGIN
[0m18:26:10.378064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:10.378414 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:10.378635 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.378769 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.378885 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.379107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:26:10.379231 [debug] [MainThread]: On master: Close
[0m18:26:10.379409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:10.379522 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_products' was properly closed.
[0m18:26:10.379626 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m18:26:10.379725 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_customers' was properly closed.
[0m18:26:10.379825 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.fct_orders' was properly closed.
[0m18:26:10.380003 [info ] [MainThread]: 
[0m18:26:10.380153 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:26:10.380803 [debug] [MainThread]: Command end result
[0m18:26:10.398882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:26:10.400661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:26:10.404956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:26:10.405177 [info ] [MainThread]: 
[0m18:26:10.405360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:10.405499 [info ] [MainThread]: 
[0m18:26:10.405642 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:26:10.407716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0640007, "process_in_blocks": "0", "process_kernel_time": 0.41577, "process_mem_max_rss": "172982272", "process_out_blocks": "0", "process_user_time": 1.50002}
[0m18:26:10.407931 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:10.407883 after 1.06 seconds
[0m18:26:10.408110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114637cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114637a70>]}
[0m18:26:10.408277 [debug] [MainThread]: Flushing usage events
[0m18:26:11.868063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:43.004987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930bc50>]}


============================== 18:27:43.008930 | 1d726388-1446-4f5d-b763-c35a1dac090f ==============================
[0m18:27:43.008930 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:27:43.009296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:27:43.196921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e4d60>]}
[0m18:27:43.225997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938a360>]}
[0m18:27:43.229370 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:27:43.298879 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:27:43.425731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:43.426049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:43.458371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3250>]}
[0m18:27:43.479626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f15e0>]}
[0m18:27:43.479900 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:27:43.480077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981fe70>]}
[0m18:27:43.481513 [info ] [MainThread]: 
[0m18:27:43.481701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:43.481836 [info ] [MainThread]: 
[0m18:27:43.482067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:27:43.484644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:27:43.486391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:27:43.566466 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:27:43.566730 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:27:43.566897 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:27:43.567053 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:27:43.567199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:43.567333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:43.616445 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m18:27:43.616713 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m18:27:43.616884 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:27:43.617044 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:27:43.617206 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:27:43.617367 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:27:43.627923 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:27:43.628121 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:27:43.628953 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:27:43.629735 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:27:43.630682 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:27:43.630865 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:27:43.631121 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:27:43.631265 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:27:43.632352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d726388-1446-4f5d-b763-c35a1dac090f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aeaa90>]}
[0m18:27:43.634428 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:27:43.634629 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:27:43.634798 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:27:43.634959 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:27:43.635141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m18:27:43.635393 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m18:27:43.635684 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m18:27:43.635844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m18:27:43.636012 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:27:43.636166 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:27:43.636314 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:27:43.636455 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:27:43.639702 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:27:43.640793 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:27:43.641521 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:27:43.642276 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:27:43.642615 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:27:43.642911 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:27:43.643187 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:27:43.643457 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:27:43.643774 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:27:43.644072 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:27:43.644239 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:27:43.644403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:27:43.644555 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:27:43.644714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m18:27:43.644884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m18:27:43.645037 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:27:43.645193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:27:43.645356 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:27:43.645516 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:27:43.647125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:27:43.647304 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:27:43.648439 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:27:43.649559 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:27:43.650932 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:27:43.652201 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:27:43.652555 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:27:43.652756 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:27:43.652953 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:27:43.653104 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:27:43.653384 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:27:43.653694 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:27:43.653851 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:27:43.654130 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:27:43.654292 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:27:43.654472 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:27:43.654660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m18:27:43.654873 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:27:43.655042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:27:43.655218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:27:43.655368 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:27:43.655523 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:27:43.655668 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:27:43.655808 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:27:43.657166 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:27:43.657324 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:27:43.663124 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:27:43.664781 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:27:43.665145 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:27:43.667748 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:27:43.668041 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:27:43.668291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:27:43.668453 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:27:43.670440 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:27:43.670789 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:27:43.670954 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:27:43.671118 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:27:43.671407 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:27:43.671699 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:27:43.671982 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:27:43.672136 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:27:43.672287 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:27:43.672461 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:27:43.672640 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:27:43.672913 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:27:43.673091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:27:43.673260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:27:43.673418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:27:43.673579 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:27:43.673741 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:27:43.673884 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:27:43.674022 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:27:43.674170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:27:43.675804 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:27:43.677333 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:27:43.679146 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:27:43.679333 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:27:43.680683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:27:43.681000 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:27:43.681162 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:27:43.681305 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:27:43.681573 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:27:43.681848 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:27:43.682136 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:27:43.682284 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:27:43.682440 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:27:43.682633 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:27:43.682819 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:27:43.683092 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:27:43.683257 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:27:43.683420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:27:43.683581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:27:43.683752 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:27:43.683917 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:27:43.684087 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:27:43.684228 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:27:43.684380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:27:43.685767 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:27:43.687656 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:27:43.689195 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:27:43.689376 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:27:43.693332 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:27:43.693632 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:27:43.693800 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:27:43.693946 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:27:43.694218 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:27:43.694497 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:27:43.694757 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:27:43.694904 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:27:43.695062 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:27:43.695239 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:27:43.695412 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:27:43.695717 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:27:43.695889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:27:43.696052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:27:43.696213 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:27:43.696380 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:27:43.696543 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:27:43.696694 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:27:43.696832 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:27:43.696983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m18:27:43.699327 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:27:43.700832 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:27:43.702505 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:27:43.702690 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:27:43.704053 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:27:43.704353 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:27:43.704518 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:27:43.704694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:27:43.704846 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:27:43.706376 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:27:43.707711 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:27:43.708030 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:27:43.708306 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:27:43.708513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:27:43.708689 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:27:43.708846 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:27:43.709010 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:27:43.709327 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:27:43.709489 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:27:43.709772 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:27:43.713910 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:27:43.714131 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:27:43.714449 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:27:43.714670 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:27:43.714907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:27:43.715095 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:27:43.715286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:27:43.715453 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:27:43.715619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:27:43.715799 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:27:43.717350 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:27:43.717520 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:27:43.717671 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:27:43.718714 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:27:43.754164 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:27:43.754653 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:27:43.754974 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:27:43.755152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:27:43.755317 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:27:43.756961 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:27:43.757155 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:27:43.757507 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:27:43.757707 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:27:43.757919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:27:43.758081 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:27:43.758235 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:27:43.758386 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:27:43.758667 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:27:43.760062 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:27:43.760359 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:27:43.760552 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:27:43.760761 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:27:43.760919 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:27:43.761115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:27:43.761419 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:27:43.761589 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:27:43.761752 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:27:43.761893 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:27:43.762064 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:27:43.762220 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:27:43.762481 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:27:43.764154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:27:43.764349 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:27:43.765878 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:27:43.766082 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:27:43.766290 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:27:43.766505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:27:43.769039 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:27:43.769258 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:27:43.769427 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:27:43.769576 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:27:43.771191 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:27:43.771522 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:27:43.771833 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:27:43.772056 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:27:43.772227 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:27:43.772440 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:27:43.772625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:27:43.772781 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:27:43.773062 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:27:43.773236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:27:43.773396 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:27:43.773652 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:27:43.773809 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:27:43.773960 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:27:43.775276 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:27:43.775451 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:27:43.775628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m18:27:43.777418 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:27:43.777628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:27:43.777799 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:27:43.778003 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:27:43.778173 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:27:43.779761 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:27:43.781577 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:27:43.781895 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:27:43.782051 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:27:43.782262 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:27:43.782552 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:27:43.782762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_order_dates, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:27:43.782938 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:27:43.783142 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:27:43.783291 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:27:43.783573 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:27:43.784699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:27:43.784980 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:27:43.785389 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:27:43.785645 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:27:43.786211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:43.786340 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_price_positive' was properly closed.
[0m18:27:43.786452 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m18:27:43.786559 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m18:27:43.786661 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m18:27:43.788934 [debug] [MainThread]: Command end result
[0m18:27:43.847032 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:27:43.848923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:27:43.860499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:27:43.864024 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:27:43.864204 [info ] [MainThread]: Building catalog
[0m18:27:43.870027 [debug] [ThreadPool]: Acquiring new duckdb connection 'analytics_dev.information_schema'
[0m18:27:43.873877 [debug] [ThreadPool]: Using duckdb connection "analytics_dev.information_schema"
[0m18:27:43.874104 [debug] [ThreadPool]: On analytics_dev.information_schema: BEGIN
[0m18:27:43.874242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:43.874621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:27:43.874743 [debug] [ThreadPool]: Using duckdb connection "analytics_dev.information_schema"
[0m18:27:43.874886 [debug] [ThreadPool]: On analytics_dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "analytics_dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'analytics_dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'analytics_dev'
    )
    select
        'analytics_dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('snapshots') or upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:27:43.881470 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:27:43.895496 [debug] [ThreadPool]: On analytics_dev.information_schema: ROLLBACK
[0m18:27:43.895927 [debug] [ThreadPool]: Failed to rollback 'analytics_dev.information_schema'
[0m18:27:43.896078 [debug] [ThreadPool]: On analytics_dev.information_schema: Close
[0m18:27:43.919928 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/catalog.json
[0m18:27:43.935875 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:27:43.937703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:27:43.937864 [info ] [MainThread]: Catalog written to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/catalog.json
[0m18:27:43.939386 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.98437756, "process_in_blocks": "0", "process_kernel_time": 0.378306, "process_mem_max_rss": "154468352", "process_out_blocks": "0", "process_user_time": 1.418144}
[0m18:27:43.939603 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:27:43.939559 after 0.98 seconds
[0m18:27:43.939748 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:27:43.939859 [debug] [MainThread]: Connection 'analytics_dev.information_schema' was properly closed.
[0m18:27:43.940009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a130050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1301b0>]}
[0m18:27:43.940174 [debug] [MainThread]: Flushing usage events
[0m18:27:44.626833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:09.394866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbfc50>]}


============================== 18:28:09.398212 | 15f1b625-7895-4f32-8709-244e3a7405d7 ==============================
[0m18:28:09.398212 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:28:09.398570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:28:09.544107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa0c30>]}
[0m18:28:09.572673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3e360>]}
[0m18:28:09.576252 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:28:09.636315 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:28:09.637398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:28:09.637627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e86d50>]}
[0m18:28:10.503228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109551130>]}
[0m18:28:10.560342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:28:10.562231 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:28:10.580558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097efaf0>]}
[0m18:28:10.580827 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:28:10.580992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a053ad0>]}
[0m18:28:10.582199 [info ] [MainThread]: 
[0m18:28:10.582389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:28:10.582522 [info ] [MainThread]: 
[0m18:28:10.582767 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:28:10.585266 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m18:28:10.648833 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m18:28:10.649100 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m18:28:10.649245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:10.696522 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m18:28:10.697391 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m18:28:10.697779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_main)
[0m18:28:10.698053 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "main"
"
[0m18:28:10.701263 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:28:10.701430 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m18:28:10.701561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:10.701931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:10.702564 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:28:10.702696 [debug] [ThreadPool]: On create_analytics_dev_main: BEGIN
[0m18:28:10.702877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:10.702999 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:28:10.703119 [debug] [ThreadPool]: On create_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_main"} */

    
    
        create schema if not exists "analytics_dev"."main"
    
[0m18:28:10.703327 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:10.703709 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:28:10.703835 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_main"
[0m18:28:10.703949 [debug] [ThreadPool]: On create_analytics_dev_main: COMMIT
[0m18:28:10.704126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:10.704253 [debug] [ThreadPool]: On create_analytics_dev_main: Close
[0m18:28:10.705152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_main, now list_analytics_dev_main)
[0m18:28:10.707826 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:28:10.708438 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:28:10.708579 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:28:10.709357 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:28:10.709502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:10.709640 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:28:10.709840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:10.710008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:28:10.710135 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:28:10.710264 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:28:10.710475 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:28:10.710596 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:28:10.710725 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:28:10.720327 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:28:10.720519 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:28:10.721207 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:28:10.721930 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:28:10.723088 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:28:10.723234 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:28:10.723477 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:28:10.723627 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:28:10.724734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0dd910>]}
[0m18:28:10.724978 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:10.725112 [debug] [MainThread]: On master: BEGIN
[0m18:28:10.725228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:10.725493 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:10.725614 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.725733 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:10.725849 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.726028 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:10.726150 [debug] [MainThread]: On master: Close
[0m18:28:10.728049 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:28:10.728263 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:28:10.728455 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:28:10.728640 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:28:10.728893 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_order_items ............................... [RUN]
[0m18:28:10.729148 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_products .................................. [RUN]
[0m18:28:10.729386 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m18:28:10.729618 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m18:28:10.729843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:28:10.730069 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_products'
[0m18:28:10.730249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:28:10.730447 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.dbt_duckdb_analytics_poc.stg_orders'
[0m18:28:10.730611 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:28:10.730766 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:28:10.730906 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:28:10.731042 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:28:10.735022 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.736473 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.738158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.739562 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.750016 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:28:10.756675 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:28:10.768418 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.769641 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.770091 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:28:10.771623 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.771891 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:28:10.773634 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.774695 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.774961 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.775194 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.775376 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.775558 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: BEGIN
[0m18:28:10.775809 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: BEGIN
[0m18:28:10.776025 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: BEGIN
[0m18:28:10.776205 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: BEGIN
[0m18:28:10.776411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:28:10.776617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.776805 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:28:10.776967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:28:10.777427 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.777609 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.777785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.778009 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.778180 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.778346 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.778506 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.778692 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */

  
  create view "analytics_dev"."main"."stg_orders__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        CAST(order_date AS DATE) as order_date,
        total_amount,
        status,
        payment_method,
        -- Crear campos adicionales
        extract(year from CAST(order_date AS DATE)) as order_year,
        extract(month from CAST(order_date AS DATE)) as order_month,
        case
            when status = 'completed' then 1
            else 0
        end as is_completed
    from source
)

select * from renamed
  );

[0m18:28:10.778895 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */

  
  create view "analytics_dev"."main"."stg_products__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_products"
),

renamed as (
    select
        product_id,
        product_name,
        category,
        price,
        stock_quantity,
        supplier,
        -- Crear campos adicionales
        case
            when stock_quantity <= 50 then 'Low'
            when stock_quantity <= 100 then 'Medium'
            else 'High'
        end as stock_level,
        price * stock_quantity as inventory_value
    from source
)

select * from renamed
  );

[0m18:28:10.779065 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.779234 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */

  
  create view "analytics_dev"."main"."stg_customers__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_customers"
),

renamed as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        CAST(registration_date AS DATE) as registration_date,
        country,
        -- Crear campos adicionales
        first_name || ' ' || last_name as full_name,
        current_date() - CAST(registration_date AS DATE) as days_since_registration
    from source
)

select * from renamed
  );

[0m18:28:10.779603 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */

  
  create view "analytics_dev"."main"."stg_order_items__dbt_tmp" as (
    with source as (
    select 
        *
    from "analytics_dev"."main"."raw_order_items"
),

renamed as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        discount,
        -- Crear campos adicionales
        quantity * unit_price as gross_amount,
        quantity * unit_price * (1 - discount) as net_amount
    from source
)

select * from renamed
  );

[0m18:28:10.779911 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.783366 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.783594 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:28:10.783774 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:28:10.783933 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:28:10.785435 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.786876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.787056 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:28:10.787323 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m18:28:10.787525 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:28:10.788754 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.788903 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.789209 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.789359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.789503 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m18:28:10.790697 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.792008 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.793100 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.793358 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
alter view "analytics_dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:28:10.793542 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
alter view "analytics_dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m18:28:10.793723 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.793883 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
alter view "analytics_dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:28:10.795193 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.795368 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.795522 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.795707 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
alter view "analytics_dev"."main"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m18:28:10.803089 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:28:10.804379 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:28:10.804752 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:28:10.804944 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.805152 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.805306 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.805882 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:28:10.806064 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: COMMIT
[0m18:28:10.806633 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:28:10.806794 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: COMMIT
[0m18:28:10.806946 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.807248 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.807522 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: COMMIT
[0m18:28:10.807761 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: COMMIT
[0m18:28:10.810571 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:28:10.812870 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:28:10.813065 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_products"} */
drop view if exists "analytics_dev"."main"."stg_products__dbt_backup" cascade
[0m18:28:10.813280 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:28:10.813520 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m18:28:10.813702 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:28:10.815301 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:28:10.816281 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:28:10.817286 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:28:10.817467 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:28:10.817633 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_customers"} */
drop view if exists "analytics_dev"."main"."stg_customers__dbt_backup" cascade
[0m18:28:10.817827 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_orders"} */
drop view if exists "analytics_dev"."main"."stg_orders__dbt_backup" cascade
[0m18:28:10.817993 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.stg_order_items"} */
drop view if exists "analytics_dev"."main"."stg_order_items__dbt_backup" cascade
[0m18:28:10.819314 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.stg_products: Close
[0m18:28:10.820028 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.820764 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.stg_orders: Close
[0m18:28:10.820946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.821347 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.822016 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.stg_customers: Close
[0m18:28:10.822647 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.stg_order_items: Close
[0m18:28:10.823070 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ffb70>]}
[0m18:28:10.823239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a761b30>]}
[0m18:28:10.823419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44af00>]}
[0m18:28:10.823554 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082900d0>]}
[0m18:28:10.823808 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.09s]
[0m18:28:10.824113 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.09s]
[0m18:28:10.824403 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.09s]
[0m18:28:10.824872 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:28:10.824659 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_order_items .......................... [[32mOK[0m in 0.09s]
[0m18:28:10.825132 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:28:10.825347 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:28:10.825646 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:28:10.826051 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:28:10.826220 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:28:10.826406 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:28:10.826609 [info ] [Thread-1 (]: 7 of 8 START sql table model main.fct_orders ................................... [RUN]
[0m18:28:10.826836 [info ] [Thread-3 (]: 6 of 8 START sql table model main.dim_products ................................. [RUN]
[0m18:28:10.827051 [info ] [Thread-4 (]: 5 of 8 START sql table model main.dim_customers ................................ [RUN]
[0m18:28:10.827262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:28:10.827442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:28:10.827608 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:28:10.827763 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:28:10.827907 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:28:10.828053 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:28:10.829624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.831661 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.833033 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.834122 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:28:10.834299 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:28:10.845941 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:28:10.847594 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.849144 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.850603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.852120 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.852295 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: BEGIN
[0m18:28:10.852450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:28:10.852813 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.852964 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.853137 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select 
        *
    from "analytics_dev"."main"."stg_products"
),

product_sales as (
    select
        p.product_id,
        sum(oi.quantity) as total_quantity_sold,
        sum(oi.net_amount) as total_sales
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    where o.status = 'completed'
    group by p.product_id
),

final as (
    select
        p.product_id,
        p.product_name,
        p.category,
        p.price,
        p.stock_quantity,
        p.supplier,
        p.stock_level,
        p.inventory_value,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_sales, 0) as total_sales,
        case
            when coalesce(ps.total_sales, 0) > 500 then 'High'
            when coalesce(ps.total_sales, 0) > 100 then 'Medium'
            else 'Low'
        end as product_performance
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
    );
  
  
[0m18:28:10.853804 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.853988 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: BEGIN
[0m18:28:10.854138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:28:10.854326 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.854558 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: BEGIN
[0m18:28:10.854721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:10.854870 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.855069 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.855245 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */

  
    
    

    create  table
      "analytics_dev"."main"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select 
        *
    from "analytics_dev"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        sum(total_amount) as lifetime_value
    from "analytics_dev"."main"."stg_orders"
    group by customer_id
),

final as (
    select
        c.customer_id,
        c.first_name,
        c.last_name,
        c.full_name,
        c.email,
        c.registration_date,
        c.country,
        c.days_since_registration,
        coalesce(co.order_count, 0) as order_count,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        case
            when coalesce(co.lifetime_value, 0) > 500 then 'High'
            when coalesce(co.lifetime_value, 0) > 100 then 'Medium'
            else 'Low'
        end as customer_value_segment
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
    );
  
  
[0m18:28:10.855506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.855648 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.855831 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */

  
    
    

    create  table
      "analytics_dev"."main"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."stg_orders"
),

order_items as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(gross_amount) as gross_order_amount,
        sum(net_amount) as net_order_amount
    from "analytics_dev"."main"."stg_order_items"
    group by order_id
),

customers as (
    select
        *
    from "analytics_dev"."main"."stg_customers"
),

final as (
    select
        o.order_id,
        o.customer_id,
        c.full_name as customer_name,
        c.country as customer_country,
        o.order_date,
        o.order_year,
        o.order_month,
        o.status,
        o.payment_method,
        o.total_amount as order_total_amount,
        oi.total_items,
        oi.gross_order_amount,
        oi.net_order_amount,
        o.is_completed,
        case
            when o.total_amount > 200 then 'Large'
            when o.total_amount > 50 then 'Medium'
            else 'Small'
        end as order_size
    from orders o
    join order_items oi on o.order_id = oi.order_id
    join customers c on o.customer_id = c.customer_id
)

select * from final
    );
  
  
[0m18:28:10.857391 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:28:10.858774 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.858988 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:28:10.859211 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m18:28:10.859387 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:10.860806 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.862302 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.862487 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:28:10.862651 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.862809 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m18:28:10.864082 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.864317 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.864491 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
alter table "analytics_dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:28:10.864683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.865881 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.867326 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.867506 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
alter table "analytics_dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:28:10.867675 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
alter table "analytics_dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m18:28:10.867830 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.870455 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:28:10.870662 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.870829 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:28:10.870978 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: COMMIT
[0m18:28:10.871116 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:28:10.871715 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:28:10.872371 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:28:10.872545 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.872702 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.872859 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.873824 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:28:10.873982 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: COMMIT
[0m18:28:10.874129 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: COMMIT
[0m18:28:10.874275 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_products"} */
drop table if exists "analytics_dev"."main"."dim_products__dbt_backup" cascade
[0m18:28:10.874704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.875849 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:28:10.876021 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.fct_orders"} */
drop table if exists "analytics_dev"."main"."fct_orders__dbt_backup" cascade
[0m18:28:10.876179 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.877122 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:28:10.877289 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.dim_customers"} */
drop table if exists "analytics_dev"."main"."dim_customers__dbt_backup" cascade
[0m18:28:10.877448 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:28:10.877598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:28:10.878230 [debug] [Thread-3 (]: On model.dbt_duckdb_analytics_poc.dim_products: Close
[0m18:28:10.878788 [debug] [Thread-1 (]: On model.dbt_duckdb_analytics_poc.fct_orders: Close
[0m18:28:10.879079 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a443a10>]}
[0m18:28:10.879247 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:28:10.879467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a440110>]}
[0m18:28:10.880343 [debug] [Thread-4 (]: On model.dbt_duckdb_analytics_poc.dim_customers: Close
[0m18:28:10.879770 [info ] [Thread-3 (]: 6 of 8 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.05s]
[0m18:28:10.880636 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.05s]
[0m18:28:10.880924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a442f90>]}
[0m18:28:10.881168 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:28:10.881407 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:28:10.881663 [info ] [Thread-4 (]: 5 of 8 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.05s]
[0m18:28:10.882012 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:28:10.882328 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:28:10.882575 [info ] [Thread-2 (]: 8 of 8 START sql table model main.core_business_metrics ........................ [RUN]
[0m18:28:10.882793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:28:10.882967 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:28:10.884940 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.886189 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:28:10.888277 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.889356 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.889543 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: BEGIN
[0m18:28:10.889711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:28:10.890064 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.890237 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.890492 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */

  
    
    

    create  table
      "analytics_dev"."main"."core_business_metrics__dbt_tmp"
  
    as (
      with orders as (
    select 
        *
    from "analytics_dev"."main"."fct_orders"
),

customers as (
    select
        *
    from "analytics_dev"."main"."dim_customers"
),

products as (
    select
        *
    from "analytics_dev"."main"."dim_products"
),

daily_sales as (
    select
        order_date,
        sum(net_order_amount) as daily_revenue,
        count(distinct order_id) as order_count,
        count(distinct customer_id) as customer_count,
        sum(total_items) as items_sold
    from orders
    where status = 'completed'
    group by order_date
),

country_sales as (
    select
        customer_country,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        count(distinct customer_id) as customer_count,
        sum(net_order_amount) / count(distinct customer_id) as revenue_per_customer
    from orders
    where status = 'completed'
    group by customer_country
),

category_sales as (
    select
        p.category,
        count(distinct o.order_id) as order_count,
        sum(oi.net_amount) as total_revenue,
        sum(oi.quantity) as quantity_sold
    from "analytics_dev"."main"."stg_order_items" oi
    join "analytics_dev"."main"."stg_orders" o on oi.order_id = o.order_id
    join "analytics_dev"."main"."stg_products" p on oi.product_id = p.product_id
    where o.status = 'completed'
    group by p.category
),

payment_method_analysis as (
    select
        payment_method,
        count(distinct order_id) as order_count,
        sum(net_order_amount) as total_revenue,
        avg(net_order_amount) as avg_order_value
    from orders
    where status = 'completed'
    group by payment_method
),

final as (
    select
        'Overall' as metric_group,
        'Total Revenue' as metric_name,
        cast(sum(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Orders' as metric_name,
        cast(count(distinct order_id) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Average Order Value' as metric_name,
        cast(avg(net_order_amount) as varchar) as metric_value
    from orders
    where status = 'completed'
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Customers' as metric_name,
        cast(count(distinct customer_id) as varchar) as metric_value
    from customers
    
    union all
    
    select
        'Overall' as metric_group,
        'Total Products' as metric_name,
        cast(count(distinct product_id) as varchar) as metric_value
    from products
    
    union all
    
    (select
        'Time' as metric_group,
        'Date with Highest Revenue' as metric_name,
        cast(order_date as varchar) as metric_value
    from daily_sales
    order by daily_revenue desc
    limit 1)
    
    union all
    
    (select
        'Geography' as metric_group,
        'Top Country by Revenue' as metric_name,
        customer_country as metric_value
    from country_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Product' as metric_group,
        'Top Category by Revenue' as metric_name,
        category as metric_value
    from category_sales
    order by total_revenue desc
    limit 1)
    
    union all
    
    (select
        'Customer' as metric_group,
        'Top Payment Method' as metric_name,
        payment_method as metric_value
    from payment_method_analysis
    order by order_count desc
    limit 1)
)

select * from final
    );
  
  
[0m18:28:10.898055 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:28:10.899866 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.900062 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
alter table "analytics_dev"."main"."core_business_metrics" rename to "core_business_metrics__dbt_backup"
[0m18:28:10.900455 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.901683 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.901851 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
alter table "analytics_dev"."main"."core_business_metrics__dbt_tmp" rename to "core_business_metrics"
[0m18:28:10.902156 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.902785 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:28:10.902945 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.903086 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: COMMIT
[0m18:28:10.903600 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.905259 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:28:10.905464 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "model.dbt_duckdb_analytics_poc.core_business_metrics"} */
drop table if exists "analytics_dev"."main"."core_business_metrics__dbt_backup" cascade
[0m18:28:10.905966 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:28:10.906744 [debug] [Thread-2 (]: On model.dbt_duckdb_analytics_poc.core_business_metrics: Close
[0m18:28:10.907063 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b625-7895-4f32-8709-244e3a7405d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a442450>]}
[0m18:28:10.907371 [info ] [Thread-2 (]: 8 of 8 OK created sql table model main.core_business_metrics ................... [[32mOK[0m in 0.02s]
[0m18:28:10.907631 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:28:10.908294 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:10.908467 [debug] [MainThread]: On master: BEGIN
[0m18:28:10.908594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:10.908843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:10.908976 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.909099 [debug] [MainThread]: Using duckdb connection "master"
[0m18:28:10.909210 [debug] [MainThread]: On master: COMMIT
[0m18:28:10.909372 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:28:10.909494 [debug] [MainThread]: On master: Close
[0m18:28:10.909655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:10.909770 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.fct_orders' was properly closed.
[0m18:28:10.909880 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m18:28:10.909987 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_customers' was properly closed.
[0m18:28:10.910087 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.dim_products' was properly closed.
[0m18:28:10.910250 [info ] [MainThread]: 
[0m18:28:10.910388 [info ] [MainThread]: Finished running 4 table models, 4 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:28:10.911070 [debug] [MainThread]: Command end result
[0m18:28:10.928487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:28:10.930785 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:28:10.934860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:28:10.935065 [info ] [MainThread]: 
[0m18:28:10.935312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:10.935517 [info ] [MainThread]: 
[0m18:28:10.935665 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:28:10.937353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6250111, "process_in_blocks": "0", "process_kernel_time": 0.376573, "process_mem_max_rss": "178978816", "process_out_blocks": "0", "process_user_time": 2.080971}
[0m18:28:10.937622 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:10.937575 after 1.63 seconds
[0m18:28:10.937821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0961b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a097410>]}
[0m18:28:10.938013 [debug] [MainThread]: Flushing usage events
[0m18:28:11.560406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:36.189659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bc50>]}


============================== 18:39:36.193489 | 2478b60b-4163-4e17-b125-21bbf7756fd1 ==============================
[0m18:39:36.193489 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:39:36.193831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:39:36.369028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cecc30>]}
[0m18:39:36.396293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8a360>]}
[0m18:39:36.399533 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:39:36.461587 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:39:36.575880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:39:36.576116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:39:36.608158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3250>]}
[0m18:39:36.663804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:39:36.667622 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:39:36.686345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdf890>]}
[0m18:39:36.686640 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:39:36.687002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8e5f0>]}
[0m18:39:36.688587 [info ] [MainThread]: 
[0m18:39:36.688787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:39:36.688924 [info ] [MainThread]: 
[0m18:39:36.689179 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:39:36.691894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:39:36.693107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:39:36.773189 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:39:36.773450 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:39:36.773654 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:39:36.773814 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:39:36.773972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:36.774116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:36.825916 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m18:39:36.826183 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m18:39:36.826348 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:39:36.826503 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:39:36.826660 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:39:36.826822 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:39:36.837100 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:39:36.837291 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:39:36.838181 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:39:36.838832 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:39:36.840361 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:39:36.840519 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:39:36.840766 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:39:36.840904 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:39:36.841986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2478b60b-4163-4e17-b125-21bbf7756fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124c80>]}
[0m18:39:36.844210 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:39:36.844421 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:39:36.844599 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:39:36.844765 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:39:36.844991 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m18:39:36.845212 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m18:39:36.845398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m18:39:36.845572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m18:39:36.845744 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:39:36.845909 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:39:36.846061 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:39:36.846203 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:39:36.849325 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:39:36.850399 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:39:36.851102 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:39:36.851790 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:39:36.852122 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:39:36.852408 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:39:36.852672 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:39:36.852926 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:39:36.853215 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:39:36.853373 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:39:36.853615 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:39:36.853777 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m18:39:36.853952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m18:39:36.854093 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:39:36.854250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:39:36.854395 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:39:36.854536 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:39:36.854690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:39:36.854833 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:39:36.856349 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:39:36.857432 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:39:36.857597 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:39:36.858612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:39:36.860098 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:39:36.860456 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:39:36.860791 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:39:36.860960 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:39:36.861395 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:39:36.861661 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:39:36.861834 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:39:36.862044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m18:39:36.862325 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:39:36.862589 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:39:36.862790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:39:36.862952 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:39:36.863264 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:39:36.863535 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:39:36.863685 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:39:36.865120 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:39:36.865315 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:39:36.865525 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:39:36.870901 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:39:36.871276 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:39:36.871450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:39:36.871610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:39:36.871823 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:39:36.872017 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:39:36.872168 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:39:36.872329 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:39:36.875439 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:39:36.877156 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:39:36.877345 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:39:36.879326 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:39:36.879573 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:39:36.879878 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:39:36.880040 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:39:36.880258 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:39:36.880567 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:39:36.880716 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:39:36.880869 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:39:36.881030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:39:36.881201 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:39:36.881469 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:39:36.881741 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:39:36.881891 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:39:36.882056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:39:36.882224 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:39:36.882393 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:39:36.884040 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:39:36.884218 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:39:36.884394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:39:36.884579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:39:36.886243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:39:36.886458 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:39:36.886644 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:39:36.890252 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:39:36.891924 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:39:36.892272 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:39:36.892461 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:39:36.892774 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:39:36.893091 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:39:36.893298 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:39:36.893512 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:39:36.893675 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:39:36.893881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:39:36.894036 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:39:36.894250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:39:36.894570 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:39:36.894740 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:39:36.895019 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:39:36.895178 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:39:36.895351 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:39:36.897099 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:39:36.897334 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:39:36.937696 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:39:36.938016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:39:36.938284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:39:36.938576 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:39:36.938745 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:39:36.941075 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:39:36.942855 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:39:36.943733 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:39:36.944058 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:39:36.944236 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:39:36.944395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:39:36.944546 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:39:36.945881 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:39:36.946102 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:39:36.946438 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:39:36.946622 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:39:36.946806 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:39:36.946976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:39:36.947309 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:39:36.947476 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:39:36.947629 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:39:36.947772 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:39:36.947948 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:39:36.949491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:39:36.949828 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:39:36.950114 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:39:36.950291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m18:39:36.950495 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:39:36.950694 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:39:36.950881 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:39:36.951074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:39:36.951251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:39:36.951424 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:39:36.953082 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:39:36.953261 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:39:36.953421 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:39:36.953709 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:39:36.953998 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:39:36.955687 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:39:36.957553 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:39:36.957765 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:39:36.957938 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:39:36.958288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:39:36.958499 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:39:36.958715 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:39:36.958882 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:39:36.959036 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:39:36.959184 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:39:36.961581 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:39:36.963174 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:39:36.963515 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:39:36.963807 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:39:36.964061 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:39:36.964322 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:39:36.964539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m18:39:36.964715 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:39:36.964865 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:39:36.965028 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:39:36.965181 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:39:36.965445 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:39:36.965711 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:39:36.965860 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:39:36.967831 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:39:36.968041 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:39:36.968223 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:39:36.969776 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:39:36.970008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:39:36.970181 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:39:36.970370 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:39:36.970531 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:39:36.971749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:39:36.973177 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:39:36.973383 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:39:36.973538 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:39:36.973911 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:39:36.974192 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:39:36.974414 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:39:36.974605 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:39:36.974853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:39:36.975038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:39:36.975200 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:39:36.975347 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:39:36.975492 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:39:36.975636 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:39:36.975901 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:39:36.976178 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:39:36.977824 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:39:36.979357 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:39:36.979545 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:39:36.979733 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:39:36.979967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:39:36.980185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:39:36.980367 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:39:36.980521 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:39:36.980667 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:39:36.980810 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:39:36.983018 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:39:36.984233 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:39:36.984551 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:39:36.984840 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:39:36.985081 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:39:36.985272 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:39:36.985497 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:39:36.985676 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:39:36.985840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:39:36.985998 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:39:36.986155 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:39:36.986425 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:39:36.986579 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:39:36.986839 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:39:36.988450 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:39:36.988654 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:39:36.990616 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:39:36.990810 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:39:36.991021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:39:36.991231 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:39:36.991405 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:39:36.991567 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:39:36.994028 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:39:36.996184 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:39:36.996526 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:39:36.996833 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:39:36.997002 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:39:36.997181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:39:36.997325 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:39:36.998483 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:39:36.998745 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:39:36.999034 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:39:36.999221 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:39:36.999405 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:39:36.999731 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:39:37.000009 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:39:37.000159 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:39:37.000484 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:39:37.001056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:37.001189 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m18:39:37.001303 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m18:39:37.001410 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m18:39:37.001514 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m18:39:37.003975 [debug] [MainThread]: Command end result
[0m18:39:37.024957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:39:37.028810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:39:37.033869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:39:37.038498 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.9047786, "process_in_blocks": "0", "process_kernel_time": 0.340771, "process_mem_max_rss": "148373504", "process_out_blocks": "0", "process_user_time": 1.314622}
[0m18:39:37.038734 [debug] [MainThread]: Command `dbt compile` succeeded at 18:39:37.038689 after 0.91 seconds
[0m18:39:37.038921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719fee0>]}
[0m18:39:37.039108 [debug] [MainThread]: Flushing usage events
[0m18:39:37.837384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:17.797556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a20c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b40b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b40bc50>]}


============================== 18:40:17.801201 | 5138074e-7a94-4a12-bfc2-2bf4855fbb7d ==============================
[0m18:40:17.801201 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:40:17.801560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --models analytics.customer_analysis', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:17.964982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5138074e-7a94-4a12-bfc2-2bf4855fbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5e8c30>]}
[0m18:40:17.991409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5138074e-7a94-4a12-bfc2-2bf4855fbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b48a360>]}
[0m18:40:17.994879 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:40:18.053645 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:40:18.193829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:40:18.194106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:40:18.229486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5138074e-7a94-4a12-bfc2-2bf4855fbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4d3250>]}
[0m18:40:18.288741 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:40:18.291150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:40:18.312851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5138074e-7a94-4a12-bfc2-2bf4855fbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5e3890>]}
[0m18:40:18.313203 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:40:18.313408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5138074e-7a94-4a12-bfc2-2bf4855fbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b57e5f0>]}
[0m18:40:18.313842 [warn ] [MainThread]: The selection criterion 'analytics.customer_analysis' does not match any enabled nodes
[0m18:40:18.314575 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:40:18.315617 [debug] [MainThread]: Command end result
[0m18:40:18.330867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:40:18.332367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:40:18.343900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:40:18.345613 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6034868, "process_in_blocks": "0", "process_kernel_time": 0.242956, "process_mem_max_rss": "121421824", "process_out_blocks": "0", "process_user_time": 1.045386}
[0m18:40:18.345923 [debug] [MainThread]: Command `dbt compile` succeeded at 18:40:18.345864 after 0.60 seconds
[0m18:40:18.346180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc5fba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbef290>]}
[0m18:40:18.346386 [debug] [MainThread]: Flushing usage events
[0m18:40:18.883392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:24.114643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106964830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bc50>]}


============================== 18:41:24.118577 | a96390ac-8457-4fcc-8e8f-3fc57f617638 ==============================
[0m18:41:24.118577 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:41:24.118922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --models analytics.customer_analysis analytics.product_performance analytics.order_trends_by_time', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:24.294956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a96390ac-8457-4fcc-8e8f-3fc57f617638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e8c30>]}
[0m18:41:24.321458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a96390ac-8457-4fcc-8e8f-3fc57f617638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a360>]}
[0m18:41:24.324195 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:41:24.390640 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:41:24.505280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:24.505536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:24.539976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a96390ac-8457-4fcc-8e8f-3fc57f617638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed3250>]}
[0m18:41:24.594550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:41:24.598466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:41:24.631252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a96390ac-8457-4fcc-8e8f-3fc57f617638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e3890>]}
[0m18:41:24.631595 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 433 macros
[0m18:41:24.631777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a96390ac-8457-4fcc-8e8f-3fc57f617638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11007e5f0>]}
[0m18:41:24.632195 [warn ] [MainThread]: The selection criterion 'analytics.customer_analysis' does not match any enabled nodes
[0m18:41:24.632453 [warn ] [MainThread]: The selection criterion 'analytics.product_performance' does not match any enabled nodes
[0m18:41:24.632765 [warn ] [MainThread]: The selection criterion 'analytics.order_trends_by_time' does not match any enabled nodes
[0m18:41:24.633468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:41:24.634396 [debug] [MainThread]: Command end result
[0m18:41:24.649162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:41:24.651152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:41:24.653324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:41:24.655288 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6021589, "process_in_blocks": "0", "process_kernel_time": 0.237549, "process_mem_max_rss": "121470976", "process_out_blocks": "0", "process_user_time": 1.020516}
[0m18:41:24.655566 [debug] [MainThread]: Command `dbt compile` succeeded at 18:41:24.655509 after 0.60 seconds
[0m18:41:24.655817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185fba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107ef290>]}
[0m18:41:24.656032 [debug] [MainThread]: Flushing usage events
[0m18:41:25.287513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:23.302879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b0c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0fc50>]}


============================== 18:44:23.306486 | 61e44684-4eec-420e-8746-8eaf102ef6ac ==============================
[0m18:44:23.306486 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:44:23.306853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --models analyses.customer_analysis analyses.product_performance analyses.order_trends_by_time', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:44:23.504971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61e44684-4eec-420e-8746-8eaf102ef6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e8c30>]}
[0m18:44:23.532737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61e44684-4eec-420e-8746-8eaf102ef6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8a360>]}
[0m18:44:23.545077 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:44:23.609333 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:44:23.741423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m18:44:23.741883 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/schema.yml
[0m18:44:23.742060 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/revenue_trends.sql
[0m18:44:23.742207 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/customer_analysis.sql
[0m18:44:23.742342 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/order_trends_by_time.sql
[0m18:44:23.742477 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/customer_orders_analysis.sql
[0m18:44:23.742604 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/product_performance.sql
[0m18:44:23.887418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e44684-4eec-420e-8746-8eaf102ef6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35bb50>]}
[0m18:44:23.958901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:44:23.960703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:44:24.012539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e44684-4eec-420e-8746-8eaf102ef6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620b4d0>]}
[0m18:44:24.012902 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:44:24.013091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e44684-4eec-420e-8746-8eaf102ef6ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a509550>]}
[0m18:44:24.013525 [warn ] [MainThread]: The selection criterion 'analyses.customer_analysis' does not match any enabled nodes
[0m18:44:24.013794 [warn ] [MainThread]: The selection criterion 'analyses.product_performance' does not match any enabled nodes
[0m18:44:24.014037 [warn ] [MainThread]: The selection criterion 'analyses.order_trends_by_time' does not match any enabled nodes
[0m18:44:24.014689 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:44:24.014963 [debug] [MainThread]: Command end result
[0m18:44:24.031121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:44:24.034209 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:44:24.036245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:44:24.038481 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.79327494, "process_in_blocks": "0", "process_kernel_time": 0.257897, "process_mem_max_rss": "122961920", "process_out_blocks": "0", "process_user_time": 1.172045}
[0m18:44:24.038690 [debug] [MainThread]: Command `dbt compile` succeeded at 18:44:24.038648 after 0.79 seconds
[0m18:44:24.038888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a607c50>]}
[0m18:44:24.039056 [debug] [MainThread]: Flushing usage events
[0m18:44:25.609753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:07.131809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bc50>]}


============================== 18:45:07.135771 | ed61b04a-e559-4dda-82c6-5c3028cfbdaf ==============================
[0m18:45:07.135771 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:45:07.136144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile --select analyses.*', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:07.325724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed61b04a-e559-4dda-82c6-5c3028cfbdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8c30>]}
[0m18:45:07.356528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed61b04a-e559-4dda-82c6-5c3028cfbdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8a360>]}
[0m18:45:07.362014 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:45:07.428783 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:45:07.574984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:07.575269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:07.615026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed61b04a-e559-4dda-82c6-5c3028cfbdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecf750>]}
[0m18:45:07.684084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:45:07.686762 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:45:07.734444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed61b04a-e559-4dda-82c6-5c3028cfbdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe3890>]}
[0m18:45:07.735011 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:45:07.735588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed61b04a-e559-4dda-82c6-5c3028cfbdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7e0b0>]}
[0m18:45:07.736197 [warn ] [MainThread]: The selection criterion 'analyses.*' does not match any enabled nodes
[0m18:45:07.737759 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:45:07.738936 [debug] [MainThread]: Command end result
[0m18:45:07.754653 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:45:07.756073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:45:07.758287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:45:07.760264 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6902601, "process_in_blocks": "0", "process_kernel_time": 0.297323, "process_mem_max_rss": "121421824", "process_out_blocks": "0", "process_user_time": 1.148652}
[0m18:45:07.760579 [debug] [MainThread]: Command `dbt compile` succeeded at 18:45:07.760524 after 0.69 seconds
[0m18:45:07.760789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11057fba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110357950>]}
[0m18:45:07.760968 [debug] [MainThread]: Flushing usage events
[0m18:45:08.303125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:34.541337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040bc50>]}


============================== 18:45:34.545502 | 34f2e3a8-3979-45aa-ab72-a6c9218f7ed7 ==============================
[0m18:45:34.545502 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:45:34.545847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select analyses:customer_analysis', 'send_anonymous_usage_stats': 'True'}
[0m18:45:34.720013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f2e3a8-3979-45aa-ab72-a6c9218f7ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e8c30>]}
[0m18:45:34.749307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f2e3a8-3979-45aa-ab72-a6c9218f7ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11048a360>]}
[0m18:45:34.752580 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:45:34.822783 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:45:34.959159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:34.959448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:35.000126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f2e3a8-3979-45aa-ab72-a6c9218f7ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d3750>]}
[0m18:45:35.064733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:45:35.067290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:45:35.086877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f2e3a8-3979-45aa-ab72-a6c9218f7ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e3890>]}
[0m18:45:35.087220 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:45:35.087409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f2e3a8-3979-45aa-ab72-a6c9218f7ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11057e0b0>]}
[0m18:45:35.087722 [error] [MainThread]: Encountered an error:
Runtime Error
  'analyses' is not a valid method name
[0m18:45:35.090744 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.62630105, "process_in_blocks": "0", "process_kernel_time": 0.284514, "process_mem_max_rss": "119439360", "process_out_blocks": "0", "process_user_time": 1.106885}
[0m18:45:35.091004 [debug] [MainThread]: Command `dbt compile` failed at 18:45:35.090956 after 0.63 seconds
[0m18:45:35.091203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac9cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110957710>]}
[0m18:45:35.091382 [debug] [MainThread]: Flushing usage events
[0m18:45:35.672350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:57.828617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0bc50>]}


============================== 18:45:57.835162 | 50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b ==============================
[0m18:45:57.835162 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:45:57.835504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select analysis:customer_analysis', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:58.028288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee8c30>]}
[0m18:45:58.057218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd8a360>]}
[0m18:45:58.060631 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:45:58.123371 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:45:58.273854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:58.274131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:58.314797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd3750>]}
[0m18:45:58.381654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:45:58.384897 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:45:58.412102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee3890>]}
[0m18:45:58.412531 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:45:58.412811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50afbe59-6bfc-4a5c-a6a2-e9e9b6f2e30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7e0b0>]}
[0m18:45:58.413171 [error] [MainThread]: Encountered an error:
Runtime Error
  'analysis' is not a valid method name
[0m18:45:58.415213 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.65508395, "process_in_blocks": "0", "process_kernel_time": 0.291469, "process_mem_max_rss": "114671616", "process_out_blocks": "0", "process_user_time": 1.121228}
[0m18:45:58.415433 [debug] [MainThread]: Command `dbt compile` failed at 18:45:58.415375 after 0.66 seconds
[0m18:45:58.415626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c157710>]}
[0m18:45:58.415782 [debug] [MainThread]: Flushing usage events
[0m18:45:59.013556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:11.841131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580bc50>]}


============================== 18:46:11.849689 | db5ade9b-4770-423d-a3fc-111aa15810d3 ==============================
[0m18:46:11.849689 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:46:11.850325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:46:12.108110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cecc30>]}
[0m18:46:12.142478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588a360>]}
[0m18:46:12.147877 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:46:12.252991 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:46:13.133264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:13.245327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:13.290278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d3750>]}
[0m18:46:13.490389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:46:13.496260 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:46:13.525928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce3890>]}
[0m18:46:13.526330 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:46:13.526530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7e0b0>]}
[0m18:46:13.530728 [info ] [MainThread]: 
[0m18:46:13.531167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:13.531323 [info ] [MainThread]: 
[0m18:46:13.531653 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:46:13.535367 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:46:13.537369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:46:13.621134 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:46:13.621434 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:46:13.621615 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:46:13.621805 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:46:13.621998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:13.622140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:13.717116 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m18:46:13.717390 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m18:46:13.717567 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:46:13.717733 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:46:13.717899 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:46:13.718071 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:46:13.733534 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:46:13.733860 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:46:13.734735 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:46:13.735558 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:46:13.737111 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:46:13.737312 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:46:13.737891 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:46:13.738083 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:46:13.739153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5ade9b-4770-423d-a3fc-111aa15810d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062742c0>]}
[0m18:46:13.741651 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:46:13.741890 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:46:13.742069 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:46:13.742229 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:46:13.742479 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m18:46:13.742708 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m18:46:13.742900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m18:46:13.743109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m18:46:13.743310 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:46:13.743467 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:46:13.743639 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:46:13.743802 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:46:13.747200 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:46:13.748883 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:46:13.749827 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:46:13.750695 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:46:13.751171 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:46:13.751533 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:46:13.751898 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:46:13.752227 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:46:13.752689 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:46:13.753034 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:46:13.753430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m18:46:13.753660 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:46:13.753865 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:46:13.754077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m18:46:13.754259 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:46:13.754435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:46:13.754617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:46:13.754799 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:46:13.756997 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:46:13.757303 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:46:13.757492 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:46:13.758820 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:46:13.760369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:46:13.762244 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:46:13.762696 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:46:13.763118 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:46:13.763463 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:46:13.763648 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:46:13.763953 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:46:13.764187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:46:13.764384 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:46:13.764563 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:46:13.764741 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:46:13.764901 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:46:13.765396 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:46:13.765779 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:46:13.765995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:46:13.772581 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:46:13.772983 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:46:13.773297 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:46:13.773674 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:46:13.773994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:46:13.774292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m18:46:13.776367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:46:13.776624 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:46:13.776830 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:46:13.777020 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:46:13.780140 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:46:13.781610 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:46:13.781992 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:46:13.782445 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:46:13.782669 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:46:13.782953 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:46:13.783264 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:46:13.783664 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:46:13.783843 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:46:13.784045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:46:13.784244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:46:13.784445 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:46:13.784755 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:46:13.784917 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:46:13.785084 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:46:13.785262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:46:13.785444 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:46:13.789211 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:46:13.791330 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:46:13.791572 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:46:13.791873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:46:13.793825 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:46:13.794095 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:46:13.842208 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:46:13.844134 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:46:13.844804 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:46:13.845079 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:46:13.845340 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:46:13.845643 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:46:13.845972 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:46:13.846291 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:46:13.846571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:46:13.846799 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:46:13.847002 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:46:13.847213 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:46:13.847417 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:46:13.847856 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:46:13.848078 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:46:13.848278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:46:13.850338 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:46:13.850576 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:46:13.850758 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:46:13.850915 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:46:13.851122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:46:13.853295 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:46:13.857217 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:46:13.857502 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:46:13.857771 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:46:13.860758 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:46:13.861212 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:46:13.861560 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:46:13.861772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:46:13.861948 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:46:13.863874 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:46:13.864139 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:46:13.864356 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:46:13.864914 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:46:13.865212 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:46:13.865368 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:46:13.865573 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:46:13.865765 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:46:13.865937 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:46:13.866214 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:46:13.866399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:46:13.866575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:46:13.866872 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:46:13.867051 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:46:13.867215 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:46:13.867366 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:46:13.867541 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:46:13.867713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m18:46:13.869363 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:46:13.870830 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:46:13.871109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:46:13.871377 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:46:13.871653 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:46:13.873919 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:46:13.875745 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:46:13.876152 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:46:13.876401 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:46:13.876616 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:46:13.876789 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:46:13.876974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:46:13.877292 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:46:13.877614 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:46:13.877782 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:46:13.877961 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:46:13.878197 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:46:13.878447 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:46:13.880901 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:46:13.881407 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:46:13.881621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:46:13.881804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:46:13.882033 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:46:13.882243 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:46:13.882440 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:46:13.882642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m18:46:13.885257 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:46:13.887325 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:46:13.887565 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:46:13.887747 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:46:13.889788 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:46:13.890149 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:46:13.890418 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:46:13.890589 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:46:13.890773 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:46:13.890945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:46:13.891222 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:46:13.891491 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:46:13.891639 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:46:13.891810 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:46:13.891984 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:46:13.893559 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:46:13.893739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:46:13.893923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:46:13.894132 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:46:13.894360 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:46:13.894566 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:46:13.896026 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:46:13.896471 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:46:13.897992 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:46:13.898207 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:46:13.898408 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:46:13.898752 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:46:13.898940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:46:13.899119 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:46:13.899280 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:46:13.899441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:46:13.901066 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:46:13.901254 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:46:13.902883 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:46:13.904034 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:46:13.904392 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:46:13.904617 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:46:13.904810 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:46:13.904979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m18:46:13.905151 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:46:13.905304 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:46:13.905584 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:46:13.905750 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:46:13.906015 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:46:13.906276 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:46:13.906446 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:46:13.908329 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m18:46:13.908538 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:46:13.908723 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:46:13.908903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m18:46:13.909108 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m18:46:13.909278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m18:46:13.909433 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:46:13.909583 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:46:13.909725 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:46:13.911299 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m18:46:13.912721 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m18:46:13.914645 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m18:46:13.914963 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:46:13.915299 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:46:13.915464 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:46:13.915647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m18:46:13.915803 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:46:13.917229 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m18:46:13.917638 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:46:13.917932 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:46:13.918109 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:46:13.918278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:46:13.918465 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:46:13.920441 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:46:13.920690 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:46:13.920910 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:46:13.921246 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:46:13.921584 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:46:13.921773 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:46:13.921980 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:46:13.922154 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:46:13.922331 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:46:13.922642 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:46:13.922841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:46:13.923144 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:46:13.923325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:46:13.923513 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:46:13.923697 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:46:13.923887 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:46:13.924059 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:46:13.924228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:46:13.926126 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:46:13.926334 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:46:13.928165 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:46:13.928402 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:46:13.928663 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:46:13.931034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:46:13.933328 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:46:13.933721 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:46:13.934060 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:46:13.934232 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:46:13.934415 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:46:13.934634 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:46:13.934904 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:46:13.935083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:46:13.935251 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:46:13.935509 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:46:13.935674 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:46:13.935852 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:46:13.936205 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:46:13.936483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:46:13.938262 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:46:13.938556 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:46:13.940295 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:46:13.945650 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:46:13.946094 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:46:13.946269 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:46:13.946663 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:46:13.947270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:13.947421 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m18:46:13.947544 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m18:46:13.947658 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m18:46:13.947769 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m18:46:13.950356 [debug] [MainThread]: Command end result
[0m18:46:13.969129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:46:13.970947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:46:13.975565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:46:13.977366 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.8607194, "process_in_blocks": "0", "process_kernel_time": 0.619695, "process_mem_max_rss": "144834560", "process_out_blocks": "0", "process_user_time": 1.752188}
[0m18:46:13.977613 [debug] [MainThread]: Command `dbt compile` succeeded at 18:46:13.977567 after 2.86 seconds
[0m18:46:13.977824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105723540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233e30>]}
[0m18:46:13.978074 [debug] [MainThread]: Flushing usage events
[0m18:46:14.487029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:34.897625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114214830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11550f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11550fc50>]}


============================== 18:47:34.905243 | 298562df-d342-4d2c-bdb4-e164215226bd ==============================
[0m18:47:34.905243 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:47:34.905722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:47:35.078908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e8c30>]}
[0m18:47:35.108600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11558a360>]}
[0m18:47:35.118244 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m18:47:35.181433 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:47:35.365771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:47:35.366093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:47:35.407028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155d3750>]}
[0m18:47:35.473020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:47:35.475088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:47:35.493078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e3890>]}
[0m18:47:35.493384 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m18:47:35.493564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11567e0b0>]}
[0m18:47:35.495183 [info ] [MainThread]: 
[0m18:47:35.495397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:35.495526 [info ] [MainThread]: 
[0m18:47:35.495800 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:47:35.498720 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m18:47:35.498986 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m18:47:35.579150 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:47:35.579426 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:47:35.579594 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m18:47:35.579754 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m18:47:35.579898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:35.580030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:35.628099 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m18:47:35.628441 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m18:47:35.628680 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m18:47:35.628892 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m18:47:35.629079 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:47:35.629271 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m18:47:35.640009 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:47:35.640311 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:47:35.641335 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m18:47:35.642046 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m18:47:35.643289 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m18:47:35.643636 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m18:47:35.643840 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m18:47:35.644027 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m18:47:35.645355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '298562df-d342-4d2c-bdb4-e164215226bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d782c0>]}
[0m18:47:35.647836 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:47:35.648069 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:47:35.648266 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:47:35.648438 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:47:35.648716 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m18:47:35.648957 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m18:47:35.649180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m18:47:35.649370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m18:47:35.649546 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:47:35.649707 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:47:35.649867 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:47:35.650016 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:47:35.653416 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:47:35.654779 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:47:35.655613 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:47:35.656505 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:47:35.656922 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m18:47:35.657211 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m18:47:35.657475 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m18:47:35.657738 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m18:47:35.658058 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:47:35.658417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m18:47:35.658606 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:47:35.660361 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m18:47:35.660580 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:47:35.660792 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:47:35.660936 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:47:35.661177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_products)
[0m18:47:35.661475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m18:47:35.661682 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m18:47:35.661878 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m18:47:35.662035 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:47:35.662260 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:47:35.663560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m18:47:35.663757 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:47:35.664938 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m18:47:35.666571 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m18:47:35.667009 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m18:47:35.667460 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:47:35.667672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m18:47:35.667899 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:47:35.673402 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m18:47:35.673798 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:47:35.673988 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m18:47:35.674161 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:47:35.674513 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m18:47:35.674857 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m18:47:35.675159 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m18:47:35.675323 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:47:35.675525 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:47:35.675745 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:47:35.675990 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:47:35.676317 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m18:47:35.676593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:47:35.676766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m18:47:35.676942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m18:47:35.677134 [debug] [Thread-3 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:47:35.677310 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:47:35.677480 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:47:35.677651 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:47:35.677843 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m18:47:35.680186 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:47:35.683073 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m18:47:35.684384 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m18:47:35.684571 [debug] [Thread-3 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:47:35.688150 [debug] [Thread-3 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:47:35.688524 [debug] [Thread-3 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m18:47:35.688712 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:47:35.688885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:47:35.689052 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:47:35.690770 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:47:35.691064 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:47:35.691245 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:47:35.691410 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:47:35.691752 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m18:47:35.692090 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m18:47:35.692365 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m18:47:35.692549 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:47:35.692706 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:47:35.692890 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:47:35.693090 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:47:35.693272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m18:47:35.693546 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:47:35.693722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m18:47:35.693891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m18:47:35.694062 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:47:35.694235 [debug] [Thread-3 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:47:35.694401 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:47:35.694546 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:47:35.696242 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m18:47:35.696439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m18:47:35.738233 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m18:47:35.740029 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m18:47:35.740339 [debug] [Thread-3 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:47:35.742117 [debug] [Thread-3 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:47:35.742538 [debug] [Thread-3 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m18:47:35.742889 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:47:35.743107 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:47:35.743353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m18:47:35.743553 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:47:35.743858 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m18:47:35.744026 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:47:35.744192 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:47:35.744478 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m18:47:35.744639 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:47:35.744934 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m18:47:35.746717 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m18:47:35.746930 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:47:35.747125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m18:47:35.747305 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:47:35.747511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now model.dbt_duckdb_analytics_poc.dim_products)
[0m18:47:35.747681 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:47:35.747843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m18:47:35.748011 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m18:47:35.749673 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m18:47:35.749867 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:47:35.750026 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:47:35.751730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m18:47:35.753126 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m18:47:35.753452 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m18:47:35.753749 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:47:35.753943 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:47:35.754119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m18:47:35.754415 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m18:47:35.754598 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:47:35.754763 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m18:47:35.754922 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:47:35.755067 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:47:35.756692 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m18:47:35.756988 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m18:47:35.757166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m18:47:35.757455 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m18:47:35.757652 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:47:35.757848 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:47:35.758063 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:47:35.758259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m18:47:35.760213 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m18:47:35.760413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m18:47:35.760596 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:47:35.760804 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:47:35.760964 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:47:35.762663 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m18:47:35.765272 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m18:47:35.765631 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m18:47:35.765858 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:47:35.766026 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:47:35.766342 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m18:47:35.766538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m18:47:35.766742 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:47:35.766913 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:47:35.767080 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:47:35.767245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m18:47:35.767397 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:47:35.769744 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m18:47:35.770049 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m18:47:35.770203 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:47:35.770462 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m18:47:35.770662 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:47:35.772235 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m18:47:35.772423 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:47:35.772624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m18:47:35.772827 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:47:35.773004 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:47:35.773155 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:47:35.773309 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:47:35.773596 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m18:47:35.775013 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m18:47:35.776940 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:47:35.777177 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:47:35.777399 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:47:35.777840 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m18:47:35.778031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:47:35.778222 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:47:35.778392 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:47:35.778609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m18:47:35.780375 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:47:35.780568 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:47:35.780726 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:47:35.780879 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:47:35.782848 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m18:47:35.783178 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:47:35.783471 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m18:47:35.783697 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:47:35.783894 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:47:35.784093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m18:47:35.784268 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:47:35.784425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m18:47:35.784598 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:47:35.784746 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:47:35.785009 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:47:35.785167 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:47:35.786813 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m18:47:35.787119 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m18:47:35.787307 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:47:35.788364 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m18:47:35.788578 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:47:35.788776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m18:47:35.788965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m18:47:35.789115 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:47:35.789269 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:47:35.790863 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m18:47:35.792392 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m18:47:35.792677 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:47:35.792843 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:47:35.793160 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m18:47:35.793469 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m18:47:35.793647 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:47:35.793795 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:47:35.793944 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:47:35.794130 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:47:35.794307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m18:47:35.794576 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m18:47:35.794834 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m18:47:35.794991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m18:47:35.795141 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:47:35.795299 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:47:35.795486 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:47:35.795646 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:47:35.796854 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m18:47:35.797031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m18:47:35.797204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m18:47:35.798859 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m18:47:35.799055 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:47:35.799214 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:47:35.800664 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m18:47:35.802586 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m18:47:35.802864 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:47:35.803210 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m18:47:35.803366 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:47:35.803545 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:47:35.803856 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m18:47:35.804036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m18:47:35.804221 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:47:35.804445 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:47:35.804601 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:47:35.804740 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:47:35.804902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:47:35.806382 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m18:47:35.806673 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m18:47:35.806942 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m18:47:35.807091 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:47:35.807275 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:47:35.807453 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:47:35.809061 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:47:35.809247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m18:47:35.809420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m18:47:35.809608 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:47:35.809758 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:47:35.809914 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:47:35.811710 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m18:47:35.812024 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m18:47:35.812176 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:47:35.814158 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m18:47:35.814395 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:47:35.814715 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m18:47:35.814920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m18:47:35.815093 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:47:35.815264 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:47:35.815469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m18:47:35.815626 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:47:35.817191 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m18:47:35.817361 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:47:35.817498 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:47:35.817768 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m18:47:35.818058 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m18:47:35.819393 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m18:47:35.820170 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:47:35.820461 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m18:47:35.820692 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:47:35.820964 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m18:47:35.821630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:35.821785 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m18:47:35.821906 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m18:47:35.822021 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m18:47:35.822135 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m18:47:35.824895 [debug] [MainThread]: Command end result
[0m18:47:35.851191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m18:47:35.853564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m18:47:35.858516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m18:47:35.861857 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0336689, "process_in_blocks": "0", "process_kernel_time": 0.427347, "process_mem_max_rss": "148996096", "process_out_blocks": "0", "process_user_time": 1.519997}
[0m18:47:35.862126 [debug] [MainThread]: Command `dbt compile` succeeded at 18:47:35.862080 after 1.03 seconds
[0m18:47:35.862321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d27e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11622d650>]}
[0m18:47:35.862498 [debug] [MainThread]: Flushing usage events
[0m18:47:36.436621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:50.097496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb3c50>]}


============================== 20:01:50.100955 | 1a6217f0-a5cd-4f86-b9b6-4758dd2520df ==============================
[0m20:01:50.100955 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:01:50.101313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation run_query --args {query: "SELECT * FROM analytics.customer_orders_analysis LIMIT 10"}', 'send_anonymous_usage_stats': 'True'}
[0m20:01:50.274557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a6217f0-a5cd-4f86-b9b6-4758dd2520df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194c30>]}
[0m20:01:50.301258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a6217f0-a5cd-4f86-b9b6-4758dd2520df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036360>]}
[0m20:01:50.306727 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:01:50.364319 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:01:50.492363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:50.492606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:50.529466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a6217f0-a5cd-4f86-b9b6-4758dd2520df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707f750>]}
[0m20:01:50.590609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:01:50.592697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:01:50.610278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a6217f0-a5cd-4f86-b9b6-4758dd2520df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071936b0>]}
[0m20:01:50.610528 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:01:50.610701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6217f0-a5cd-4f86-b9b6-4758dd2520df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129710>]}
[0m20:01:50.610999 [debug] [MainThread]: Acquiring new duckdb connection 'macro_run_query'
[0m20:01:50.611174 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m20:01:50.611307 [debug] [MainThread]: On macro_run_query: BEGIN
[0m20:01:50.611423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:50.742240 [debug] [MainThread]: SQL status: OK in 0.131 seconds
[0m20:01:50.742512 [debug] [MainThread]: On macro_run_query: COMMIT
[0m20:01:50.742678 [debug] [MainThread]: Using duckdb connection "macro_run_query"
[0m20:01:50.742818 [debug] [MainThread]: On macro_run_query: COMMIT
[0m20:01:50.743042 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:01:50.745935 [debug] [MainThread]: On macro_run_query: Close
[0m20:01:50.746373 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'
[0m20:01:50.750621 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 412, in exception_handler
    yield
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
        f"macro {self.name!r} takes no keyword argument {next(iter(kwargs))!r}"
    )
TypeError: macro 'dbt_macro__run_query' takes no keyword argument 'query'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 387, in call_macro
    with self.exception_handler():
         ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/venv/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 414, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__run_query' takes no keyword argument 'query'

[0m20:01:50.754878 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:01:50.756424 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.71500856, "process_in_blocks": "0", "process_kernel_time": 0.335084, "process_mem_max_rss": "136740864", "process_out_blocks": "0", "process_user_time": 1.119517}
[0m20:01:50.756674 [debug] [MainThread]: Command `dbt run-operation` failed at 20:01:50.756621 after 0.72 seconds
[0m20:01:50.756863 [debug] [MainThread]: Connection 'macro_run_query' was properly closed.
[0m20:01:50.757026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e66990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413710>]}
[0m20:01:50.757188 [debug] [MainThread]: Flushing usage events
[0m20:01:51.423009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:37.620669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11830b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11830bc50>]}


============================== 20:03:37.625301 | 9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0 ==============================
[0m20:03:37.625301 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:03:37.625713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m20:03:37.821586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185e8c30>]}
[0m20:03:37.850517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11838a360>]}
[0m20:03:37.853803 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:03:37.912639 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:03:38.047575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:38.047901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:38.088332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183d3750>]}
[0m20:03:38.154020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:03:38.157259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:03:38.177373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185e3890>]}
[0m20:03:38.177704 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:03:38.177884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11857e0b0>]}
[0m20:03:38.179509 [info ] [MainThread]: 
[0m20:03:38.179704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:38.179836 [info ] [MainThread]: 
[0m20:03:38.180092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:03:38.183132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:03:38.183500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:03:38.251340 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:03:38.251712 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:03:38.251925 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:03:38.252183 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:03:38.252374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:38.252516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:38.372487 [debug] [ThreadPool]: SQL status: OK in 0.120 seconds
[0m20:03:38.372766 [debug] [ThreadPool]: SQL status: OK in 0.120 seconds
[0m20:03:38.372982 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:03:38.373145 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:03:38.373306 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:03:38.373470 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:03:38.393219 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:03:38.394289 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:03:38.394564 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:03:38.395680 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:03:38.396577 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:03:38.396888 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:03:38.397048 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:03:38.397261 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:03:38.398576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c99c651-b7d0-4b41-bcbc-9a9b8416f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b702c0>]}
[0m20:03:38.401125 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:03:38.401355 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:03:38.401529 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:03:38.401690 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:03:38.401897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:03:38.402145 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m20:03:38.402359 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:03:38.402568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m20:03:38.402787 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:03:38.402966 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:03:38.403149 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:03:38.403313 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:03:38.406698 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:03:38.407995 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:03:38.408870 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:03:38.409739 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:03:38.410226 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:03:38.410584 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:03:38.410899 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:03:38.411210 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:03:38.411564 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:03:38.411719 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:03:38.411867 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:03:38.412084 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:03:38.412240 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:03:38.412406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:03:38.412575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:03:38.412728 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:03:38.412871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:03:38.413021 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:03:38.413161 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:03:38.414966 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:03:38.415202 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:03:38.416612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:03:38.417884 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:03:38.419347 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:03:38.420122 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:03:38.420474 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:03:38.420692 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:03:38.420993 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:03:38.421253 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:03:38.421461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:03:38.421626 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:03:38.427292 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:03:38.427572 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:03:38.427742 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:03:38.428001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:03:38.428189 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:03:38.428480 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:03:38.428631 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:03:38.428918 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:03:38.429090 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:03:38.430932 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:03:38.431254 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:03:38.431471 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:03:38.432159 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:03:38.432487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:03:38.432695 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:03:38.433069 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:03:38.433255 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:03:38.436314 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:03:38.436575 [debug] [Thread-3 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:03:38.436747 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:03:38.438056 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:03:38.438306 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:03:38.438628 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:03:38.438949 [debug] [Thread-3 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:03:38.439207 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:03:38.439408 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:03:38.442995 [debug] [Thread-3 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:03:38.443313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:03:38.443503 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:03:38.443806 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:03:38.444093 [debug] [Thread-3 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:03:38.444260 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:03:38.444591 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:03:38.444781 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:03:38.444993 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:03:38.446778 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:03:38.446980 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:03:38.447190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:03:38.447405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:03:38.447613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:03:38.447826 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:03:38.448008 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:03:38.448165 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:03:38.450117 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:03:38.495508 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:03:38.497445 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:03:38.497704 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:03:38.498305 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:03:38.498614 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:03:38.498909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:03:38.499129 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:03:38.499347 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:03:38.499578 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:03:38.499761 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:03:38.500214 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:03:38.500573 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:03:38.502522 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:03:38.502915 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:03:38.503115 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:03:38.503317 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:03:38.503606 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:03:38.503766 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:03:38.503944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:03:38.504136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:03:38.504324 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:03:38.504498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:03:38.504658 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:03:38.504830 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:03:38.505078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:03:38.505306 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:03:38.507257 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:03:38.508879 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:03:38.509067 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:03:38.511274 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:03:38.512895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:03:38.513262 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:03:38.513439 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:03:38.513795 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:03:38.514122 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:03:38.514322 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:03:38.514499 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:03:38.514685 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:03:38.514833 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:03:38.515013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:03:38.515181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:03:38.515455 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:03:38.515743 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:03:38.515982 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:03:38.516191 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:03:38.516392 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:03:38.516636 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:03:38.518466 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:03:38.520584 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:03:38.520813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:03:38.521013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:03:38.521261 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:03:38.521429 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:03:38.523072 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:03:38.526052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:03:38.526426 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:03:38.526609 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:03:38.526947 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:03:38.527248 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:03:38.527428 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:03:38.527609 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:03:38.527786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:03:38.527960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:03:38.528145 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:03:38.528314 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:03:38.528461 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:03:38.530839 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:03:38.531045 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:03:38.533002 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:03:38.533454 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:03:38.533854 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:03:38.534101 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:03:38.534323 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:03:38.534530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:03:38.534727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:03:38.534899 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:03:38.535057 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:03:38.536814 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:03:38.538465 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:03:38.538880 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:03:38.539206 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:03:38.539381 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:03:38.539559 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:03:38.539717 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:03:38.541575 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:03:38.544971 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:03:38.545368 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:03:38.545616 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:03:38.545796 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:03:38.546060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:03:38.546302 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:03:38.546486 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:03:38.546797 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:03:38.546977 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:03:38.547297 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:03:38.547614 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:03:38.547804 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:03:38.553726 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:03:38.554046 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:03:38.554343 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:03:38.554642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:03:38.555014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:03:38.555341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:03:38.555588 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:03:38.555886 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:03:38.556140 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:03:38.556368 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:03:38.558253 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:03:38.559353 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:03:38.560963 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:03:38.561460 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:03:38.561836 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:03:38.562122 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:03:38.562329 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:03:38.564138 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:03:38.564464 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:03:38.564657 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:03:38.564869 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:03:38.565248 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:03:38.565558 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:03:38.565838 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:03:38.565990 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:03:38.566181 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:03:38.566399 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:03:38.566578 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:03:38.566876 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:03:38.567057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:03:38.567242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:03:38.567414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:03:38.567593 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:03:38.567763 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:03:38.567918 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:03:38.568063 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:03:38.568225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:03:38.569761 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:03:38.571655 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:03:38.573323 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:03:38.573609 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:03:38.575731 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:03:38.576287 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:03:38.576501 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:03:38.576659 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:03:38.577048 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:03:38.577408 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:03:38.577720 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:03:38.577926 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:03:38.578122 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:03:38.578306 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:03:38.578499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:03:38.578689 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:03:38.578873 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:03:38.579050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:03:38.579230 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:03:38.579392 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:03:38.579676 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:03:38.579826 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:03:38.581881 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:03:38.584222 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:03:38.584535 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:03:38.586439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:03:38.586870 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:03:38.587171 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:03:38.590016 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:03:38.593410 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:03:38.593926 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:03:38.594189 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:03:38.594456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:03:38.594655 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:03:38.594885 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:03:38.595059 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:03:38.595441 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:03:38.595667 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:03:38.596050 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:03:38.598095 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:03:38.598385 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:03:38.598743 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:03:38.599072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:03:38.599370 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:03:38.600719 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:03:38.601281 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:03:38.601922 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:03:38.602400 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:03:38.603114 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:03:38.604269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:38.604486 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m20:03:38.604779 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m20:03:38.605106 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b' was properly closed.
[0m20:03:38.605248 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m20:03:38.608531 [debug] [MainThread]: Command end result
[0m20:03:38.632553 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:03:38.634102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:03:38.638738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:03:38.641894 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.077153, "process_in_blocks": "0", "process_kernel_time": 0.436376, "process_mem_max_rss": "146243584", "process_out_blocks": "0", "process_user_time": 1.497424}
[0m20:03:38.642169 [debug] [MainThread]: Command `dbt compile` succeeded at 20:03:38.642119 after 1.08 seconds
[0m20:03:38.642366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b43e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f31650>]}
[0m20:03:38.642553 [debug] [MainThread]: Flushing usage events
[0m20:03:40.211611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:26.730044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f80830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c77c50>]}


============================== 20:05:26.733790 | f100a4fb-d90d-477a-b011-ad7e36c24692 ==============================
[0m20:05:26.733790 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:05:26.734140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:05:26.919686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e8c30>]}
[0m20:05:26.947705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6360>]}
[0m20:05:26.951275 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:05:27.010066 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:05:27.140723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:05:27.141254 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://analyses/customer_orders_analysis.sql
[0m20:05:27.262917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109662d50>]}
[0m20:05:27.325398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:05:27.327735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:05:27.349177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e3890>]}
[0m20:05:27.349488 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:05:27.349660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94e0b0>]}
[0m20:05:27.351241 [info ] [MainThread]: 
[0m20:05:27.351441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:27.351662 [info ] [MainThread]: 
[0m20:05:27.352022 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:05:27.354634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:05:27.355016 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:05:27.419076 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:05:27.419374 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:05:27.419574 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:05:27.419783 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:05:27.419965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:27.420107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:27.524727 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m20:05:27.524998 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m20:05:27.525166 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:05:27.525319 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:05:27.525481 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:05:27.525642 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:05:27.551850 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:05:27.552156 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:05:27.553139 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:05:27.553991 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:05:27.554909 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:05:27.555172 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:05:27.555319 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:05:27.555467 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:05:27.556629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f100a4fb-d90d-477a-b011-ad7e36c24692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa35570>]}
[0m20:05:27.558606 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:05:27.558798 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:05:27.558959 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:05:27.559122 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:05:27.559312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:05:27.559530 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:05:27.559732 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m20:05:27.559936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m20:05:27.560126 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:05:27.560287 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:05:27.560466 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:05:27.560652 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:05:27.563938 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:05:27.602922 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:05:27.603723 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:05:27.604486 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:05:27.604867 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:05:27.605180 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:05:27.605447 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:05:27.605728 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:05:27.606205 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:05:27.606545 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:05:27.606915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:05:27.607117 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:05:27.607275 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:05:27.607453 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:05:27.607619 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:05:27.607791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:05:27.607956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:05:27.608115 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:05:27.609925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:05:27.610183 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:05:27.610337 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:05:27.611718 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:05:27.613012 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:05:27.614447 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:05:27.614805 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:05:27.615134 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:05:27.615386 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:05:27.615554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:05:27.615718 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:05:27.617052 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:05:27.617348 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:05:27.617514 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:05:27.617678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:05:27.617828 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:05:27.623797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:05:27.624286 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:05:27.624630 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:05:27.624826 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:05:27.625000 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:05:27.625157 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:05:27.626978 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:05:27.627495 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:05:27.627957 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:05:27.628191 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:05:27.628375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:05:27.628567 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:05:27.628756 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:05:27.628940 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:05:27.629291 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:05:27.629578 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:05:27.629741 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:05:27.632625 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:05:27.632844 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:05:27.633054 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:05:27.633385 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:05:27.633601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:05:27.633789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:05:27.633971 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:05:27.634179 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:05:27.634343 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:05:27.634492 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:05:27.634642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:05:27.636522 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:05:27.638508 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:05:27.638912 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:05:27.639082 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:05:27.639337 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:05:27.641211 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:05:27.641449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:05:27.642111 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:05:27.642296 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:05:27.642469 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:05:27.646333 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:05:27.646829 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:05:27.647159 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:05:27.647406 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:05:27.647583 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:05:27.647791 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:05:27.648009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:05:27.648371 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:05:27.648572 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:05:27.648746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:05:27.648908 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:05:27.649089 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:05:27.649385 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:05:27.649550 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:05:27.651353 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:05:27.651597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:05:27.651837 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:05:27.653882 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:05:27.654145 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:05:27.654366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:05:27.654689 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:05:27.656368 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:05:27.656577 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:05:27.656735 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:05:27.656906 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:05:27.658568 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:05:27.658881 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:05:27.659070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:05:27.659280 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:05:27.659434 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:05:27.659619 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:05:27.659797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:05:27.660136 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:05:27.660329 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:05:27.662366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:05:27.662588 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:05:27.662811 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:05:27.663195 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:05:27.664825 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:05:27.665044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:05:27.665252 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:05:27.665457 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:05:27.665630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:05:27.667378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:05:27.667558 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:05:27.669899 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:05:27.670132 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:05:27.670312 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:05:27.670691 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:05:27.670980 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:05:27.671143 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:05:27.671357 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:05:27.671577 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:05:27.671800 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:05:27.672104 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:05:27.672311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:05:27.672486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:05:27.672763 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:05:27.672938 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:05:27.673101 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:05:27.673255 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:05:27.673430 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:05:27.673600 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:05:27.675352 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:05:27.678187 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:05:27.678412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:05:27.678644 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:05:27.678951 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:05:27.681616 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:05:27.683214 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:05:27.683510 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:05:27.683857 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:05:27.684042 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:05:27.684258 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:05:27.684579 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:05:27.684742 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:05:27.684921 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:05:27.685104 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:05:27.685319 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:05:27.685693 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:05:27.685886 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:05:27.686194 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:05:27.686405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:05:27.686630 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:05:27.688321 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:05:27.688527 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:05:27.688713 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:05:27.688904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:05:27.689115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:05:27.690779 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:05:27.690971 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:05:27.691172 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:05:27.693074 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:05:27.694736 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:05:27.694916 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:05:27.695262 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:05:27.695664 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:05:27.695999 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:05:27.696243 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:05:27.696422 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:05:27.696638 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:05:27.696795 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:05:27.696996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:05:27.697302 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:05:27.697473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:05:27.697747 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:05:27.697902 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:05:27.698077 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:05:27.698241 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:05:27.698401 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:05:27.699970 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:05:27.700202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:05:27.701551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:05:27.701854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:05:27.702149 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:05:27.702468 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:05:27.706204 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:05:27.708008 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:05:27.708310 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:05:27.708483 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:05:27.708806 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:05:27.709109 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:05:27.709326 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:05:27.709509 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:05:27.709671 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:05:27.709859 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:05:27.710034 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:05:27.710453 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:05:27.710670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:05:27.710876 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:05:27.711241 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:05:27.711428 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:05:27.711607 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:05:27.714245 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:05:27.714464 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:05:27.714685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:05:27.716286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:05:27.716530 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:05:27.716721 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:05:27.716931 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:05:27.718118 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:05:27.720133 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:05:27.720508 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:05:27.720740 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:05:27.721090 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:05:27.721411 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:05:27.721585 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:05:27.721799 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:05:27.721997 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:05:27.722292 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:05:27.722477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:05:27.722655 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:05:27.722816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:05:27.722997 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:05:27.723163 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:05:27.723439 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:05:27.723589 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:05:27.723756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_order_dates, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:05:27.725502 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:05:27.725710 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:05:27.727339 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:05:27.727572 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:05:27.727851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:05:27.730344 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:05:27.730549 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:05:27.732472 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:05:27.732685 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:05:27.732848 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:05:27.733223 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:05:27.733541 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:05:27.733764 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:05:27.734009 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:05:27.734181 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:05:27.734339 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:05:27.734523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:05:27.734701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:05:27.735080 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:05:27.735423 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:05:27.735620 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:05:27.735800 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:05:27.737695 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:05:27.739095 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:05:27.746483 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:05:27.746859 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:05:27.749859 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:05:27.750210 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:05:27.750992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:27.751194 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m20:05:27.751321 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m20:05:27.751431 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m20:05:27.751542 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_price_positive' was properly closed.
[0m20:05:27.754181 [debug] [MainThread]: Command end result
[0m20:05:27.769249 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:05:27.770711 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:05:27.776223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:05:27.780206 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1019708, "process_in_blocks": "0", "process_kernel_time": 0.432987, "process_mem_max_rss": "149618688", "process_out_blocks": "0", "process_user_time": 1.563087}
[0m20:05:27.780492 [debug] [MainThread]: Command `dbt compile` succeeded at 20:05:27.780443 after 1.10 seconds
[0m20:05:27.780706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109488310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948a6d0>]}
[0m20:05:27.780880 [debug] [MainThread]: Flushing usage events
[0m20:05:29.412591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:33.177675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800bc50>]}


============================== 20:09:33.181368 | 95303017-eb72-4e6a-9d3a-97050e2f4be9 ==============================
[0m20:09:33.181368 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:09:33.181832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m20:09:33.345548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e8c30>]}
[0m20:09:33.375504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808a360>]}
[0m20:09:33.378923 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:09:33.437560 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:09:33.566708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:33.567187 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://analyses/product_performance.sql
[0m20:09:33.724102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108663d50>]}
[0m20:09:33.788670 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:09:33.790913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:09:33.811911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880e990>]}
[0m20:09:33.812221 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:09:33.812389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817d7f0>]}
[0m20:09:33.814054 [info ] [MainThread]: 
[0m20:09:33.814253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:33.814388 [info ] [MainThread]: 
[0m20:09:33.814641 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:09:33.817455 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:09:33.822777 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:09:33.924953 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:09:33.925217 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:09:33.925391 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:09:33.925545 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:09:33.925687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:33.925816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:34.031225 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m20:09:34.031530 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:09:34.031703 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m20:09:34.031942 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:09:34.032215 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:09:34.033079 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:09:34.054398 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:09:34.054675 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:09:34.055548 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:09:34.056288 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:09:34.057663 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:09:34.057874 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:09:34.058133 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:09:34.058335 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:09:34.059535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95303017-eb72-4e6a-9d3a-97050e2f4be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b99a50>]}
[0m20:09:34.061963 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:09:34.062175 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:09:34.062349 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:09:34.062515 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:09:34.062799 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m20:09:34.063023 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:09:34.063253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:09:34.063474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m20:09:34.063654 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:09:34.063829 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:09:34.063986 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:09:34.064152 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:09:34.067518 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:09:34.068637 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:09:34.069338 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:09:34.070029 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:09:34.070400 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:09:34.070830 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:09:34.071172 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:09:34.071456 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:09:34.071833 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:09:34.072004 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:09:34.072232 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:09:34.072439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:09:34.072647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:09:34.072805 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:09:34.072976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:09:34.073148 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:09:34.073344 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:09:34.073553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:09:34.073712 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:09:34.075226 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:09:34.076305 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:09:34.076550 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:09:34.077976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:09:34.079695 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:09:34.080117 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:09:34.080476 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:09:34.080745 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:09:34.081030 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:09:34.081308 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:09:34.081508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:09:34.081733 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:09:34.081931 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:09:34.082130 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:09:34.088025 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:09:34.088316 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:09:34.088685 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:09:34.088873 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:09:34.089169 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:09:34.089396 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:09:34.089609 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:09:34.089876 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:09:34.090160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:09:34.092239 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:09:34.092473 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:09:34.092673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:09:34.092874 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:09:34.093194 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:09:34.093482 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:09:34.093638 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:09:34.096613 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:09:34.096871 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:09:34.097097 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:09:34.099142 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:09:34.099546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:09:34.099913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:09:34.100197 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:09:34.100420 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:09:34.102803 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:09:34.104567 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:09:34.105002 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:09:34.105195 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:09:34.105527 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:09:34.105850 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:09:34.106050 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:09:34.106237 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:09:34.106383 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:09:34.106689 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:09:34.107083 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:09:34.107314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:09:34.107655 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:09:34.107841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:09:34.108034 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:09:34.108214 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:09:34.108384 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:09:34.108547 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:09:34.108710 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:09:34.110394 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:09:34.110590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:09:34.112551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:09:34.112739 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:09:34.112931 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:09:34.114590 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:09:34.116852 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:09:34.117107 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:09:34.117494 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:09:34.117673 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:09:34.117857 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:09:34.118092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:09:34.118420 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:09:34.118580 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:09:34.118732 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:09:34.118882 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:09:34.119058 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:09:34.119366 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:09:34.119730 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:09:34.123733 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:09:34.124032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:09:34.124288 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:09:34.124500 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:09:34.124727 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:09:34.124906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:09:34.125095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:09:34.127509 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:09:34.127728 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:09:34.127894 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:09:34.128043 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:09:34.130289 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:09:34.130738 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:09:34.132148 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:09:34.132487 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:09:34.132826 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:09:34.133049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:09:34.133490 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:09:34.133719 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:09:34.133911 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:09:34.134087 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:09:34.134286 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:09:34.135943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:09:34.136311 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:09:34.136591 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:09:34.136789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:09:34.137036 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:09:34.137237 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:09:34.137431 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:09:34.137639 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:09:34.138151 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:09:34.139520 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:09:34.139768 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:09:34.139978 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:09:34.140157 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:09:34.140475 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:09:34.142321 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:09:34.145709 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:09:34.146047 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:09:34.146232 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:09:34.146529 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:09:34.146774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:09:34.147093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:09:34.147296 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:09:34.147454 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:09:34.150151 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:09:34.150390 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:09:34.150626 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:09:34.152605 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:09:34.153084 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:09:34.153452 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:09:34.153695 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:09:34.153911 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:09:34.154142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:09:34.154320 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:09:34.154508 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:09:34.154686 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:09:34.154831 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:09:34.155107 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:09:34.155262 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:09:34.155544 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:09:34.157628 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:09:34.157886 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:09:34.159742 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:09:34.159951 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:09:34.160202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:09:34.160429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:09:34.160604 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:09:34.160762 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:09:34.161957 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:09:34.163437 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:09:34.163707 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:09:34.163888 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:09:34.164221 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:09:34.164613 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:09:34.164834 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:09:34.165055 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:09:34.165305 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:09:34.165682 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:09:34.165872 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:09:34.166104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:09:34.166316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:09:34.166539 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:09:34.166860 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:09:34.167026 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:09:34.167195 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:09:34.167380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:09:34.167559 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:09:34.169625 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:09:34.171611 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:09:34.171867 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:09:34.172073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:09:34.173958 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:09:34.174211 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:09:34.175849 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:09:34.176058 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:09:34.176247 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:09:34.176684 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:09:34.176863 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:09:34.177171 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:09:34.177376 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:09:34.177754 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:09:34.177948 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:09:34.178151 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:09:34.178359 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:09:34.178536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:09:34.178712 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:09:34.178904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:09:34.179068 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:09:34.180516 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:09:34.180716 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:09:34.182563 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:09:34.182826 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:09:34.184797 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:09:34.185276 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:09:34.185522 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:09:34.185744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:09:34.185915 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:09:34.187953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:09:34.188329 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:09:34.188505 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:09:34.188666 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:09:34.188974 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:09:34.189305 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:09:34.189619 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:09:34.189789 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:09:34.190071 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:09:34.190304 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:09:34.190544 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:09:34.190897 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:09:34.191101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:09:34.191283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:09:34.191453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:09:34.191628 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:09:34.191801 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:09:34.191951 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:09:34.192093 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:09:34.192252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:09:34.193966 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:09:34.195690 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:09:34.197537 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:09:34.197756 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:09:34.200334 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:09:34.200805 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:09:34.201047 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:09:34.201239 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:09:34.201602 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:09:34.201902 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:09:34.202200 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:09:34.202423 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:09:34.202612 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:09:34.202800 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:09:34.203042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:09:34.203358 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:09:34.203538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:09:34.203729 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:09:34.203950 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:09:34.205935 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:09:34.207139 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:09:34.208288 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:09:34.208703 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:09:34.208893 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:09:34.209277 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:09:34.210059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:34.210211 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m20:09:34.210335 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m20:09:34.210448 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m20:09:34.210560 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders' was properly closed.
[0m20:09:34.213229 [debug] [MainThread]: Command end result
[0m20:09:34.230157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:09:34.234768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:09:34.239637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:09:34.242062 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.115931, "process_in_blocks": "0", "process_kernel_time": 0.426841, "process_mem_max_rss": "151863296", "process_out_blocks": "0", "process_user_time": 1.573047}
[0m20:09:34.242361 [debug] [MainThread]: Command `dbt compile` succeeded at 20:09:34.242303 after 1.12 seconds
[0m20:09:34.242583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1c9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1df40>]}
[0m20:09:34.242784 [debug] [MainThread]: Flushing usage events
[0m20:09:34.858783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:49.446067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105464830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690bc50>]}


============================== 20:10:49.451805 | f560720f-85e1-47a3-b693-106a0163f955 ==============================
[0m20:10:49.451805 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:10:49.452244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:10:49.677096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce8c30>]}
[0m20:10:49.707996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698a360>]}
[0m20:10:49.711641 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:10:49.778843 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:10:49.931584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:49.932185 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://analyses/revenue_trends.sql
[0m20:10:50.056536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062d50>]}
[0m20:10:50.121168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:10:50.123582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:10:50.147199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce3890>]}
[0m20:10:50.147571 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:10:50.147780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724e0b0>]}
[0m20:10:50.149542 [info ] [MainThread]: 
[0m20:10:50.149826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:50.149974 [info ] [MainThread]: 
[0m20:10:50.150260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:10:50.152979 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:10:50.158411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:10:50.237970 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:10:50.238302 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:10:50.238539 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:10:50.238754 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:10:50.238939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:50.239092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:50.399787 [debug] [ThreadPool]: SQL status: OK in 0.161 seconds
[0m20:10:50.400234 [debug] [ThreadPool]: SQL status: OK in 0.161 seconds
[0m20:10:50.400448 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:10:50.400746 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:10:50.400959 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:10:50.401166 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:10:50.427239 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:10:50.427519 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:10:50.428410 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:10:50.429231 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:10:50.431049 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:10:50.431353 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:10:50.431516 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:10:50.431745 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:10:50.433354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f560720f-85e1-47a3-b693-106a0163f955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107338e20>]}
[0m20:10:50.435753 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:10:50.435991 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:10:50.436163 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:10:50.436317 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:10:50.436551 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m20:10:50.436773 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:10:50.436955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:10:50.437135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m20:10:50.437293 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:10:50.437440 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:10:50.437583 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:10:50.437723 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:10:50.440940 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:10:50.483207 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:10:50.483843 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:10:50.484573 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:10:50.484930 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:10:50.485440 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:10:50.485799 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:10:50.486092 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:10:50.486546 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:10:50.486738 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:10:50.486933 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:10:50.487119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:10:50.487337 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:10:50.487589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:10:50.487786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:10:50.487968 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:10:50.488137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:10:50.488356 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:10:50.488562 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:10:50.490421 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:10:50.490607 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:10:50.491704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:10:50.492834 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:10:50.494845 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:10:50.495307 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:10:50.495687 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:10:50.495988 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:10:50.496188 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:10:50.496363 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:10:50.497922 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:10:50.498235 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:10:50.498493 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:10:50.498739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:10:50.498939 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:10:50.499130 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:10:50.505111 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:10:50.505394 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:10:50.505646 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:10:50.506169 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:10:50.506405 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:10:50.506893 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:10:50.507313 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:10:50.507612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:10:50.507970 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:10:50.508272 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:50.508639 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:10:50.508946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:10:50.509178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:10:50.512451 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:10:50.512712 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:10:50.512892 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:10:50.513058 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:50.515099 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:10:50.515562 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:10:50.518015 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:10:50.518316 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:10:50.518584 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:10:50.519154 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:10:50.519391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:10:50.519700 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:10:50.519993 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:10:50.520263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:10:50.522125 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:10:50.522391 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:10:50.524052 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:10:50.524346 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:50.524726 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:10:50.524975 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:10:50.525291 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:10:50.525575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:10:50.525795 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:10:50.526190 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:10:50.526394 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:10:50.527131 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:10:50.527333 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:10:50.527494 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:10:50.529534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:10:50.529741 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:10:50.529954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:10:50.530269 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:10:50.530478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:10:50.530678 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:10:50.530911 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:10:50.531150 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:10:50.533049 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:10:50.533396 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:10:50.533656 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:10:50.536155 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:10:50.536493 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:10:50.536843 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:10:50.541108 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:10:50.541623 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:10:50.541965 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:10:50.542201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:10:50.542686 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:10:50.542945 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:10:50.543199 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:10:50.543441 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:10:50.543680 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:10:50.544070 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:10:50.547286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:10:50.547803 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:10:50.548095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:10:50.548371 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:10:50.548770 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:10:50.549080 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:10:50.549379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:10:50.550099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:10:50.552290 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:10:50.552581 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:10:50.552782 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:10:50.552999 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:10:50.554673 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:10:50.555147 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:10:50.557353 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:10:50.558155 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:10:50.558429 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:10:50.558962 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:10:50.559251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:10:50.559508 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:10:50.559766 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:10:50.559978 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:10:50.560176 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:10:50.560517 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:10:50.560718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:10:50.561033 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:10:50.562877 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:10:50.563175 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:10:50.563434 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:10:50.563707 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:10:50.564148 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:10:50.564451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:10:50.566648 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:10:50.566940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:10:50.567274 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:10:50.567541 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:10:50.567835 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:10:50.568068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:10:50.570439 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:10:50.572983 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:10:50.573294 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:10:50.573545 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:10:50.575536 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:10:50.576053 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:10:50.576379 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:10:50.576601 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:10:50.576830 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:10:50.577234 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:10:50.577452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:10:50.577841 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:10:50.578075 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:10:50.578271 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:10:50.578437 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:10:50.578667 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:10:50.578948 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:10:50.581593 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:10:50.582040 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:10:50.582296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:10:50.582500 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:10:50.582867 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:10:50.583064 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:10:50.585174 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:10:50.585451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:10:50.586670 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:10:50.586926 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:10:50.588655 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:10:50.588939 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:10:50.589386 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:10:50.589591 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:50.589869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:10:50.590062 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:50.590271 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:10:50.590491 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:10:50.592457 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:10:50.592697 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:10:50.593148 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:10:50.593577 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:10:50.594016 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:10:50.594246 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:10:50.594519 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:10:50.594749 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:10:50.594976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:10:50.595194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:10:50.595398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:10:50.595592 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:50.595755 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:10:50.595913 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:10:50.596065 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:10:50.596348 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:10:50.600103 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:10:50.601529 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:10:50.603539 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:10:50.603841 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:10:50.604377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:10:50.604611 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:10:50.606072 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:10:50.606309 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:10:50.606819 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:10:50.607048 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:10:50.607548 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:10:50.608002 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:10:50.608992 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:10:50.609450 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:10:50.609658 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:10:50.609910 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:10:50.610167 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:10:50.610437 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:10:50.610691 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:10:50.610991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:10:50.611237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:10:50.613125 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:10:50.613566 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:10:50.613756 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:10:50.613959 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:10:50.614252 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:10:50.616278 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:10:50.618555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:10:50.618906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:10:50.619200 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:10:50.619443 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:10:50.620258 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:10:50.621725 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:10:50.622087 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:10:50.622361 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:10:50.622641 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:10:50.622883 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:10:50.623260 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:10:50.623601 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:10:50.623781 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:10:50.623962 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:10:50.624151 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:10:50.624377 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:10:50.626507 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:10:50.626951 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:10:50.627188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.core_business_metrics, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:10:50.627440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:10:50.627714 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:10:50.627915 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:10:50.628092 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:10:50.628275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:10:50.630781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:10:50.633365 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:10:50.633669 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:10:50.635610 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:10:50.635852 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:10:50.636254 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:10:50.636447 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:10:50.636618 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:10:50.636833 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:10:50.637002 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:10:50.637291 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:10:50.637453 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:10:50.637759 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:10:50.637935 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:10:50.639719 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:10:50.640152 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:10:50.641362 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:10:50.641736 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:10:50.642324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:50.642469 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m20:10:50.642584 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m20:10:50.642695 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_order_dates' was properly closed.
[0m20:10:50.642797 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m20:10:50.645441 [debug] [MainThread]: Command end result
[0m20:10:50.662624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:10:50.668209 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:10:50.674834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:10:50.676918 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.3180095, "process_in_blocks": "0", "process_kernel_time": 0.504354, "process_mem_max_rss": "148471808", "process_out_blocks": "0", "process_user_time": 1.695756}
[0m20:10:50.677172 [debug] [MainThread]: Command `dbt compile` succeeded at 20:10:50.677124 after 1.32 seconds
[0m20:10:50.677368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f88310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8a6d0>]}
[0m20:10:50.677549 [debug] [MainThread]: Flushing usage events
[0m20:10:51.177409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:02.233001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11200c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b0bc50>]}


============================== 20:12:02.236421 | 02677a20-2c0e-421b-b742-4722fb1294a1 ==============================
[0m20:12:02.236421 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:12:02.236773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:02.416104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ce4c30>]}
[0m20:12:02.442465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b8a360>]}
[0m20:12:02.445573 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:12:02.503447 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:12:02.631601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:02.631837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:02.668620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd3750>]}
[0m20:12:02.732468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:12:02.734449 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:12:02.755576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cdfb60>]}
[0m20:12:02.755838 [info ] [MainThread]: Found 8 models, 2 snapshots, 27 data tests, 4 seeds, 5 analyses, 433 macros
[0m20:12:02.756019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c7de10>]}
[0m20:12:02.757224 [info ] [MainThread]: 
[0m20:12:02.757397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:02.757529 [info ] [MainThread]: 
[0m20:12:02.757774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:02.760080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m20:12:02.832641 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m20:12:02.832930 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m20:12:02.833089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:02.943057 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m20:12:02.944170 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m20:12:02.944566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_snapshots)
[0m20:12:02.944866 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "snapshots"
"
[0m20:12:02.948265 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:12:02.948453 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m20:12:02.948594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:02.949268 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:02.950059 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:12:02.950190 [debug] [ThreadPool]: On create_analytics_dev_snapshots: BEGIN
[0m20:12:02.950389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:02.950511 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:12:02.950630 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
    
        create schema if not exists "analytics_dev"."snapshots"
    
[0m20:12:02.951489 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:02.951880 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:12:02.952016 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:12:02.952136 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:12:02.953137 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:02.953325 [debug] [ThreadPool]: On create_analytics_dev_snapshots: Close
[0m20:12:02.954351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_snapshots, now list_analytics_dev_main)
[0m20:12:02.954616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:12:02.957533 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:12:02.958327 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:12:02.958498 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:12:02.958648 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:12:02.958780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:02.958901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:02.959174 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:02.959304 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:12:02.959427 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:02.959566 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:12:02.959701 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:12:02.959893 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:12:02.973200 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:12:02.973382 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:12:02.974014 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:12:02.974685 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:12:02.978289 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:12:02.978545 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:12:02.978689 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:12:02.978823 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:12:02.979881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114174870>]}
[0m20:12:02.980115 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:02.980245 [debug] [MainThread]: On master: BEGIN
[0m20:12:02.980362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:02.980592 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:02.980724 [debug] [MainThread]: On master: COMMIT
[0m20:12:02.980844 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:02.980956 [debug] [MainThread]: On master: COMMIT
[0m20:12:02.981135 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:02.981257 [debug] [MainThread]: On master: Close
[0m20:12:02.983052 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:12:02.983236 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:12:02.983475 [info ] [Thread-2 (]: 2 of 2 START snapshot snapshots.products_snapshot .............................. [RUN]
[0m20:12:02.983923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:12:02.983704 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m20:12:02.984123 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:12:02.984295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:12:02.988113 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:12:02.988298 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:12:03.002611 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:12:03.031649 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:12:03.032001 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:12:03.032200 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp() as updated_at
from "analytics_dev"."main"."stg_products"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:12:03.032423 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp() as updated_at
from "analytics_dev"."main"."stg_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:12:03.032662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:03.032809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:03.039304 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp() as updated_at
from "analytics_dev"."main"."stg_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:12:03.039590 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp() as updated_at
from "analytics_dev"."main"."stg_products"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:12:03.039779 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:03.039946 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m20:12:03.040185 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: Close
[0m20:12:03.040385 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: Close
[0m20:12:03.050926 [debug] [Thread-2 (]: Runtime Error in snapshot products_snapshot (snapshots/product_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^
[0m20:12:03.051437 [debug] [Thread-1 (]: Runtime Error in snapshot customers_snapshot (snapshots/customer_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^
[0m20:12:03.053143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141bb1d0>]}
[0m20:12:03.053318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02677a20-2c0e-421b-b742-4722fb1294a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474d020>]}
[0m20:12:03.053744 [error] [Thread-2 (]: 2 of 2 ERROR snapshotting snapshots.products_snapshot .......................... [[31mERROR[0m in 0.07s]
[0m20:12:03.054408 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:12:03.054085 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.07s]
[0m20:12:03.054732 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_duckdb_analytics_poc.products_snapshot' to be skipped because of status 'error'.  Reason: Runtime Error in snapshot products_snapshot (snapshots/product_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^.
[0m20:12:03.054994 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:12:03.055609 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_duckdb_analytics_poc.customers_snapshot' to be skipped because of status 'error'.  Reason: Runtime Error in snapshot customers_snapshot (snapshots/customer_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^.
[0m20:12:03.056298 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:03.056448 [debug] [MainThread]: On master: BEGIN
[0m20:12:03.056566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:03.056839 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:03.056966 [debug] [MainThread]: On master: COMMIT
[0m20:12:03.057089 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:03.057207 [debug] [MainThread]: On master: COMMIT
[0m20:12:03.057388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:03.057511 [debug] [MainThread]: On master: Close
[0m20:12:03.057672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:03.057787 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.customers_snapshot' was properly closed.
[0m20:12:03.057891 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.products_snapshot' was properly closed.
[0m20:12:03.058025 [info ] [MainThread]: 
[0m20:12:03.058160 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:12:03.058514 [debug] [MainThread]: Command end result
[0m20:12:03.113645 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:12:03.115224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:12:03.118606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:12:03.118762 [info ] [MainThread]: 
[0m20:12:03.118946 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:12:03.119084 [info ] [MainThread]: 
[0m20:12:03.119248 [error] [MainThread]:   Runtime Error in snapshot products_snapshot (snapshots/product_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^
[0m20:12:03.119379 [info ] [MainThread]: 
[0m20:12:03.119528 [error] [MainThread]:   Runtime Error in snapshot customers_snapshot (snapshots/customer_snapshot.sql)
  Catalog Error: Scalar Function with name current_timestamp does not exist!
  Did you mean "current_localtimestamp"?
  
  LINE 23:     current_timestamp() as updated_at
               ^
[0m20:12:03.119659 [info ] [MainThread]: 
[0m20:12:03.119805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m20:12:03.121375 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.93384635, "process_in_blocks": "0", "process_kernel_time": 0.372764, "process_mem_max_rss": "150732800", "process_out_blocks": "0", "process_user_time": 1.299699}
[0m20:12:03.121607 [debug] [MainThread]: Command `dbt snapshot` failed at 20:12:03.121559 after 0.93 seconds
[0m20:12:03.121788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ce1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11472f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f5a450>]}
[0m20:12:03.121958 [debug] [MainThread]: Flushing usage events
[0m20:12:03.753580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:17.180459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118214830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a20f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a20fc50>]}


============================== 20:13:17.184648 | a6873e6c-0323-485c-9eeb-60c9ed570b93 ==============================
[0m20:13:17.184648 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:13:17.185074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:17.372026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3ecc30>]}
[0m20:13:17.400639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a28a360>]}
[0m20:13:17.404233 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:13:17.466039 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:13:17.591859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:13:17.592311 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://snapshots/customer_snapshot.sql
[0m20:13:17.592510 [debug] [MainThread]: Partial parsing: updated file: dbt_duckdb_analytics_poc://snapshots/product_snapshot.sql
[0m20:13:17.738115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a661750>]}
[0m20:13:17.799859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:13:17.802637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:13:17.867368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603b4d0>]}
[0m20:13:17.867732 [info ] [MainThread]: Found 8 models, 27 data tests, 4 seeds, 5 analyses, 2 snapshots, 433 macros
[0m20:13:17.867969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a46d710>]}
[0m20:13:17.869329 [info ] [MainThread]: 
[0m20:13:17.869550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:17.869747 [info ] [MainThread]: 
[0m20:13:17.870040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:17.872437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m20:13:17.940680 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m20:13:17.940952 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m20:13:17.941098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:18.060538 [debug] [ThreadPool]: SQL status: OK in 0.119 seconds
[0m20:13:18.061728 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m20:13:18.062119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_snapshots)
[0m20:13:18.062588 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "snapshots"
"
[0m20:13:18.065802 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:18.065972 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m20:13:18.066104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:18.066855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:18.067623 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:18.067798 [debug] [ThreadPool]: On create_analytics_dev_snapshots: BEGIN
[0m20:13:18.068050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:18.068188 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:18.068319 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
    
        create schema if not exists "analytics_dev"."snapshots"
    
[0m20:13:18.069183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:18.069694 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:13:18.069839 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:18.069961 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:13:18.070155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:18.070288 [debug] [ThreadPool]: On create_analytics_dev_snapshots: Close
[0m20:13:18.071289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_snapshots, now list_analytics_dev_snapshots)
[0m20:13:18.074284 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:18.074450 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:13:18.074636 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:13:18.074775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:18.075548 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:18.075771 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:13:18.075898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:18.076068 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:18.076256 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:18.076406 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:18.076548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:18.076745 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:18.076879 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:18.090035 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:13:18.090303 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m20:13:18.091023 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:13:18.091782 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:13:18.092595 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:13:18.092883 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:13:18.093052 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:13:18.093195 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:13:18.094351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5875f0>]}
[0m20:13:18.094649 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:18.094796 [debug] [MainThread]: On master: BEGIN
[0m20:13:18.094918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:18.095218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:18.095346 [debug] [MainThread]: On master: COMMIT
[0m20:13:18.095471 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:18.095589 [debug] [MainThread]: On master: COMMIT
[0m20:13:18.095763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:18.095889 [debug] [MainThread]: On master: Close
[0m20:13:18.099022 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:18.099210 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:18.099450 [info ] [Thread-2 (]: 2 of 2 START snapshot snapshots.products_snapshot .............................. [RUN]
[0m20:13:18.099699 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m20:13:18.099917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:13:18.100110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:13:18.100279 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:18.100431 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:18.104604 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:18.105913 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:18.146698 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.147816 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.148022 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_customers"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:18.148229 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_products"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:18.148433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:18.148580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:18.151495 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:13:18.153878 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.154106 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        select 
  current_timestamp
::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:18.154296 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:13:18.154758 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.154942 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        select 
  current_timestamp
::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:18.155111 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:13:18.155493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:18.155335 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP) doesn't match derived column 'updated_at' (TIMESTAMP WITH TIME ZONE). Please update snapshot config 'updated_at'.
[0m20:13:18.155818 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.156029 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP) doesn't match derived column 'updated_at' (TIMESTAMP WITH TIME ZONE). Please update snapshot config 'updated_at'.
[0m20:13:18.156286 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.157768 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.157932 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: BEGIN
[0m20:13:18.158185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:18.158327 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.158486 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      
  
    
    

    create  table
      "analytics_dev"."snapshots"."customers_snapshot"
  
    as (
      
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_customers"

    ) sbq



    );
  
  
  
[0m20:13:18.158756 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.158911 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: BEGIN
[0m20:13:18.159125 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:13:18.159275 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.159566 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      
  
    
    

    create  table
      "analytics_dev"."snapshots"."products_snapshot"
  
    as (
      
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_products"

    ) sbq



    );
  
  
  
[0m20:13:18.166750 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:13:18.167035 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:13:18.173763 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: COMMIT
[0m20:13:18.174561 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: COMMIT
[0m20:13:18.174758 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:18.174948 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:18.175195 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: COMMIT
[0m20:13:18.175449 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: COMMIT
[0m20:13:18.177022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:13:18.178227 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: Close
[0m20:13:18.178455 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:13:18.178894 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: Close
[0m20:13:18.180331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acd7110>]}
[0m20:13:18.180507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6873e6c-0323-485c-9eeb-60c9ed570b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae2d860>]}
[0m20:13:18.180922 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshots.customers_snapshot ............................. [[32mOK[0m in 0.08s]
[0m20:13:18.181579 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:18.181333 [info ] [Thread-2 (]: 2 of 2 OK snapshotted snapshots.products_snapshot .............................. [[32mOK[0m in 0.08s]
[0m20:13:18.182018 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:18.182805 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:18.182989 [debug] [MainThread]: On master: BEGIN
[0m20:13:18.183110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:18.183399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:18.183523 [debug] [MainThread]: On master: COMMIT
[0m20:13:18.183645 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:18.183756 [debug] [MainThread]: On master: COMMIT
[0m20:13:18.183923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:18.184046 [debug] [MainThread]: On master: Close
[0m20:13:18.184212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:18.184414 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.customers_snapshot' was properly closed.
[0m20:13:18.184551 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.products_snapshot' was properly closed.
[0m20:13:18.184702 [info ] [MainThread]: 
[0m20:13:18.184842 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:13:18.185192 [debug] [MainThread]: Command end result
[0m20:13:18.201484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:13:18.203293 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:13:18.207079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:13:18.207288 [info ] [MainThread]: 
[0m20:13:18.207491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:18.207626 [info ] [MainThread]: 
[0m20:13:18.207774 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:13:18.209769 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.096451, "process_in_blocks": "0", "process_kernel_time": 0.379527, "process_mem_max_rss": "151502848", "process_out_blocks": "0", "process_user_time": 1.500568}
[0m20:13:18.210091 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:13:18.210011 after 1.10 seconds
[0m20:13:18.210334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af53bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac814d0>]}
[0m20:13:18.210540 [debug] [MainThread]: Flushing usage events
[0m20:13:18.743193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:29.182256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193bc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a90f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a90fc50>]}


============================== 20:13:29.186055 | 3bdf4fd6-17ca-4870-bb21-6dd358fff021 ==============================
[0m20:13:29.186055 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:13:29.186400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:29.361250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aae8c30>]}
[0m20:13:29.389598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a98a360>]}
[0m20:13:29.394661 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:13:29.458797 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:13:29.587960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:29.588270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:29.627692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9d3350>]}
[0m20:13:29.693847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:13:29.695902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:13:29.721998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aadfb60>]}
[0m20:13:29.722370 [info ] [MainThread]: Found 8 models, 27 data tests, 4 seeds, 5 analyses, 2 snapshots, 433 macros
[0m20:13:29.722576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa90bb0>]}
[0m20:13:29.723987 [info ] [MainThread]: 
[0m20:13:29.724193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:29.724330 [info ] [MainThread]: 
[0m20:13:29.724605 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:29.727377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev'
[0m20:13:29.791522 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev"
[0m20:13:29.791785 [debug] [ThreadPool]: On list_analytics_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"analytics_dev"'
    
  
  
[0m20:13:29.791938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:29.931329 [debug] [ThreadPool]: SQL status: OK in 0.139 seconds
[0m20:13:29.932971 [debug] [ThreadPool]: On list_analytics_dev: Close
[0m20:13:29.933829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics_dev, now create_analytics_dev_snapshots)
[0m20:13:29.934252 [debug] [ThreadPool]: Creating schema "database: "analytics_dev"
schema: "snapshots"
"
[0m20:13:29.937926 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:29.938128 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
        select type from duckdb_databases()
        where lower(database_name)='analytics_dev'
        and type='sqlite'
    
  
[0m20:13:29.938265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:29.939232 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:29.940389 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:29.940596 [debug] [ThreadPool]: On create_analytics_dev_snapshots: BEGIN
[0m20:13:29.940873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:29.941009 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:29.941143 [debug] [ThreadPool]: On create_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "create_analytics_dev_snapshots"} */

    
    
        create schema if not exists "analytics_dev"."snapshots"
    
[0m20:13:29.942113 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:13:29.942605 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:13:29.942824 [debug] [ThreadPool]: Using duckdb connection "create_analytics_dev_snapshots"
[0m20:13:29.943032 [debug] [ThreadPool]: On create_analytics_dev_snapshots: COMMIT
[0m20:13:29.943319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:29.943506 [debug] [ThreadPool]: On create_analytics_dev_snapshots: Close
[0m20:13:29.944688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_dev_snapshots, now list_analytics_dev_main)
[0m20:13:29.945015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:13:29.948523 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:29.949403 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:29.949593 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:13:29.949755 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:13:29.949902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:29.950060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:29.950405 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:29.950547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:13:29.950684 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:29.950833 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:29.950971 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:29.951208 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:29.965152 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:13:29.965397 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:13:29.966226 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:13:29.966999 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:13:29.969043 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:13:29.969244 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:13:29.969482 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:13:29.969649 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:13:29.970863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af707a0>]}
[0m20:13:29.971104 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:29.971232 [debug] [MainThread]: On master: BEGIN
[0m20:13:29.971346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:29.971633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:29.971801 [debug] [MainThread]: On master: COMMIT
[0m20:13:29.971942 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:29.972060 [debug] [MainThread]: On master: COMMIT
[0m20:13:29.972245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:29.972372 [debug] [MainThread]: On master: Close
[0m20:13:29.974522 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:29.974705 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:29.974946 [info ] [Thread-2 (]: 2 of 2 START snapshot snapshots.products_snapshot .............................. [RUN]
[0m20:13:29.975161 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m20:13:29.975535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:13:29.975756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:13:29.975967 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:29.976133 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:29.980192 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:29.982103 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:30.015469 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.015885 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.016136 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: BEGIN
[0m20:13:30.016333 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: BEGIN
[0m20:13:30.016500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:13:30.016663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:30.017063 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.017213 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.017366 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.017673 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.017892 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.018076 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.022975 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:13:30.023278 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:13:30.065668 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.066610 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.066853 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

        
  
    
    

    create  table
      "products_snapshot__dbt_tmp20250414201330062528"
  
    as (
      
    
    with snapshot_query as (

        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_products"


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from "analytics_dev"."snapshots"."products_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m20:13:30.067133 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

        
  
    
    

    create  table
      "customers_snapshot__dbt_tmp20250414201330057664"
  
    as (
      
    
    with snapshot_query as (

        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "analytics_dev"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m20:13:30.078191 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:13:30.079588 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.079854 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m20:13:30.080137 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot__dbt_tmp20250414201330057664'
      
      
      order by ordinal_position

  
[0m20:13:30.081488 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.081813 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot__dbt_tmp20250414201330062528'
      
      
      order by ordinal_position

  
[0m20:13:30.083189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.083421 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.087400 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.087773 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.089346 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.089573 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.089819 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.091248 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.091435 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot__dbt_tmp20250414201330057664'
      
      
      order by ordinal_position

  
[0m20:13:30.091682 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.132263 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.132560 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot__dbt_tmp20250414201330062528'
      
      
      order by ordinal_position

  
[0m20:13:30.132880 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m20:13:30.134660 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.134939 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.135152 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.136837 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.137090 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.137270 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot'
      
      and lower(table_schema) = 'snapshots'
      
      
      and lower(table_catalog) = 'analytics_dev'
      
      order by ordinal_position

  
[0m20:13:30.140725 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.140942 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'customers_snapshot__dbt_tmp20250414201330057664'
      
      
      order by ordinal_position

  
[0m20:13:30.141172 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:13:30.142667 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.142996 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'products_snapshot__dbt_tmp20250414201330062528'
      
      
      order by ordinal_position

  
[0m20:13:30.143341 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.151769 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.152077 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:13:30.152380 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_customers"


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from "analytics_dev"."snapshots"."customers_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:30.153937 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.154229 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        



select 
    *,
    current_timestamp as updated_at
from "analytics_dev"."main"."stg_products"


    ),

    snapshotted_data as (

        select *, 
    
        product_id as dbt_unique_key
    

        from "analytics_dev"."snapshots"."products_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        product_id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:30.154627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.157414 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.157647 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
DESCRIBE (select * from (
        select 
  current_timestamp
::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:30.158002 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:13:30.158302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:13:30.159064 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.159280 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
DESCRIBE (select * from (
        select 
  current_timestamp
::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m20:13:30.158556 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP) doesn't match derived column 'updated_at' (TIMESTAMP WITH TIME ZONE). Please update snapshot config 'updated_at'.
[0m20:13:30.159813 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.160108 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.160323 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP) doesn't match derived column 'updated_at' (TIMESTAMP WITH TIME ZONE). Please update snapshot config 'updated_at'.
[0m20:13:30.160579 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.161334 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.161529 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */

      update "analytics_dev"."snapshots"."customers_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp20250414201330057664" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and DBT_INTERNAL_TARGET.dbt_valid_to is null;

    insert into "analytics_dev"."snapshots"."customers_snapshot" ("customer_id", "first_name", "last_name", "email", "registration_date", "country", "full_name", "days_since_registration", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."first_name",DBT_INTERNAL_SOURCE."last_name",DBT_INTERNAL_SOURCE."email",DBT_INTERNAL_SOURCE."registration_date",DBT_INTERNAL_SOURCE."country",DBT_INTERNAL_SOURCE."full_name",DBT_INTERNAL_SOURCE."days_since_registration",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp20250414201330057664" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m20:13:30.161875 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.162086 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */

      update "analytics_dev"."snapshots"."products_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "products_snapshot__dbt_tmp20250414201330062528" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and DBT_INTERNAL_TARGET.dbt_valid_to is null;

    insert into "analytics_dev"."snapshots"."products_snapshot" ("product_id", "product_name", "category", "price", "stock_quantity", "supplier", "stock_level", "inventory_value", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."product_name",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."stock_quantity",DBT_INTERNAL_SOURCE."supplier",DBT_INTERNAL_SOURCE."stock_level",DBT_INTERNAL_SOURCE."inventory_value",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "products_snapshot__dbt_tmp20250414201330062528" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m20:13:30.163609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.169465 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: COMMIT
[0m20:13:30.169795 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.169970 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: COMMIT
[0m20:13:30.170167 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:13:30.170869 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: COMMIT
[0m20:13:30.171092 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.171323 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: COMMIT
[0m20:13:30.173639 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:13:30.176772 [debug] [Thread-1 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"
[0m20:13:30.177058 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:13:30.177252 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.customers_snapshot"} */
drop table if exists "customers_snapshot__dbt_tmp20250414201330057664" cascade
[0m20:13:30.177639 [debug] [Thread-2 (]: Using duckdb connection "snapshot.dbt_duckdb_analytics_poc.products_snapshot"
[0m20:13:30.178013 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "node_id": "snapshot.dbt_duckdb_analytics_poc.products_snapshot"} */
drop table if exists "products_snapshot__dbt_tmp20250414201330062528" cascade
[0m20:13:30.178452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:13:30.179995 [debug] [Thread-1 (]: On snapshot.dbt_duckdb_analytics_poc.customers_snapshot: Close
[0m20:13:30.180241 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:13:30.181027 [debug] [Thread-2 (]: On snapshot.dbt_duckdb_analytics_poc.products_snapshot: Close
[0m20:13:30.182813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afb7dd0>]}
[0m20:13:30.183058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bdf4fd6-17ca-4870-bb21-6dd358fff021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b34d860>]}
[0m20:13:30.183511 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshots.customers_snapshot ............................. [[32mOK[0m in 0.21s]
[0m20:13:30.184018 [info ] [Thread-2 (]: 2 of 2 OK snapshotted snapshots.products_snapshot .............................. [[32mOK[0m in 0.21s]
[0m20:13:30.184376 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:13:30.184717 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:30.185705 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:30.185956 [debug] [MainThread]: On master: BEGIN
[0m20:13:30.186100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:30.186498 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:30.186678 [debug] [MainThread]: On master: COMMIT
[0m20:13:30.186802 [debug] [MainThread]: Using duckdb connection "master"
[0m20:13:30.186914 [debug] [MainThread]: On master: COMMIT
[0m20:13:30.187141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:13:30.187263 [debug] [MainThread]: On master: Close
[0m20:13:30.187438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:30.187551 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.customers_snapshot' was properly closed.
[0m20:13:30.187652 [debug] [MainThread]: Connection 'snapshot.dbt_duckdb_analytics_poc.products_snapshot' was properly closed.
[0m20:13:30.187784 [info ] [MainThread]: 
[0m20:13:30.187914 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:13:30.188266 [debug] [MainThread]: Command end result
[0m20:13:30.204555 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:13:30.206927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:13:30.210897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:13:30.211071 [info ] [MainThread]: 
[0m20:13:30.211240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:30.211365 [info ] [MainThread]: 
[0m20:13:30.211499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:13:30.213165 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.0857445, "process_in_blocks": "0", "process_kernel_time": 0.397485, "process_mem_max_rss": "178241536", "process_out_blocks": "0", "process_user_time": 1.542522}
[0m20:13:30.213475 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:13:30.213424 after 1.09 seconds
[0m20:13:30.213689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8e71b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b32cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad5bdd0>]}
[0m20:13:30.213894 [debug] [MainThread]: Flushing usage events
[0m20:13:30.775021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:59.120147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0bc50>]}


============================== 20:13:59.124351 | 310712c8-96fa-4546-bb14-0f2071e8a47c ==============================
[0m20:13:59.124351 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:13:59.124712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:59.341442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8c30>]}
[0m20:13:59.369173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8a360>]}
[0m20:13:59.373032 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:13:59.436530 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:13:59.569405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:59.569673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:59.609917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3350>]}
[0m20:13:59.681544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:13:59.686434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:13:59.708982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3890>]}
[0m20:13:59.709360 [info ] [MainThread]: Found 8 models, 27 data tests, 4 seeds, 5 analyses, 2 snapshots, 433 macros
[0m20:13:59.709563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8ef90>]}
[0m20:13:59.711336 [info ] [MainThread]: 
[0m20:13:59.711563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:59.711706 [info ] [MainThread]: 
[0m20:13:59.711986 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:59.715033 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:13:59.715460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:13:59.795523 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:59.795796 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:59.795964 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:13:59.796116 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:13:59.796262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:59.796393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:59.888759 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m20:13:59.889040 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m20:13:59.889214 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:13:59.889372 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:13:59.889537 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:59.889704 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:13:59.908186 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:13:59.908440 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:13:59.909430 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:13:59.910131 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:13:59.911343 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:13:59.911515 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:13:59.911752 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:13:59.911921 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:13:59.913098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310712c8-96fa-4546-bb14-0f2071e8a47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072782c0>]}
[0m20:13:59.915245 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:13:59.915494 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:13:59.915679 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:13:59.915847 [debug] [Thread-1 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:13:59.916107 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_products'
[0m20:13:59.916326 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:13:59.916501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now seed.dbt_duckdb_analytics_poc.raw_order_items)
[0m20:13:59.916670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:13:59.916834 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:13:59.916982 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:13:59.917125 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:13:59.917262 [debug] [Thread-1 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:13:59.920427 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:13:59.921514 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:13:59.922300 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:13:59.923047 [debug] [Thread-1 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:13:59.923394 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:13:59.923737 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:13:59.924055 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:13:59.924340 [debug] [Thread-1 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:13:59.924650 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:13:59.924803 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:13:59.925046 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:13:59.925229 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:13:59.925423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:13:59.925573 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:13:59.925730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:13:59.925877 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:13:59.926016 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:13:59.926168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:13:59.926315 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:13:59.927935 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:13:59.929021 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:13:59.929193 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:13:59.930196 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:13:59.931635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:13:59.932090 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:13:59.932377 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:13:59.932542 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:13:59.932817 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:13:59.933091 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:13:59.933378 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:13:59.933591 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:59.933757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:13:59.933900 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:59.935254 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:59.935412 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:13:59.935561 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:13:59.935701 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:59.936030 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:13:59.936345 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:13:59.936528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:13:59.936716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:13:59.936909 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:13:59.937104 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:13:59.937253 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:13:59.937472 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:59.937636 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:13:59.937807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:13:59.943793 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:13:59.945524 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:13:59.945810 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:13:59.946055 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:13:59.947881 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:13:59.953337 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:13:59.953791 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:59.953969 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:13:59.954331 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:13:59.954688 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:13:59.954854 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:13:59.955027 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:13:59.955199 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:13:59.955561 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:13:59.955973 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:13:59.956196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:13:59.956509 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:13:59.956685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:13:59.956913 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:13:59.957117 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:13:59.957308 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:13:59.957487 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:13:59.957669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:13:59.959594 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:13:59.959818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:13:59.961415 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:13:59.961609 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:13:59.961807 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:14:00.001472 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:14:00.003039 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:14:00.003432 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:14:00.003775 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:14:00.003949 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:14:00.004116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:14:00.004271 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:14:00.006152 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:14:00.006363 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:14:00.006793 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:14:00.006989 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:14:00.007214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:14:00.007437 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:14:00.011199 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:14:00.012869 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:14:00.013351 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:14:00.013638 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:14:00.014029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:14:00.014271 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:14:00.014482 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:14:00.014673 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:14:00.017440 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:14:00.017691 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:14:00.018168 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:14:00.018533 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:14:00.018959 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:14:00.019174 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:14:00.019470 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:14:00.019729 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:14:00.019960 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:14:00.020181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:14:00.020351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:14:00.020525 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:14:00.020682 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:14:00.020856 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:14:00.021030 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:14:00.021350 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:14:00.023932 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:14:00.025381 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:14:00.027218 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:14:00.027533 [debug] [Thread-1 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:14:00.028028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:14:00.028287 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:14:00.030548 [debug] [Thread-1 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:14:00.031431 [debug] [Thread-1 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:14:00.031790 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:14:00.032013 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:00.032243 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:14:00.032502 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:14:00.033004 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:14:00.033263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:14:00.033638 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:14:00.033972 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:14:00.034172 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:14:00.034393 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:00.034644 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:14:00.034848 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:14:00.035085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:14:00.037259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:00.037526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:14:00.037797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:14:00.038014 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:14:00.038313 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:14:00.038550 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:14:00.040770 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:14:00.043277 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:14:00.045293 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:14:00.045589 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:00.046016 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:00.046209 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:14:00.046425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:14:00.046659 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:14:00.046853 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:14:00.048888 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:14:00.049119 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:14:00.049552 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:14:00.049772 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:14:00.050076 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:14:00.050272 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:14:00.050633 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:14:00.050849 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:14:00.051064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:14:00.051241 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:14:00.051420 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:14:00.051635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:14:00.051818 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:14:00.052104 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:14:00.052317 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:14:00.052505 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:14:00.054410 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:14:00.054612 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:14:00.054795 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:14:00.056008 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:14:00.056312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:14:00.058307 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:14:00.058602 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:14:00.060338 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:14:00.060568 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:14:00.061001 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:14:00.061169 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:14:00.061336 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:14:00.061496 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:14:00.061778 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:14:00.061920 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:14:00.062226 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:14:00.062405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:14:00.062599 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:14:00.062876 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:14:00.063039 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:14:00.063197 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:14:00.063356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_price_positive, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:14:00.063525 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:14:00.063836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:14:00.065773 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:14:00.066032 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:14:00.066245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:14:00.066441 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:14:00.068360 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:14:00.068588 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:14:00.070368 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:14:00.072190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:14:00.072546 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:14:00.072749 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:14:00.073093 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:14:00.073420 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:14:00.073652 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:14:00.073824 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:14:00.074048 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:14:00.074289 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:14:00.074849 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:14:00.075182 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:14:00.075367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:14:00.075542 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:14:00.075829 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:14:00.076011 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:14:00.076191 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:14:00.078129 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:14:00.078360 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:14:00.078544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:14:00.079737 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:14:00.079968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:14:00.080148 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:14:00.080378 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:14:00.081714 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:14:00.083460 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:14:00.083933 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:14:00.084156 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:14:00.084580 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:14:00.084914 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:14:00.085121 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:14:00.085366 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:14:00.085594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:14:00.085790 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:14:00.085966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_order_dates, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:14:00.086134 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:14:00.086297 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:14:00.086581 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:14:00.086728 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:14:00.086983 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:14:00.089051 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:14:00.089296 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:14:00.090638 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:14:00.090903 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:14:00.091209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:14:00.091426 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:14:00.091611 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:14:00.091789 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:14:00.094069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:14:00.094309 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:14:00.096814 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:14:00.097085 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:14:00.097595 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:14:00.098060 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:14:00.098328 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:14:00.098631 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:14:00.098814 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:14:00.101257 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:14:00.102723 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:14:00.102918 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:14:00.103262 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:14:00.103556 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:14:00.103722 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:14:00.104166 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:14:00.104867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:00.105044 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d' was properly closed.
[0m20:14:00.105174 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m20:14:00.105289 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m20:14:00.105400 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m20:14:00.108203 [debug] [MainThread]: Command end result
[0m20:14:00.125615 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:14:00.127715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:14:00.132832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:14:00.135017 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0684953, "process_in_blocks": "0", "process_kernel_time": 0.388802, "process_mem_max_rss": "145997824", "process_out_blocks": "0", "process_user_time": 1.465219}
[0m20:14:00.135303 [debug] [MainThread]: Command `dbt compile` succeeded at 20:14:00.135241 after 1.07 seconds
[0m20:14:00.135514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726eaf0>]}
[0m20:14:00.135719 [debug] [MainThread]: Flushing usage events
[0m20:14:00.657690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:48.066375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112214830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11430b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11430bc50>]}


============================== 20:19:48.070867 | 917e3fd3-2641-4340-8b2c-553a94ce42f3 ==============================
[0m20:19:48.070867 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:19:48.071288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/logs', 'profiles_dir': '/Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:19:48.259970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e8c30>]}
[0m20:19:48.288762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11438a360>]}
[0m20:19:48.292030 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m20:19:48.352073 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:19:48.489952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:19:48.490434 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://models/schema.yml
[0m20:19:48.490605 [debug] [MainThread]: Partial parsing: added file: dbt_duckdb_analytics_poc://analyses/snapshot_history.sql
[0m20:19:48.669043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114863d50>]}
[0m20:19:48.748734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:19:48.750982 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:19:48.869779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732f4d0>]}
[0m20:19:48.870129 [info ] [MainThread]: Found 8 models, 27 data tests, 4 seeds, 6 analyses, 2 snapshots, 2 sources, 433 macros
[0m20:19:48.870364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b4d630>]}
[0m20:19:48.872095 [info ] [MainThread]: 
[0m20:19:48.872282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:48.872416 [info ] [MainThread]: 
[0m20:19:48.872655 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:19:48.875457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_snapshots'
[0m20:19:48.881333 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_analytics_dev_main'
[0m20:19:48.951822 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:19:48.952173 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:19:48.952376 [debug] [ThreadPool]: On list_analytics_dev_snapshots: BEGIN
[0m20:19:48.952574 [debug] [ThreadPool]: On list_analytics_dev_main: BEGIN
[0m20:19:48.952811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:48.953052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:49.078136 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m20:19:49.078415 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_snapshots"
[0m20:19:49.078578 [debug] [ThreadPool]: SQL status: OK in 0.126 seconds
[0m20:19:49.078779 [debug] [ThreadPool]: On list_analytics_dev_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_snapshots"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'snapshots'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:19:49.078978 [debug] [ThreadPool]: Using duckdb connection "list_analytics_dev_main"
[0m20:19:49.079444 [debug] [ThreadPool]: On list_analytics_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_duckdb_analytics_poc", "target_name": "dev", "connection_name": "list_analytics_dev_main"} */
select
      'analytics_dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'analytics_dev'
  
[0m20:19:49.099332 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:19:49.099707 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:19:49.100595 [debug] [ThreadPool]: On list_analytics_dev_snapshots: ROLLBACK
[0m20:19:49.101386 [debug] [ThreadPool]: On list_analytics_dev_main: ROLLBACK
[0m20:19:49.102218 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_snapshots'
[0m20:19:49.102377 [debug] [ThreadPool]: On list_analytics_dev_snapshots: Close
[0m20:19:49.102633 [debug] [ThreadPool]: Failed to rollback 'list_analytics_dev_main'
[0m20:19:49.102925 [debug] [ThreadPool]: On list_analytics_dev_main: Close
[0m20:19:49.104205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '917e3fd3-2641-4340-8b2c-553a94ce42f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d5c390>]}
[0m20:19:49.106344 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.snapshot_history
[0m20:19:49.106560 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:19:49.106732 [debug] [Thread-4 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:19:49.106885 [debug] [Thread-2 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:19:49.107089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_dev_snapshots, now analysis.dbt_duckdb_analytics_poc.snapshot_history)
[0m20:19:49.107319 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_order_items'
[0m20:19:49.107525 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.dbt_duckdb_analytics_poc.raw_orders'
[0m20:19:49.107694 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_analytics_dev_main, now seed.dbt_duckdb_analytics_poc.raw_customers)
[0m20:19:49.107886 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.snapshot_history
[0m20:19:49.108094 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:19:49.108270 [debug] [Thread-4 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:19:49.108429 [debug] [Thread-2 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:19:49.112798 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.snapshot_history"
[0m20:19:49.114132 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:19:49.114884 [debug] [Thread-4 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:19:49.115777 [debug] [Thread-2 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:19:49.116245 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_order_items
[0m20:19:49.116585 [debug] [Thread-4 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_orders
[0m20:19:49.116894 [debug] [Thread-2 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_customers
[0m20:19:49.117084 [debug] [Thread-3 (]: Began running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:19:49.117392 [debug] [Thread-4 (]: Began running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:19:49.117617 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:19:49.117834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_order_items, now seed.dbt_duckdb_analytics_poc.raw_products)
[0m20:19:49.118048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_orders, now model.dbt_duckdb_analytics_poc.stg_order_items)
[0m20:19:49.118265 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.snapshot_history
[0m20:19:49.118439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_customers, now model.dbt_duckdb_analytics_poc.stg_orders)
[0m20:19:49.118617 [debug] [Thread-3 (]: Began compiling node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:19:49.118790 [debug] [Thread-4 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:19:49.119085 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.snapshot_history
[0m20:19:49.119271 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:19:49.120522 [debug] [Thread-3 (]: Began executing node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:19:49.122055 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_order_items"
[0m20:19:49.122299 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:19:49.123553 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_orders"
[0m20:19:49.123920 [debug] [Thread-3 (]: Finished running node seed.dbt_duckdb_analytics_poc.raw_products
[0m20:19:49.124160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.snapshot_history, now model.dbt_duckdb_analytics_poc.stg_customers)
[0m20:19:49.124438 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:19:49.125936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_customers"
[0m20:19:49.126178 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:19:49.126388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_duckdb_analytics_poc.raw_products, now model.dbt_duckdb_analytics_poc.stg_products)
[0m20:19:49.126574 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:19:49.126763 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.stg_products
[0m20:19:49.127071 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_orders
[0m20:19:49.127230 [debug] [Thread-4 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:19:49.127368 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:19:49.128717 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.stg_products"
[0m20:19:49.129170 [debug] [Thread-4 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_order_items
[0m20:19:49.129396 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:19:49.129696 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_customers
[0m20:19:49.129909 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:19:49.130117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_orders, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:19:49.130352 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:19:49.130565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_order_items, now test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:19:49.130777 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:19:49.130941 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.stg_products
[0m20:19:49.131096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_customers, now test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a)
[0m20:19:49.131250 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:19:49.137377 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:19:49.137823 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.stg_products
[0m20:19:49.138001 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:19:49.139726 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:19:49.139989 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:19:49.142761 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a"
[0m20:19:49.143089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.stg_products, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96)
[0m20:19:49.143318 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:19:49.143508 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:19:49.145686 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96"
[0m20:19:49.146088 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:19:49.146261 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:19:49.146465 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:19:49.146623 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:19:49.146958 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64
[0m20:19:49.147165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:19:49.147466 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a
[0m20:19:49.147652 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:19:49.147828 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:19:49.147982 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:19:49.148139 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:19:49.148310 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6)
[0m20:19:49.149897 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:19:49.150196 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96
[0m20:19:49.150363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_orders_order_id.e3b841c71a, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:19:49.150523 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:19:49.150710 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:19:49.150878 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:19:49.152839 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6"
[0m20:19:49.153113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_id.2063801f96, now test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108)
[0m20:19:49.156934 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:19:49.157172 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:19:49.157376 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:19:49.157724 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:19:49.159314 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108"
[0m20:19:49.159520 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:19:49.159802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_order_item_id.26a7e2bc35, now model.dbt_duckdb_analytics_poc.dim_customers)
[0m20:19:49.159976 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:19:49.160134 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:19:49.160292 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:19:49.160598 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:19:49.162405 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_customers"
[0m20:19:49.162588 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:19:49.162924 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6
[0m20:19:49.163111 [debug] [Thread-1 (]: Began running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:19:49.163439 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108
[0m20:19:49.163624 [debug] [Thread-4 (]: Began running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:19:49.163816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_duckdb_analytics_poc.fct_orders)
[0m20:19:49.163993 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:19:49.164189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_order_items_product_id.5154a8a6f6, now snapshot.dbt_duckdb_analytics_poc.customers_snapshot)
[0m20:19:49.164361 [debug] [Thread-1 (]: Began compiling node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:19:49.164530 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_order_items_order_item_id.90e333a108, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:19:49.164691 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:19:49.164835 [debug] [Thread-4 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:19:49.166198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.fct_orders"
[0m20:19:49.166372 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:19:49.166660 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_customers
[0m20:19:49.167917 [debug] [Thread-4 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:19:49.169919 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:19:49.170193 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:19:49.170579 [debug] [Thread-4 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.customers_snapshot
[0m20:19:49.170830 [debug] [Thread-1 (]: Began executing node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:19:49.171069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_customers, now test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533)
[0m20:19:49.171280 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:19:49.171613 [debug] [Thread-1 (]: Finished running node model.dbt_duckdb_analytics_poc.fct_orders
[0m20:19:49.171793 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:19:49.171988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.customers_snapshot, now test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:19:49.172209 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:19:49.174009 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533"
[0m20:19:49.174249 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:19:49.174406 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:19:49.174588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.fct_orders, now test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada)
[0m20:19:49.174918 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:19:49.179690 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:19:49.180021 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:19:49.180301 [debug] [Thread-3 (]: Began running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:19:49.180508 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:19:49.182577 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada"
[0m20:19:49.182855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.dbt_duckdb_analytics_poc.dim_products)
[0m20:19:49.183235 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533
[0m20:19:49.183493 [debug] [Thread-3 (]: Began compiling node model.dbt_duckdb_analytics_poc.dim_products
[0m20:19:49.183693 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:19:49.183883 [debug] [Thread-2 (]: Began running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:19:49.185519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.dim_products"
[0m20:19:49.185905 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:19:49.186077 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:19:49.186298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_customers_email.d7cf761533, now snapshot.dbt_duckdb_analytics_poc.products_snapshot)
[0m20:19:49.186551 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:19:49.186895 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada
[0m20:19:49.187125 [debug] [Thread-2 (]: Began compiling node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:19:49.187366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3)
[0m20:19:49.187573 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:19:49.187745 [debug] [Thread-3 (]: Began executing node model.dbt_duckdb_analytics_poc.dim_products
[0m20:19:49.189777 [debug] [Thread-2 (]: Began executing node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:19:49.190003 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:19:49.190205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_customers_customer_id.c7614daada, now test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m20:19:49.190526 [debug] [Thread-3 (]: Finished running node model.dbt_duckdb_analytics_poc.dim_products
[0m20:19:49.190806 [debug] [Thread-2 (]: Finished running node snapshot.dbt_duckdb_analytics_poc.products_snapshot
[0m20:19:49.192593 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3"
[0m20:19:49.192795 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:19:49.192990 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:19:49.193214 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:19:49.195738 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m20:19:49.196057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_duckdb_analytics_poc.dim_products, now test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467)
[0m20:19:49.196332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.dbt_duckdb_analytics_poc.products_snapshot, now test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates)
[0m20:19:49.196568 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:19:49.196797 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:19:49.196974 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:19:49.197296 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3
[0m20:19:49.199674 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467"
[0m20:19:49.200930 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates"
[0m20:19:49.201144 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:19:49.201319 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:19:49.201590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_stg_products_product_id.6373b0acf3, now test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m20:19:49.201906 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m20:19:49.202072 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:19:49.202271 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:19:49.204207 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m20:19:49.204530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd)
[0m20:19:49.204811 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:19:49.205031 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:19:49.205252 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:19:49.207716 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd"
[0m20:19:49.208147 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467
[0m20:19:49.208454 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates
[0m20:19:49.208715 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:19:49.208896 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:19:49.209093 [debug] [Thread-2 (]: Began running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:19:49.209287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_stg_products_product_id.7d950a1467, now analysis.dbt_duckdb_analytics_poc.customer_analysis)
[0m20:19:49.209602 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d
[0m20:19:49.209780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_dim_customers_has_no_duplicates, now analysis.dbt_duckdb_analytics_poc.order_trends_by_time)
[0m20:19:49.209963 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:19:49.210122 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:19:49.210287 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:19:49.210451 [debug] [Thread-2 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:19:49.211887 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_analysis"
[0m20:19:49.212332 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd
[0m20:19:49.212573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders)
[0m20:19:49.213981 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.order_trends_by_time"
[0m20:19:49.214226 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:19:49.214413 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:19:49.214624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b)
[0m20:19:49.216202 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders"
[0m20:19:49.216395 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:19:49.218105 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b"
[0m20:19:49.218314 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:19:49.218614 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_analysis
[0m20:19:49.218786 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:19:49.218971 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_analysis, now test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0)
[0m20:19:49.219144 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:19:49.221223 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0"
[0m20:19:49.222382 [debug] [Thread-2 (]: Began executing node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:19:49.222785 [debug] [Thread-2 (]: Finished running node analysis.dbt_duckdb_analytics_poc.order_trends_by_time
[0m20:19:49.222985 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:19:49.223209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.order_trends_by_time, now test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m20:19:49.223373 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:19:49.226131 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m20:19:49.228130 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:19:49.228409 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:19:49.228678 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:19:49.229087 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m20:19:49.229265 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:19:49.229599 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0
[0m20:19:49.229892 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders
[0m20:19:49.230080 [debug] [Thread-2 (]: Began running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:19:49.230366 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b
[0m20:19:49.230538 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:19:49.230727 [debug] [Thread-4 (]: Began running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:19:49.230929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5)
[0m20:19:49.231145 [debug] [Thread-1 (]: Began running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:19:49.231329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_duckdb_analytics_poc.validate_order_dates)
[0m20:19:49.231510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.assert_fct_orders_matches_stg_orders, now analysis.dbt_duckdb_analytics_poc.customer_orders_analysis)
[0m20:19:49.231697 [debug] [Thread-2 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:19:49.231876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.not_null_fct_orders_customer_id.16fe324f7b, now analysis.dbt_duckdb_analytics_poc.product_performance)
[0m20:19:49.232052 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:19:49.232220 [debug] [Thread-4 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:19:49.234188 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5"
[0m20:19:49.234421 [debug] [Thread-1 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:19:49.236050 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_order_dates"
[0m20:19:49.238139 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.customer_orders_analysis"
[0m20:19:49.240006 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.product_performance"
[0m20:19:49.240670 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:19:49.240908 [debug] [Thread-2 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:19:49.241297 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_order_dates
[0m20:19:49.241491 [debug] [Thread-4 (]: Began executing node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:19:49.241680 [debug] [Thread-1 (]: Began executing node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:19:49.242024 [debug] [Thread-2 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5
[0m20:19:49.242340 [debug] [Thread-3 (]: Began running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:19:49.242780 [debug] [Thread-4 (]: Finished running node analysis.dbt_duckdb_analytics_poc.customer_orders_analysis
[0m20:19:49.243193 [debug] [Thread-1 (]: Finished running node analysis.dbt_duckdb_analytics_poc.product_performance
[0m20:19:49.244140 [debug] [Thread-2 (]: Began running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:19:49.245216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.validate_order_dates, now analysis.dbt_duckdb_analytics_poc.revenue_trends)
[0m20:19:49.245625 [debug] [Thread-4 (]: Began running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:19:49.245881 [debug] [Thread-1 (]: Began running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:19:49.246113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_duckdb_analytics_poc.unique_fct_orders_order_id.523ddb6ce5, now model.dbt_duckdb_analytics_poc.core_business_metrics)
[0m20:19:49.246381 [debug] [Thread-3 (]: Began compiling node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:19:49.246649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.customer_orders_analysis, now test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1)
[0m20:19:49.246877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.product_performance, now test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985)
[0m20:19:49.247126 [debug] [Thread-2 (]: Began compiling node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:19:49.249007 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.dbt_duckdb_analytics_poc.revenue_trends"
[0m20:19:49.249283 [debug] [Thread-4 (]: Began compiling node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:19:49.249528 [debug] [Thread-1 (]: Began compiling node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:19:49.252212 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_duckdb_analytics_poc.core_business_metrics"
[0m20:19:49.254181 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1"
[0m20:19:49.256063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985"
[0m20:19:49.256649 [debug] [Thread-3 (]: Began executing node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:19:49.257111 [debug] [Thread-3 (]: Finished running node analysis.dbt_duckdb_analytics_poc.revenue_trends
[0m20:19:49.257314 [debug] [Thread-3 (]: Began running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:19:49.257500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly analysis.dbt_duckdb_analytics_poc.revenue_trends, now test.dbt_duckdb_analytics_poc.validate_price_positive)
[0m20:19:49.257778 [debug] [Thread-3 (]: Began compiling node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:19:49.257992 [debug] [Thread-4 (]: Began executing node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:19:49.259155 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_duckdb_analytics_poc.validate_price_positive"
[0m20:19:49.259394 [debug] [Thread-1 (]: Began executing node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:19:49.259723 [debug] [Thread-4 (]: Finished running node test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1
[0m20:19:49.259882 [debug] [Thread-2 (]: Began executing node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:19:49.260249 [debug] [Thread-1 (]: Finished running node test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985
[0m20:19:49.260707 [debug] [Thread-2 (]: Finished running node model.dbt_duckdb_analytics_poc.core_business_metrics
[0m20:19:49.260936 [debug] [Thread-3 (]: Began executing node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:19:49.261536 [debug] [Thread-3 (]: Finished running node test.dbt_duckdb_analytics_poc.validate_price_positive
[0m20:19:49.262507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:49.262742 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m20:19:49.262903 [debug] [MainThread]: Connection 'model.dbt_duckdb_analytics_poc.core_business_metrics' was properly closed.
[0m20:19:49.263031 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.validate_price_positive' was properly closed.
[0m20:19:49.263148 [debug] [MainThread]: Connection 'test.dbt_duckdb_analytics_poc.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m20:19:49.266071 [debug] [MainThread]: Command end result
[0m20:19:49.287986 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/manifest.json
[0m20:19:49.292418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/semantic_manifest.json
[0m20:19:49.297326 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rafaelnoriega/Documents/github/dbt-duckdb-analytics-poc/target/run_results.json
[0m20:19:49.300219 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.2924871, "process_in_blocks": "0", "process_kernel_time": 0.428119, "process_mem_max_rss": "149012480", "process_out_blocks": "0", "process_user_time": 1.632086}
[0m20:19:49.300427 [debug] [MainThread]: Command `dbt compile` succeeded at 20:19:49.300384 after 1.29 seconds
[0m20:19:49.300606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114baa2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ba9e90>]}
[0m20:19:49.300781 [debug] [MainThread]: Flushing usage events
[0m20:19:49.949432 [debug] [MainThread]: An error was encountered while trying to flush usage events
